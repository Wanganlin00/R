<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R数据科学与编程 - 5&nbsp; ggplot2 Graphics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ggplot2_extensions.html" rel="next">
<link href="./base_graphics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./type_class.html">Data Science</a></li><li class="breadcrumb-item"><a href="./ggplot2_graphics.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ggplot2 Graphics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R数据科学与编程</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考资料</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./type_class.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">数据类型和数据结构</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./I-O.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">读入和写出</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./useful_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">实用函数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base_graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">base graphics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2_graphics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ggplot2 Graphics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2_extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ggplot2 extensions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./custom_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">函数式编程</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Dynamic_report_syntax_format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">动态报告语法格式</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./control_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">控制结构</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">函数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./environments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">环境</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exception_handling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">异常处理</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./efficient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">高效</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functionals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">泛函</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./object_oriented_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">面向对象编程</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#ggplotdata-mapping-aesxy" id="toc-ggplotdata-mapping-aesxy" class="nav-link active" data-scroll-target="#ggplotdata-mapping-aesxy"><span class="header-section-number">5.1</span> <code>ggplot(data =  ,mapping = aes(x,y,…))</code></a>
  <ul>
<li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">5.1.1</span> data</a></li>
  <li><a href="#aesthetics-mapping" id="toc-aesthetics-mapping" class="nav-link" data-scroll-target="#aesthetics-mapping"><span class="header-section-number">5.1.2</span> aesthetics mapping</a></li>
  </ul>
</li>
  <li>
<a href="#geometry" id="toc-geometry" class="nav-link" data-scroll-target="#geometry"><span class="header-section-number">5.2</span> geometry</a>
  <ul>
<li>
<a href="#x%E8%BF%9E%E7%BB%AD%E5%9E%8B%E5%8F%98%E9%87%8F" id="toc-x连续型变量" class="nav-link" data-scroll-target="#x%E8%BF%9E%E7%BB%AD%E5%9E%8B%E5%8F%98%E9%87%8F"><span class="header-section-number">5.2.1</span> X=连续型变量</a>
  <ul class="collapse">
<li><a href="#geom_point" id="toc-geom_point" class="nav-link" data-scroll-target="#geom_point"><span class="header-section-number">5.2.1.1</span> geom_point</a></li>
  <li><a href="#geom_line" id="toc-geom_line" class="nav-link" data-scroll-target="#geom_line"><span class="header-section-number">5.2.1.2</span> geom_line</a></li>
  <li><a href="#geom_smooth-geom_ribbon" id="toc-geom_smooth-geom_ribbon" class="nav-link" data-scroll-target="#geom_smooth-geom_ribbon"><span class="header-section-number">5.2.1.3</span> geom_smooth geom_ribbon</a></li>
  <li><a href="#geom_histogram" id="toc-geom_histogram" class="nav-link" data-scroll-target="#geom_histogram"><span class="header-section-number">5.2.1.4</span> geom_histogram</a></li>
  <li><a href="#geom_freqpoly" id="toc-geom_freqpoly" class="nav-link" data-scroll-target="#geom_freqpoly"><span class="header-section-number">5.2.1.5</span> geom_freqpoly</a></li>
  <li><a href="#geom_density" id="toc-geom_density" class="nav-link" data-scroll-target="#geom_density"><span class="header-section-number">5.2.1.6</span> geom_density</a></li>
  <li><a href="#geom_rug" id="toc-geom_rug" class="nav-link" data-scroll-target="#geom_rug"><span class="header-section-number">5.2.1.7</span> geom_rug</a></li>
  <li><a href="#geom_jitter" id="toc-geom_jitter" class="nav-link" data-scroll-target="#geom_jitter"><span class="header-section-number">5.2.1.8</span> geom_jitter</a></li>
  </ul>
</li>
  <li>
<a href="#x%E7%A6%BB%E6%95%A3%E5%9E%8B%E5%8F%98%E9%87%8F" id="toc-x离散型变量" class="nav-link" data-scroll-target="#x%E7%A6%BB%E6%95%A3%E5%9E%8B%E5%8F%98%E9%87%8F"><span class="header-section-number">5.2.2</span> X=离散型变量</a>
  <ul class="collapse">
<li><a href="#geom_bar" id="toc-geom_bar" class="nav-link" data-scroll-target="#geom_bar"><span class="header-section-number">5.2.2.1</span> geom_bar</a></li>
  <li><a href="#geom_errorbar-errorbarh" id="toc-geom_errorbar-errorbarh" class="nav-link" data-scroll-target="#geom_errorbar-errorbarh"><span class="header-section-number">5.2.2.2</span> geom_errorbar errorbarh</a></li>
  <li><a href="#geom_dotplot" id="toc-geom_dotplot" class="nav-link" data-scroll-target="#geom_dotplot"><span class="header-section-number">5.2.2.3</span> geom_dotplot</a></li>
  <li><a href="#geom_boxplot" id="toc-geom_boxplot" class="nav-link" data-scroll-target="#geom_boxplot"><span class="header-section-number">5.2.2.4</span> geom_boxplot</a></li>
  <li><a href="#geom_violin" id="toc-geom_violin" class="nav-link" data-scroll-target="#geom_violin"><span class="header-section-number">5.2.2.5</span> geom_violin</a></li>
  <li><a href="#geom_tile" id="toc-geom_tile" class="nav-link" data-scroll-target="#geom_tile"><span class="header-section-number">5.2.2.6</span> geom_tile</a></li>
  </ul>
</li>
  <li><a href="#%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2-statistical-transformations" id="toc-统计变换-statistical-transformations" class="nav-link" data-scroll-target="#%E7%BB%9F%E8%AE%A1%E5%8F%98%E6%8D%A2-statistical-transformations"><span class="header-section-number">5.2.3</span> 统计变换 statistical transformations</a></li>
  <li>
<a href="#%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4-position-adjustments" id="toc-位置调整-position-adjustments" class="nav-link" data-scroll-target="#%E4%BD%8D%E7%BD%AE%E8%B0%83%E6%95%B4-position-adjustments"><span class="header-section-number">5.2.4</span> 位置调整 position adjustments</a>
  <ul class="collapse">
<li><a href="#%E6%9D%A1" id="toc-条" class="nav-link" data-scroll-target="#%E6%9D%A1"><span class="header-section-number">5.2.4.1</span> 条</a></li>
  <li><a href="#%E7%82%B9" id="toc-点" class="nav-link" data-scroll-target="#%E7%82%B9"><span class="header-section-number">5.2.4.2</span> 点</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#%E5%9D%90%E6%A0%87%E7%B3%BB-coordinate" id="toc-坐标系-coordinate" class="nav-link" data-scroll-target="#%E5%9D%90%E6%A0%87%E7%B3%BB-coordinate"><span class="header-section-number">5.3</span> 坐标系 coordinate</a></li>
  <li>
<a href="#%E5%9D%90%E6%A0%87%E8%BD%B4-axis" id="toc-坐标轴-axis" class="nav-link" data-scroll-target="#%E5%9D%90%E6%A0%87%E8%BD%B4-axis"><span class="header-section-number">5.4</span> 坐标轴 axis</a>
  <ul>
<li><a href="#%E5%8F%98%E6%8D%A2" id="toc-变换" class="nav-link" data-scroll-target="#%E5%8F%98%E6%8D%A2"><span class="header-section-number">5.4.1</span> 变换</a></li>
  <li><a href="#limits" id="toc-limits" class="nav-link" data-scroll-target="#limits"><span class="header-section-number">5.4.2</span> limits</a></li>
  <li><a href="#zooming" id="toc-zooming" class="nav-link" data-scroll-target="#zooming"><span class="header-section-number">5.4.3</span> zooming</a></li>
  <li><a href="#%E5%85%B1%E4%BA%AB" id="toc-共享" class="nav-link" data-scroll-target="#%E5%85%B1%E4%BA%AB"><span class="header-section-number">5.4.4</span> 共享</a></li>
  </ul>
</li>
  <li><a href="#%E6%A0%87%E9%A2%98-labels" id="toc-标题-labels" class="nav-link" data-scroll-target="#%E6%A0%87%E9%A2%98-labels"><span class="header-section-number">5.5</span> 标题 labels</a></li>
  <li>
<a href="#%E6%B3%A8%E9%87%8A-annotation" id="toc-注释-annotation" class="nav-link" data-scroll-target="#%E6%B3%A8%E9%87%8A-annotation"><span class="header-section-number">5.6</span> 注释 annotation</a>
  <ul>
<li><a href="#%E6%96%87%E6%9C%AC-text" id="toc-文本-text" class="nav-link" data-scroll-target="#%E6%96%87%E6%9C%AC-text"><span class="header-section-number">5.6.1</span> 文本 text</a></li>
  <li><a href="#markdown" id="toc-markdown" class="nav-link" data-scroll-target="#markdown"><span class="header-section-number">5.6.2</span> markdown</a></li>
  <li><a href="#%E6%95%B0%E5%AD%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F" id="toc-数学表达式" class="nav-link" data-scroll-target="#%E6%95%B0%E5%AD%A6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="header-section-number">5.6.3</span> 数学表达式</a></li>
  <li><a href="#%E7%BA%BF%E6%AE%B5-%E7%9B%B4%E7%BA%BF-%E7%AE%AD%E5%A4%B4" id="toc-线段-直线-箭头" class="nav-link" data-scroll-target="#%E7%BA%BF%E6%AE%B5-%E7%9B%B4%E7%BA%BF-%E7%AE%AD%E5%A4%B4"><span class="header-section-number">5.6.4</span> 线段 直线 箭头</a></li>
  </ul>
</li>
  <li>
<a href="#scale" id="toc-scale" class="nav-link" data-scroll-target="#scale"><span class="header-section-number">5.7</span> scale</a>
  <ul>
<li><a href="#xy_continuous" id="toc-xy_continuous" class="nav-link" data-scroll-target="#xy_continuous"><span class="header-section-number">5.7.1</span> x/y_continuous</a></li>
  <li><a href="#xy_discrete" id="toc-xy_discrete" class="nav-link" data-scroll-target="#xy_discrete"><span class="header-section-number">5.7.2</span> x/y_discrete</a></li>
  <li><a href="#color" id="toc-color" class="nav-link" data-scroll-target="#color"><span class="header-section-number">5.7.3</span> color</a></li>
  <li><a href="#fill" id="toc-fill" class="nav-link" data-scroll-target="#fill"><span class="header-section-number">5.7.4</span> fill</a></li>
  </ul>
</li>
  <li><a href="#%E5%88%86%E9%9D%A2" id="toc-分面" class="nav-link" data-scroll-target="#%E5%88%86%E9%9D%A2"><span class="header-section-number">5.8</span> 分面</a></li>
  <li>
<a href="#%E4%B8%BB%E9%A2%98" id="toc-主题" class="nav-link" data-scroll-target="#%E4%B8%BB%E9%A2%98"><span class="header-section-number">5.9</span> 主题</a>
  <ul>
<li><a href="#%E5%86%85%E7%BD%AE%E4%B8%BB%E9%A2%98" id="toc-内置主题" class="nav-link" data-scroll-target="#%E5%86%85%E7%BD%AE%E4%B8%BB%E9%A2%98"><span class="header-section-number">5.9.1</span> 内置主题</a></li>
  <li><a href="#%E5%AD%97%E4%BD%93" id="toc-字体" class="nav-link" data-scroll-target="#%E5%AD%97%E4%BD%93"><span class="header-section-number">5.9.2</span> 字体</a></li>
  <li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98" id="toc-自定义主题" class="nav-link" data-scroll-target="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98"><span class="header-section-number">5.9.3</span> 自定义主题</a></li>
  <li><a href="#%E5%9B%BE%E4%BE%8B" id="toc-图例" class="nav-link" data-scroll-target="#%E5%9B%BE%E4%BE%8B"><span class="header-section-number">5.9.4</span> 图例</a></li>
  <li><a href="#%E7%BB%98%E5%9B%BE%E5%8C%BA" id="toc-绘图区" class="nav-link" data-scroll-target="#%E7%BB%98%E5%9B%BE%E5%8C%BA"><span class="header-section-number">5.9.5</span> 绘图区</a></li>
  </ul>
</li>
  <li>
<a href="#%E5%9B%BE%E5%BD%A2%E5%B8%83%E5%B1%80patchwork" id="toc-图形布局patchwork" class="nav-link" data-scroll-target="#%E5%9B%BE%E5%BD%A2%E5%B8%83%E5%B1%80patchwork"><span class="header-section-number">5.10</span> 图形布局patchwork</a>
  <ul>
<li><a href="#%E5%B8%83%E5%B1%80%E6%96%B9%E5%BC%8F" id="toc-布局方式" class="nav-link" data-scroll-target="#%E5%B8%83%E5%B1%80%E6%96%B9%E5%BC%8F"><span class="header-section-number">5.10.1</span> 布局方式</a></li>
  <li><a href="#%E4%BF%AE%E6%94%B9%E5%AD%90%E5%9B%BE" id="toc-修改子图" class="nav-link" data-scroll-target="#%E4%BF%AE%E6%94%B9%E5%AD%90%E5%9B%BE"><span class="header-section-number">5.10.2</span> 修改子图</a></li>
  <li><a href="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E9%87%8A" id="toc-添加注释" class="nav-link" data-scroll-target="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E9%87%8A"><span class="header-section-number">5.10.3</span> 添加注释</a></li>
  <li><a href="#%E5%9B%BE%E5%BD%A2%E7%BC%96%E5%8F%B7" id="toc-图形编号" class="nav-link" data-scroll-target="#%E5%9B%BE%E5%BD%A2%E7%BC%96%E5%8F%B7"><span class="header-section-number">5.10.4</span> 图形编号</a></li>
  <li><a href="#%E5%9B%BE%E5%BD%A2%E6%8F%92%E5%85%A5" id="toc-图形插入" class="nav-link" data-scroll-target="#%E5%9B%BE%E5%BD%A2%E6%8F%92%E5%85%A5"><span class="header-section-number">5.10.5</span> 图形插入</a></li>
  </ul>
</li>
  <li><a href="#ggplot2-%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84" id="toc-ggplot2-的内部结构" class="nav-link" data-scroll-target="#ggplot2-%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84"><span class="header-section-number">5.11</span> ggplot2 的内部结构</a></li>
  <li><a href="#ggproto%E5%AF%B9%E8%B1%A1" id="toc-ggproto对象" class="nav-link" data-scroll-target="#ggproto%E5%AF%B9%E8%B1%A1"><span class="header-section-number">5.12</span> <strong>ggproto对象</strong></a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./type_class.html">Data Science</a></li><li class="breadcrumb-item"><a href="./ggplot2_graphics.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ggplot2 Graphics</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-ggplot2" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ggplot2 Graphics</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><a href="https://ggplot2-book.org/mastery">ggplot2：用于数据分析的优雅图形</a></p>
<p>gg 为 grammar of graphics 的缩写。</p>
<section id="ggplotdata-mapping-aesxy" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="ggplotdata-mapping-aesxy">
<span class="header-section-number">5.1</span> <code>ggplot(data =  ,mapping = aes(x,y,…))</code>
</h2>
<section id="data" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="data">
<span class="header-section-number">5.1.1</span> data</h3>
<p>数据应使用数据框格式，例如ggplot2包自动的数据集mpg，其中发动机排量 <code>displ</code>，油耗 <code>cty</code>，发动机驱动方式 <code>drv</code>，</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mpg</span>,package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 16%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">manufacturer</th>
<th style="text-align: left;">model</th>
<th style="text-align: right;">displ</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">trans</th>
<th style="text-align: left;">drv</th>
<th style="text-align: right;">cty</th>
<th style="text-align: right;">hwy</th>
<th style="text-align: left;">fl</th>
<th style="text-align: left;">class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">audi</td>
<td style="text-align: left;">a4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">auto(l5)</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">p</td>
<td style="text-align: left;">compact</td>
</tr>
<tr class="even">
<td style="text-align: left;">audi</td>
<td style="text-align: left;">a4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">manual(m5)</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">p</td>
<td style="text-align: left;">compact</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audi</td>
<td style="text-align: left;">a4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">manual(m6)</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">p</td>
<td style="text-align: left;">compact</td>
</tr>
<tr class="even">
<td style="text-align: left;">audi</td>
<td style="text-align: left;">a4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">auto(av)</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">p</td>
<td style="text-align: left;">compact</td>
</tr>
<tr class="odd">
<td style="text-align: left;">audi</td>
<td style="text-align: left;">a4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">auto(l5)</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">p</td>
<td style="text-align: left;">compact</td>
</tr>
<tr class="even">
<td style="text-align: left;">audi</td>
<td style="text-align: left;">a4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">manual(m5)</td>
<td style="text-align: left;">f</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">p</td>
<td style="text-align: left;">compact</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="aesthetics-mapping" class="level3" data-number="5.1.2"><h3 data-number="5.1.2" class="anchored" data-anchor-id="aesthetics-mapping">
<span class="header-section-number">5.1.2</span> aesthetics mapping</h3>
<p><code>mapping=aes(x,y,z,..,color,fill,shape,linetype,alpha,size,group,linewidth)</code></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mpg</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">class</span><span class="op">)</span>  <span class="co"># 7种汽车类型</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">compact</td>
</tr>
<tr class="even">
<td style="text-align: left;">midsize</td>
</tr>
<tr class="odd">
<td style="text-align: left;">suv</td>
</tr>
<tr class="even">
<td style="text-align: left;">2seater</td>
</tr>
<tr class="odd">
<td style="text-align: left;">minivan</td>
</tr>
<tr class="even">
<td style="text-align: left;">pickup</td>
</tr>
<tr class="odd">
<td style="text-align: left;">subcompact</td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="co">#颜色 名义型变量</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape<span class="op">=</span><span class="st">"."</span><span class="op">)</span> <span class="co">#像素点</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, shape <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#形状最多可以映射6个</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, size <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="co">#大小 有序型变量</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, alpha <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="co">#透明度 有序型变量</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="co">#更改外观</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, linetype <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#线条类型</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, linewidth <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#线条粗细</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="geometry" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="geometry">
<span class="header-section-number">5.2</span> geometry</h2>
<ul>
<li>
<p>Graphical primitives:</p>
<ul>
<li><p><code>geom_blank()</code>: display nothing. Most useful for adjusting axes limits using data.</p></li>
<li><p><code>geom_point()</code>: points.</p></li>
<li><p><code>geom_path()</code>: paths.</p></li>
<li><p><code>geom_ribbon()</code>: ribbons, a path with vertical thickness.</p></li>
<li><p><code>geom_segment()</code>: a line segment, specified by start and end position.</p></li>
<li><p><code>geom_rect()</code>: rectangles.</p></li>
<li><p><code>geom_polygon()</code>: filled polygons.</p></li>
<li><p><code>geom_text()</code>: text.</p></li>
</ul>
</li>
</ul>
<!-- --><ul>
<li>
<p>One variable:</p>
<ul>
<li>
<p>Discrete:</p>
<ul>
<li>
<code>geom_bar()</code>: display distribution of discrete variable.</li>
</ul>
</li>
<li>
<p>Continuous:</p>
<ul>
<li><p><code>geom_histogram()</code>: bin and count continuous variable, display with bars.</p></li>
<li><p><code>geom_density()</code>: smoothed density estimate.</p></li>
<li><p><code>geom_dotplot()</code>: stack individual points into a dot plot.</p></li>
<li><p><code>geom_freqpoly()</code>: bin and count continuous variable, display with lines.</p></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Two variables:</p>
<ul>
<li>
<p>Both continuous:</p>
<ul>
<li><p><code>geom_point()</code>: scatterplot.</p></li>
<li><p><code>geom_quantile()</code>: smoothed quantile regression.</p></li>
<li><p><code>geom_rug()</code>: marginal rug plots.</p></li>
<li><p><code>geom_smooth()</code>: smoothed line of best fit.</p></li>
<li><p><code>geom_text()</code>: text labels.</p></li>
</ul>
</li>
<li>
<p>Show distribution:</p>
<ul>
<li><p><code>geom_bin2d()</code>: bin into rectangles and count.</p></li>
<li><p><code>geom_density2d()</code>: smoothed 2d density estimate.</p></li>
<li><p><code>geom_hex()</code>: bin into hexagons and count.</p></li>
</ul>
</li>
<li>
<p>At least one discrete:</p>
<ul>
<li><p><code>geom_count()</code>: count number of point at distinct locations</p></li>
<li><p><code>geom_jitter()</code>: randomly jitter overlapping points.</p></li>
</ul>
</li>
<li>
<p>One continuous, one discrete:</p>
<ul>
<li><p><code>geom_bar(stat = "identity")</code>: a bar chart of precomputed summaries.</p></li>
<li><p><code>geom_boxplot()</code>: boxplots.</p></li>
<li><p><code>geom_violin()</code>: show density of values in each group.</p></li>
</ul>
</li>
<li>
<p>One time, one continuous:</p>
<ul>
<li><p><code>geom_area()</code>: area plot.</p></li>
<li><p><code>geom_line()</code>: line plot.</p></li>
<li><p><code>geom_step()</code>: step plot.</p></li>
</ul>
</li>
<li>
<p>Display uncertainty:</p>
<ul>
<li><p><code>geom_crossbar()</code>: vertical bar with center.</p></li>
<li><p><code>geom_errorbar()</code>: error bars.</p></li>
<li><p><code>geom_linerange()</code>: vertical line.</p></li>
<li><p><code>geom_pointrange()</code>: vertical line with center.</p></li>
</ul>
</li>
<li>
<p>Spatial:</p>
<ul>
<li>
<code>geom_map()</code>: fast version of for map data.<code>geom_polygon()</code>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Three variables:</p>
<ul>
<li><p><code>geom_contour()</code>: contours.</p></li>
<li><p><code>geom_tile()</code>: tile the plane with rectangles.</p></li>
<li><p><code>geom_raster()</code>: fast version of for equal sized tiles.<code>geom_tile()</code></p></li>
</ul>
</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, </span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Hide axis label</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="co"># Shrink plot title</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"point"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_text</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"text"</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"bar"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_tile</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"raster"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"line"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_area</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"area"</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_path</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"path"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_polygon</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"polygon"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="x连续型变量" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="x连续型变量">
<span class="header-section-number">5.2.1</span> X=连续型变量</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="geom_point" class="level4" data-number="5.2.1.1"><h4 data-number="5.2.1.1" class="anchored" data-anchor-id="geom_point">
<span class="header-section-number">5.2.1.1</span> geom_point</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>               stat <span class="op">=</span> <span class="st">"identity"</span>,position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>                formula <span class="op">=</span> <span class="st">"y~x"</span>,</span>
<span>                method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">|</span></span>
<span>    </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">displ</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">scale_size_area</span><span class="op">(</span>name<span class="op">=</span><span class="st">"displ/10"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_line" class="level4" data-number="5.2.1.2"><h4 data-number="5.2.1.2" class="anchored" data-anchor-id="geom_line">
<span class="header-section-number">5.2.1.2</span> geom_line</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">economics</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">date</th>
<th style="text-align: right;">pce</th>
<th style="text-align: right;">pop</th>
<th style="text-align: right;">psavert</th>
<th style="text-align: right;">uempmed</th>
<th style="text-align: right;">unemploy</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1967-07-01</td>
<td style="text-align: right;">506.7</td>
<td style="text-align: right;">198712</td>
<td style="text-align: right;">12.6</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2944</td>
</tr>
<tr class="even">
<td style="text-align: left;">1967-08-01</td>
<td style="text-align: right;">509.8</td>
<td style="text-align: right;">198911</td>
<td style="text-align: right;">12.6</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">2945</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1967-09-01</td>
<td style="text-align: right;">515.6</td>
<td style="text-align: right;">199113</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">2958</td>
</tr>
<tr class="even">
<td style="text-align: left;">1967-10-01</td>
<td style="text-align: right;">512.2</td>
<td style="text-align: right;">199311</td>
<td style="text-align: right;">12.9</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1967-11-01</td>
<td style="text-align: right;">517.4</td>
<td style="text-align: right;">199498</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3066</td>
</tr>
<tr class="even">
<td style="text-align: left;">1967-12-01</td>
<td style="text-align: right;">525.1</td>
<td style="text-align: right;">199657</td>
<td style="text-align: right;">11.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3018</td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">economics</span>,<span class="fu">aes</span><span class="op">(</span><span class="va">date</span>,<span class="va">pop</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">scale_x_date</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_smooth-geom_ribbon" class="level4" data-number="5.2.1.3"><h4 data-number="5.2.1.3" class="anchored" data-anchor-id="geom_smooth-geom_ribbon">
<span class="header-section-number">5.2.1.3</span> geom_smooth geom_ribbon</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">q</span><span class="op">+</span><span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>,span <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co"># loess 平滑局部回归   small n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>                                   <span class="co">#span 0非常摆动，1不那么摆动</span></span>
<span></span>
<span><span class="va">q</span><span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>span <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="co">#不很摆动</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">+</span><span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rlm"</span><span class="op">)</span>   <span class="co"># robust linear model  稳健线性模型</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"gam"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="co">#gam 广义相加模型   n&gt;1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_histogram" class="level4" data-number="5.2.1.4"><h4 data-number="5.2.1.4" class="anchored" data-anchor-id="geom_histogram">
<span class="header-section-number">5.2.1.4</span> geom_histogram</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   stat <span class="op">=</span> <span class="st">"bin"</span>,position <span class="op">=</span> <span class="st">"stack"</span>,</span>
<span>                   binwidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                   <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>加权</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>weight <span class="op">=</span> <span class="va">displ</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_freqpoly" class="level4" data-number="5.2.1.5"><h4 data-number="5.2.1.5" class="anchored" data-anchor-id="geom_freqpoly">
<span class="header-section-number">5.2.1.5</span> geom_freqpoly</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_freqpoly</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_density" class="level4" data-number="5.2.1.6"><h4 data-number="5.2.1.6" class="anchored" data-anchor-id="geom_density">
<span class="header-section-number">5.2.1.6</span> geom_density</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_density</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"density"</span>,position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 alpha<span class="op">=</span><span class="fl">0.3</span></span>
<span>                 <span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"图例名"</span><span class="op">)</span><span class="op">+</span> <span class="co"># 与映射aes()有关</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_rug" class="level4" data-number="5.2.1.7"><h4 data-number="5.2.1.7" class="anchored" data-anchor-id="geom_rug">
<span class="header-section-number">5.2.1.7</span> geom_rug</h4>
<p>y→<code>sides="r","l"</code></p>
<p>x→<code>sides="b","t"</code></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_rug</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>           sides <span class="op">=</span> <span class="st">"br"</span>,color<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_jitter" class="level4" data-number="5.2.1.8"><h4 data-number="5.2.1.8" class="anchored" data-anchor-id="geom_jitter">
<span class="header-section-number">5.2.1.8</span> geom_jitter</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_jitter</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>               stat <span class="op">=</span> <span class="st">"identity"</span>,position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="x离散型变量" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="x离散型变量">
<span class="header-section-number">5.2.2</span> X=离散型变量</h3>
<section id="geom_bar" class="level4" data-number="5.2.2.1"><h4 data-number="5.2.2.1" class="anchored" data-anchor-id="geom_bar">
<span class="header-section-number">5.2.2.1</span> geom_bar</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"count"</span>,position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_col</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,y<span class="op">=</span><span class="va">hwy</span>,fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span>,</span>
<span>             position <span class="op">=</span> <span class="st">"stack"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>有序条形图</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">fct_infreq</span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co">#降序条形图</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_errorbar-errorbarh" class="level4" data-number="5.2.2.2"><h4 data-number="5.2.2.2" class="anchored" data-anchor-id="geom_errorbar-errorbarh">
<span class="header-section-number">5.2.2.2</span> geom_errorbar errorbarh</h4>
<p>geom_linerange geom_crossbar geom_pointrange</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">11</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, ymin <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">se</span>, ymax <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">base</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu">geom_linerange</span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu">geom_ribbon</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span><span class="op">(</span><span class="va">base</span> <span class="op">+</span> <span class="fu">geom_crossbar</span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu">geom_pointrange</span><span class="op">(</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu">geom_smooth</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/g.csv"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarise</span><span class="op">(</span></span>
<span>        mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">liverweight</span><span class="op">)</span>,</span>
<span>        sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">liverweight</span><span class="op">)</span>,</span>
<span>        .by<span class="op">=</span><span class="va">treatment</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treatment</span>,<span class="va">mean</span>,fill<span class="op">=</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">mean</span><span class="op">-</span><span class="va">sd</span>,ymax<span class="op">=</span><span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_dotplot" class="level4" data-number="5.2.2.3"><h4 data-number="5.2.2.3" class="anchored" data-anchor-id="geom_dotplot">
<span class="header-section-number">5.2.2.3</span> geom_dotplot</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_dotplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>                 position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 stackdir <span class="op">=</span> <span class="st">"center"</span>,binaxis <span class="op">=</span> <span class="st">'y'</span>,<span class="co"># stacking along y axis</span></span>
<span>                 fill<span class="op">=</span><span class="st">"red"</span>,binwidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_boxplot" class="level4" data-number="5.2.2.4"><h4 data-number="5.2.2.4" class="anchored" data-anchor-id="geom_boxplot">
<span class="header-section-number">5.2.2.4</span> geom_boxplot</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_boxplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"boxplot"</span>,position <span class="op">=</span> <span class="st">"dodge"</span>,</span>
<span>             notch<span class="op">=</span><span class="cn">TRUE</span>, varwidth<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>             width<span class="op">=</span><span class="fl">0.1</span>,fill<span class="op">=</span><span class="st">"green"</span></span>
<span>            <span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_violin</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_violin" class="level4" data-number="5.2.2.5"><h4 data-number="5.2.2.5" class="anchored" data-anchor-id="geom_violin">
<span class="header-section-number">5.2.2.5</span> geom_violin</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">geom_violin</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>,y<span class="op">=</span><span class="va">hwy</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"ydensity"</span>,position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="geom_tile" class="level4" data-number="5.2.2.6"><h4 data-number="5.2.2.6" class="anchored" data-anchor-id="geom_tile">
<span class="header-section-number">5.2.2.6</span> geom_tile</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 设置随机数种子以确保结果的可重复性  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>  </span>
<span>  </span>
<span><span class="co"># 生成随机数据集  </span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>  </span>
<span>  year <span class="op">=</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2024</span>,  </span>
<span>  lung <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  liver <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, </span>
<span>  bone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  luk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  eso <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  gas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,   </span>
<span>  eye <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  brain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  pan <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  kidney <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span>  breast<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>,  </span>
<span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>                   names_to <span class="op">=</span> <span class="st">"cancer"</span>,</span>
<span>                   values_to <span class="op">=</span> <span class="st">"morbidity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mydata</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">year</span>, <span class="va">cancer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span><span class="va">morbidity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">scale_fill_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="统计变换-statistical-transformations" class="level3" data-number="5.2.3"><h3 data-number="5.2.3" class="anchored" data-anchor-id="统计变换-statistical-transformations">
<span class="header-section-number">5.2.3</span> 统计变换 statistical transformations</h3>
<p>stat_bin()：geom_bar()，geom_freqpoly()，geom_histogram()</p>
<p>stat_bin2d()：geom_bin2d()</p>
<p>stat_bindot()：geom_dotplot()</p>
<p>stat_binhex()：geom_hex()</p>
<p>stat_boxplot()：geom_boxplot()</p>
<p>stat_contour()：geom_contour()</p>
<p>stat_quantile()：geom_quantile()</p>
<p>stat_smooth()：geom_smooth()</p>
<p>stat_sum()：geom_count()</p>
<p>stat_ecdf()：计算经验累积分布图。</p>
<p>stat_function()：根据 x 值的函数计算 y 值。</p>
<p>stat_summary()：将 Y 值汇总到不同的 X 值。</p>
<p>stat_summary2d() ：汇总分箱值。</p>
<p>stat_summary_hex()</p>
<p>stat_qq()：对分位数-分位数图执行计算。</p>
<p>stat_spoke()：将角度和半径转换为位置。</p>
<p>stat_unique()：删除重复的行。</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, y <span class="op">=</span> <span class="va">depth</span><span class="op">)</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    fun.min <span class="op">=</span> <span class="va">min</span>,</span>
<span>    fun.max <span class="op">=</span> <span class="va">max</span>,</span>
<span>    fun <span class="op">=</span> <span class="va">mean</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">trans</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_summary</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, fun <span class="op">=</span> <span class="st">"mean"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="位置调整-position-adjustments" class="level3" data-number="5.2.4"><h3 data-number="5.2.4" class="anchored" data-anchor-id="位置调整-position-adjustments">
<span class="header-section-number">5.2.4</span> 位置调整 position adjustments</h3>
<section id="条" class="level4" data-number="5.2.4.1"><h4 data-number="5.2.4.1" class="anchored" data-anchor-id="条">
<span class="header-section-number">5.2.4.1</span> 条</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">|</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span><span class="op">|</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="点" class="level4" data-number="5.2.4.2"><h4 data-number="5.2.4.2" class="anchored" data-anchor-id="点">
<span class="header-section-number">5.2.4.2</span> 点</h4>
<p>position_nudge()：按固定偏移量移动点。</p>
<p>position_jitter()：为每个位置添加一点随机噪音。</p>
<p>position_jitterdodge()：躲避组内的点，然后添加一点随机噪音。</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span><span class="fu">position_nudge</span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.1</span>,y<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">hwy</span>,color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_jitterdodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="坐标系-coordinate" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="坐标系-coordinate">
<span class="header-section-number">5.3</span> 坐标系 coordinate</h2>
<p>默认坐标系是笛卡尔坐标系</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bar</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">clarity</span>, fill <span class="op">=</span> <span class="va">clarity</span><span class="op">)</span>, </span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">bar</span><span class="op">|</span></span>
<span><span class="va">bar</span> <span class="op">+</span> <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">|</span> <span class="co">#水平条形图</span></span>
<span><span class="va">bar</span> <span class="op">+</span> <span class="fu">coord_polar</span><span class="op">(</span><span class="op">)</span><span class="co">#极坐标</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">map_data</span><span class="op">(</span><span class="st">"world"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">world</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_polygon</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">|</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">world</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_polygon</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_quickmap</span><span class="op">(</span><span class="op">)</span> <span class="co">#正确设置地理地图的纵横比</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="坐标轴-axis" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="坐标轴-axis">
<span class="header-section-number">5.4</span> 坐标轴 axis</h2>
<section id="变换" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="变换">
<span class="header-section-number">5.4.1</span> 变换</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">cty</span><span class="op">)</span>,<span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="limits" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="limits">
<span class="header-section-number">5.4.2</span> limits</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">drv</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_jitter</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"r"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylim</span><span class="op">(</span><span class="fl">25</span>, <span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># filter</span></span>
<span><span class="va">mpg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">displ</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">displ</span> <span class="op">&lt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">hwy</span> <span class="op">&gt;=</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">hwy</span> <span class="op">&lt;=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="co"># limits</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>    <span class="co">#取子集</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="zooming" class="level3" data-number="5.4.3"><h3 data-number="5.4.3" class="anchored" data-anchor-id="zooming">
<span class="header-section-number">5.4.3</span> zooming</h3>
<p>调整绘制的数据,在每个刻度中设置<code>coord_cartesian(xlim= ,ylim= )</code></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>   <span class="co">#放大局部</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="共享" class="level3" data-number="5.4.4"><h3 data-number="5.4.4" class="anchored" data-anchor-id="共享">
<span class="header-section-number">5.4.4</span> 共享</h3>
<p>shared</p>
<p>坐标轴相同</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x_scale</span> <span class="op">&lt;-</span> <span class="fu">scale_x_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y_scale</span> <span class="op">&lt;-</span> <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_scale</span> <span class="op">&lt;-</span> <span class="fu">scale_color_discrete</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">drv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span><span class="op">[</span><span class="va">mpg</span><span class="op">$</span><span class="va">class</span><span class="op">==</span><span class="st">"suv"</span>,<span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">x_scale</span> <span class="op">+</span></span>
<span>  <span class="va">y_scale</span> <span class="op">+</span></span>
<span>  <span class="va">col_scale</span><span class="op">|</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span><span class="op">[</span><span class="va">mpg</span><span class="op">$</span><span class="va">class</span><span class="op">==</span><span class="st">"compact"</span>,<span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">x_scale</span> <span class="op">+</span></span>
<span>  <span class="va">y_scale</span> <span class="op">+</span></span>
<span>  <span class="va">col_scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="标题-labels" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="标题-labels">
<span class="header-section-number">5.5</span> 标题 labels</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">cty</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"city driving (mpg)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"highway driving (mpg)"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"主标题"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Engine displacement (L)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Highway fuel economy (mpg)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Car type"</span>, <span class="co"># 图例 美学映射color</span></span>
<span>    title <span class="op">=</span> <span class="st">"Fuel efficiency generally decreases with engine size"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Two seaters (sports cars) are an </span></span>
<span><span class="st">    exception because of their light weight"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Data from fueleconomy.gov"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="注释-annotation" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="注释-annotation">
<span class="header-section-number">5.6</span> 注释 annotation</h2>
<section id="文本-text" class="level3" data-number="5.6.1"><h3 data-number="5.6.1" class="anchored" data-anchor-id="文本-text">
<span class="header-section-number">5.6.1</span> 文本 text</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 字体</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sans"</span>, <span class="st">"serif"</span>, <span class="st">"mono"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">family</span>, family <span class="op">=</span> <span class="va">family</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 样式</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, face <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"plain"</span>, <span class="st">"bold"</span>, <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">face</span>, fontface <span class="op">=</span> <span class="va">face</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 位置</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"bottom-left"</span>, <span class="st">"top-left"</span>,  </span>
<span>    <span class="st">"bottom-right"</span>, <span class="st">"top-right"</span>, <span class="st">"center"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="st">"inward"</span>, hjust <span class="op">=</span> <span class="st">"inward"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># 自定义</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>, </span>
<span>  response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text</span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">response</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>,</span>
<span>    nudge_y<span class="op">=</span><span class="fl">.2</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-34-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">cyl</span>,<span class="va">am</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarise</span><span class="op">(</span>n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>pct <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>         lbls <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">pct</span><span class="op">)</span></span>
<span>         <span class="op">)</span><span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,<span class="va">pct</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">am</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_text</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span><span class="va">lbls</span><span class="op">)</span>,</span>
<span>              position <span class="op">=</span> <span class="fu">position_stack</span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>              size<span class="op">=</span><span class="fl">3</span></span>
<span>              <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">label_info</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">drv</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">slice_head</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>        drive_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>       <span class="co"># vectorise multiple if_else () statements </span></span>
<span>        <span class="va">drv</span> <span class="op">==</span> <span class="st">"f"</span> <span class="op">~</span> <span class="st">"front-wheel drive"</span>,</span>
<span>        <span class="va">drv</span> <span class="op">==</span> <span class="st">"r"</span> <span class="op">~</span> <span class="st">"rear-wheel drive"</span>,</span>
<span>        <span class="va">drv</span> <span class="op">==</span> <span class="st">"4"</span> <span class="op">~</span> <span class="st">"4-wheel drive"</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span>, <span class="va">drv</span>, <span class="va">drive_type</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,formula<span class="op">=</span><span class="st">"y~x"</span>,se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span><span class="op">+</span>  <span class="fu">geom_text</span><span class="op">(</span><span class="co">#添加注释  geom_label 标签加背景框</span></span>
<span>    data <span class="op">=</span> <span class="va">label_info</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">drive_type</span><span class="op">)</span>,<span class="co">#label映射</span></span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">5</span>, nudge_y <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_label_repel</a></span><span class="op">(</span>                   </span>
<span>    data <span class="op">=</span> <span class="va">label_info</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">drive_type</span><span class="op">)</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">5</span>, nudge_y <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">potential_outliers</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hwy</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">|</span> <span class="op">(</span><span class="va">hwy</span> <span class="op">&gt;</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">displ</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">potential_outliers</span>, <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">potential_outliers</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">potential_outliers</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="st">"circle open"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="markdown" class="level3" data-number="5.6.2"><h3 data-number="5.6.2" class="anchored" data-anchor-id="markdown">
<span class="header-section-number">5.6.2</span> markdown</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Axis title with *italics* and **boldface**"</span><span class="op">)</span></span>
<span><span class="va">base</span> <span class="op">|</span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">ggtext</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggtext/man/element_markdown.html">element_markdown</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co">#ggtext::element_markdown</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="数学表达式" class="level3" data-number="5.6.3"><h3 data-number="5.6.3" class="anchored" data-anchor-id="数学表达式">
<span class="header-section-number">5.6.3</span> 数学表达式</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span>, <span class="va">i</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="co">#数学方程式</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, y <span class="op">=</span> <span class="va">values</span> <span class="op">^</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_path</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>         <span class="co">#数学表达式   ？plotmath</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-38-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="线段-直线-箭头" class="level3" data-number="5.6.4"><h3 data-number="5.6.4" class="anchored" data-anchor-id="线段-直线-箭头">
<span class="header-section-number">5.6.4</span> 线段 直线 箭头</h3>
<p>geom_hline()</p>
<p>geom_vline()</p>
<p>geom_abline</p>
<p>geom_segment() arrow</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">trend_text</span> <span class="op">&lt;-</span> <span class="st">"Larger engine sizes tend to have lower fuel economy."</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">str_wrap</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">trend_text</span></span>
<span><span class="co">#&gt; [1] "Larger engine sizes tend to\nhave lower fuel economy."</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">38</span>,</span>
<span>    label <span class="op">=</span> <span class="va">trend_text</span>,</span>
<span>    hjust <span class="op">=</span> <span class="st">"left"</span>, color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">35</span>, xend <span class="op">=</span> <span class="fl">5</span>, yend <span class="op">=</span> <span class="fl">25</span>, color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"closed"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">manufacturer</span> <span class="op">==</span> <span class="st">"subaru"</span><span class="op">)</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p</span><span class="op">|</span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">40</span>, colour <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">5.6</span>, y <span class="op">=</span> <span class="fl">40</span>, label <span class="op">=</span> <span class="st">"subaru"</span>, hjust <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"curve"</span>, x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">35</span>, xend <span class="op">=</span> <span class="fl">2.65</span>, yend <span class="op">=</span> <span class="fl">27</span>, </span>
<span>    curvature <span class="op">=</span> <span class="fl">.3</span>, arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4.1</span>, y <span class="op">=</span> <span class="fl">35</span>, label <span class="op">=</span> <span class="st">"subaru"</span>, hjust <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="scale" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="scale">
<span class="header-section-number">5.7</span> scale</h2>
<section id="xy_continuous" class="level3" data-number="5.7.1"><h3 data-number="5.7.1" class="anchored" data-anchor-id="xy_continuous">
<span class="header-section-number">5.7.1</span> x/y_continuous</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">wt</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Weight (1000 lbs.)"</span>,   </span>
<span>                     n.breaks <span class="op">=</span> <span class="fl">10</span>,                 </span>
<span>                     minor_breaks <span class="op">=</span> <span class="cn">NULL</span>,           </span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>        </span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Miles per gallon"</span>,     </span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span>, <span class="fl">5</span><span class="op">)</span>,       </span>
<span>                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>          </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fuel efficiency by car weight"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">price</span>, y <span class="op">=</span> <span class="va">cut</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html">label_dollar</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">1000</span>, suffix <span class="op">=</span> <span class="st">"K"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, fill <span class="op">=</span> <span class="va">clarity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Percentage"</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="xy_discrete" class="level3" data-number="5.7.2"><h3 data-number="5.7.2" class="anchored" data-anchor-id="xy_discrete">
<span class="header-section-number">5.7.2</span> x/y_discrete</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">drv</span><span class="op">)</span>,fill<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">-&gt;</span><span class="va">p</span></span>
<span><span class="va">p</span> <span class="op">|</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">scale_x_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"drv"</span>,                                  </span>
<span>                   limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"r"</span><span class="op">)</span>,    </span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'f'</span><span class="op">=</span><span class="st">"drv='f'"</span>,<span class="st">'r'</span><span class="op">=</span> <span class="st">"drv='r'"</span><span class="op">)</span>,</span>
<span>                   position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="color" class="level3" data-number="5.7.3"><h3 data-number="5.7.3" class="anchored" data-anchor-id="color">
<span class="header-section-number">5.7.3</span> color</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">wt</span>, y<span class="op">=</span><span class="va">mpg</span>, color<span class="op">=</span><span class="va">disp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape<span class="op">=</span><span class="fl">19</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A. Default color gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_color_gradient</span><span class="op">(</span>low<span class="op">=</span><span class="st">"grey"</span>, high<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"B. Greyscale gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_color_gradient</span><span class="op">(</span>low<span class="op">=</span><span class="st">"red"</span>, high<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"C. Red-blue color gradient"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_color_steps</span><span class="op">(</span>low<span class="op">=</span><span class="st">"red"</span>, high<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"D. Red-blue binned color Gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_color_steps2</span><span class="op">(</span>low<span class="op">=</span><span class="st">"red"</span>, mid<span class="op">=</span><span class="st">"white"</span>, high<span class="op">=</span><span class="st">"blue"</span>,</span>
<span>                       midpoint<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">disp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"E. Red-white-blue binned gradient"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_color_viridis_c</span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>    <span class="co"># viridis_c,d,b</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"F. Viridis color gradient"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hex</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Default, continuous"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hex</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Viridis, continuous"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hex</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_b</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Viridis, binned"</span>, x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-46-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="fill" class="level3" data-number="5.7.4"><h3 data-number="5.7.4" class="anchored" data-anchor-id="fill">
<span class="header-section-number">5.7.4</span> fill</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>,<span class="fu">aes</span><span class="op">(</span><span class="va">drv</span>,fill<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A. Default colors"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"B. ColorBrewer Set2 palette"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"C. Viridis color scheme"</span><span class="op">)</span><span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">scale_fill_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold4"</span>, <span class="st">"orange2"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"blue4"</span>,</span>
<span>                               <span class="st">"brown2"</span>, <span class="st">"yellowgreen"</span>,<span class="st">"lightpink"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"D. Manual color selection"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="分面" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="分面">
<span class="header-section-number">5.8</span> 分面</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">displ</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 一个分类变量</span></span>
<span><span class="va">q</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">drv</span>,nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">+</span> <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">drv</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 多个分类变量</span></span>
<span><span class="va">q</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="va">drv</span><span class="op">~</span><span class="va">class</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="va">drv</span><span class="op">~</span><span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">q</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">drv</span><span class="op">)</span>   <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-48-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">drv</span> <span class="op">~</span> <span class="va">cyl</span><span class="op">)</span> <span class="op">|</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">drv</span> <span class="op">~</span> <span class="va">cyl</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="主题" class="level2" data-number="5.9"><h2 data-number="5.9" class="anchored" data-anchor-id="主题">
<span class="header-section-number">5.9</span> 主题</h2>
<section id="内置主题" class="level3" data-number="5.9.1"><h3 data-number="5.9.1" class="anchored" data-anchor-id="内置主题">
<span class="header-section-number">5.9.1</span> 内置主题</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">theme_grey</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_grey"</span><span class="op">)</span>  <span class="op">|</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_bw"</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_minimal"</span><span class="op">)</span><span class="op">|</span>  </span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"theme_classic"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-50-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="字体" class="level3" data-number="5.9.2"><h3 data-number="5.9.2" class="anchored" data-anchor-id="字体">
<span class="header-section-number">5.9.2</span> 字体</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">findfont</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/showtext">showtext</a></span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_files.html">font_files</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">family</span>, ignore.case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">file</span>, <span class="va">family</span>, <span class="va">face</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">findfont</span><span class="op">(</span><span class="st">"comic"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">path</th>
<th style="text-align: left;">file</th>
<th style="text-align: left;">family</th>
<th style="text-align: left;">face</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">comic.ttf</td>
<td style="text-align: left;">Comic Sans MS</td>
<td style="text-align: left;">Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">comicbd.ttf</td>
<td style="text-align: left;">Comic Sans MS</td>
<td style="text-align: left;">Bold</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">comici.ttf</td>
<td style="text-align: left;">Comic Sans MS</td>
<td style="text-align: left;">Italic</td>
</tr>
<tr class="even">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">comicz.ttf</td>
<td style="text-align: left;">Comic Sans MS</td>
<td style="text-align: left;">Bold Italic</td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_add.html">font_add</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Times New Roman"</span>, regular <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\times.ttf"</span>,</span>
<span>         bold <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\timesbd.ttf"</span>,</span>
<span>         italic <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\timesi.ttf"</span>,</span>
<span>         bolditalic <span class="op">=</span> <span class="st">"C:\\Windows\\Fonts\\Times New Roman\\timesbi.ttf"</span><span class="op">)</span></span>
<span><span class="fu">findfont</span><span class="op">(</span><span class="st">"Times New Roman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">path</th>
<th style="text-align: left;">file</th>
<th style="text-align: left;">family</th>
<th style="text-align: left;">face</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">times.ttf</td>
<td style="text-align: left;">Times New Roman</td>
<td style="text-align: left;">Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">timesbd.ttf</td>
<td style="text-align: left;">Times New Roman</td>
<td style="text-align: left;">Bold</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">timesbi.ttf</td>
<td style="text-align: left;">Times New Roman</td>
<td style="text-align: left;">Bold Italic</td>
</tr>
<tr class="even">
<td style="text-align: left;">C:/Windows/Fonts</td>
<td style="text-align: left;">timesi.ttf</td>
<td style="text-align: left;">Times New Roman</td>
<td style="text-align: left;">Italic</td>
</tr>
</tbody>
</table>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sysfonts/man/font_families.html">font.families</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "sans"            "serif"           "mono"            "wqy-microhei"   </span></span>
<span><span class="co">#&gt; [5] "Times New Roman"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="自定义主题" class="level3" data-number="5.9.3"><h3 data-number="5.9.3" class="anchored" data-anchor-id="自定义主题">
<span class="header-section-number">5.9.3</span> 自定义主题</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mytheme</span> <span class="op">&lt;-</span> <span class="fu">theme</span><span class="op">(</span>plot.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold.italic"</span>,  size<span class="op">=</span><span class="st">"14"</span>, color<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span>,</span>
<span>                 axis.title<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold.italic"</span>,  size<span class="op">=</span><span class="fl">10</span>, color<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span>,</span>
<span>                 axis.text<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fl">9</span>,  color<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span>, </span>
<span>                 panel.background<span class="op">=</span><span class="fu">element_rect</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"white"</span>,  color<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span>,  </span>
<span>                 panel.grid.major.y<span class="op">=</span><span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey"</span>,  linetype<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,  </span>
<span>                 panel.grid.minor.y<span class="op">=</span><span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey"</span>,  linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,  </span>
<span>                 panel.grid.minor.x<span class="op">=</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,  legend.position<span class="op">=</span><span class="st">"top"</span><span class="op">)</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">drv</span>, y<span class="op">=</span><span class="va">hwy</span>, fill<span class="op">=</span><span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="va">mytheme</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="图例" class="level3" data-number="5.9.4"><h3 data-number="5.9.4" class="anchored" data-anchor-id="图例">
<span class="header-section-number">5.9.4</span> 图例</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 位置和布局</span></span>
<span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="co"># the default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-53-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-53-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">base</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-53-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># 文本</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span>name<span class="op">=</span><span class="st">"Cylinders"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fuel Efficiency for 32 Automobiles"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Miles per gallon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.95</span>, <span class="fl">.95</span><span class="op">)</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgrey"</span>,</span>
<span>                                         color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                                         linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.key <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-53-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Larger engine sizes tend to have lower fuel economy"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>    legend.box.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>    plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="绘图区" class="level3" data-number="5.9.5"><h3 data-number="5.9.5" class="anchored" data-anchor-id="绘图区">
<span class="header-section-number">5.9.5</span> 绘图区</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Automatic"</span>, <span class="st">"Manual"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">mtcars</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">disp</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>                     </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>                   </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,                             </span>
<span>              linetype<span class="op">=</span><span class="st">"dotted"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_discrete</span><span class="op">(</span><span class="st">"Number of cylinders"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">am</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>                                      </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mileage, transmission type, and number of cylinders"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Engine displacement (cu. in.)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Miles per gallon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                                                  </span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>        panel.grid.major <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgrey"</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgrey"</span>,</span>
<span>                                        linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span>,</span>
<span>        axis.ticks <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.key <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="图形布局patchwork" class="level2" data-number="5.10"><h2 data-number="5.10" class="anchored" data-anchor-id="图形布局patchwork">
<span class="header-section-number">5.10</span> 图形布局patchwork</h2>
<section id="布局方式" class="level3" data-number="5.10.1"><h3 data-number="5.10.1" class="anchored" data-anchor-id="布局方式">
<span class="header-section-number">5.10.1</span> 布局方式</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, y <span class="op">=</span> <span class="va">cty</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">drv</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cty</span>, color <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 3"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span>, fill <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cty</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">drv</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot 5"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p3</span> <span class="op">|</span> <span class="op">(</span><span class="va">p2</span> <span class="op">/</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span> <span class="va">layout</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">AAB</span></span>
<span><span class="st">C#B</span></span>
<span><span class="st">CDD</span></span>
<span><span class="st">"</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>design <span class="op">=</span> <span class="va">layout</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="修改子图" class="level3" data-number="5.10.2"><h3 data-number="5.10.2" class="anchored" data-anchor-id="修改子图">
<span class="header-section-number">5.10.2</span> 修改子图</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p12</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span>
<span>  <span class="va">p12</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p12</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">p12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">&amp;</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-64-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p1</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">&amp;</span> <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-64-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="添加注释" class="level3" data-number="5.10.3"><h3 data-number="5.10.3" class="anchored" data-anchor-id="添加注释">
<span class="header-section-number">5.10.3</span> 添加注释</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span>                                      </span>
<span>  <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'主标题'</span>,caption <span class="op">=</span> <span class="st">"脚注"</span>,</span>
<span>                  theme <span class="op">=</span> <span class="fu">theme_gray</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"mono"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span><span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>   <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="op">(</span><span class="fu">guide_area</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span><span class="op">)</span> <span class="op">/</span> <span class="va">p5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_annotation</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"City and highway mileage for cars with different drive trains"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_layout</span><span class="op">(</span></span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="图形编号" class="level3" data-number="5.10.4"><h3 data-number="5.10.4" class="anchored" data-anchor-id="图形编号">
<span class="header-section-number">5.10.4</span> 图形编号</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p123</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">|</span> <span class="op">(</span><span class="va">p2</span> <span class="op">/</span> <span class="va">p3</span><span class="op">)</span></span>
<span><span class="va">p123</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"I"</span><span class="op">)</span> <span class="co"># Uppercase roman numerics i</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p123</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span> <span class="co"># lowercase letters A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p123</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="co">#  numbers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  </span>
<span><span class="va">p123</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p123</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p123</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>tag_level <span class="op">=</span> <span class="st">"new"</span><span class="op">)</span></span>
<span><span class="va">p123</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I"</span>,<span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-66-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="图形插入" class="level3" data-number="5.10.5"><h3 data-number="5.10.5" class="anchored" data-anchor-id="图形插入">
<span class="header-section-number">5.10.5</span> 图形插入</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p1</span> <span class="op">+</span> <span class="fu">inset_element</span><span class="op">(</span><span class="va">p2</span>, left <span class="op">=</span> <span class="fl">0.5</span>, bottom <span class="op">=</span> <span class="fl">0.4</span>, right <span class="op">=</span> <span class="fl">0.9</span>, top <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p24</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">/</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span>
<span>  <span class="va">p1</span> <span class="op">+</span> <span class="fu">inset_element</span><span class="op">(</span><span class="va">p24</span>, left <span class="op">=</span> <span class="fl">0.5</span>, bottom <span class="op">=</span> <span class="fl">0.05</span>, right <span class="op">=</span> <span class="fl">0.95</span>, top <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-67-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p12</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">inset_element</span><span class="op">(</span><span class="va">p2</span>, left <span class="op">=</span> <span class="fl">0.5</span>, bottom <span class="op">=</span> <span class="fl">0.5</span>, right <span class="op">=</span> <span class="fl">0.9</span>, top <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span>  <span class="va">p12</span> <span class="op">&amp;</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-67-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="va">p12</span> <span class="op">+</span> <span class="fu">plot_annotation</span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-67-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ggplot2-的内部结构" class="level2" data-number="5.11"><h2 data-number="5.11" class="anchored" data-anchor-id="ggplot2-的内部结构">
<span class="header-section-number">5.11</span> ggplot2 的内部结构</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mpg</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">displ</span>, <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"A plot for expository purposes"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ggprint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">ggplot_build</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">gtable</span> <span class="op">&lt;-</span> <span class="fu">ggplot_gtable</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span><span class="op">(</span><span class="va">gtable</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">ggprint</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_built</span> <span class="op">&lt;-</span> <span class="fu">ggplot_build</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_built</span> <span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      colour        x        y PANEL group shape size fill alpha stroke</span></span>
<span><span class="co">#&gt; 1   #00BA38 1.767385 29.04692     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 2   #00BA38 1.779773 29.15194     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 3   #00BA38 1.976448 30.77814     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 4   #00BA38 1.970823 30.37771     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 5   #00BA38 2.786053 25.70846     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 6   #00BA38 2.831331 25.73572     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 7   #00BA38 3.084410 27.01035     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 8   #F8766D 1.806981 25.99238     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 9   #F8766D 1.787019 24.96076     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 10  #F8766D 2.037209 28.32164     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 11  #F8766D 2.031835 26.73734     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 12  #F8766D 2.803323 24.61591     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 13  #F8766D 2.821173 24.93911     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 14  #F8766D 3.093628 24.64943     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 15  #F8766D 3.082713 25.13807     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 16  #F8766D 2.769765 23.99082     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 17  #F8766D 3.114283 25.25673     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 18  #F8766D 4.236953 23.33551     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 19  #619CFF 5.335211 20.37053     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 20  #619CFF 5.321781 14.81809     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 21  #619CFF 5.283038 19.71366     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 22  #619CFF 5.671630 17.36100     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 23  #619CFF 6.038297 17.10525     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 24  #619CFF 5.732564 25.74664     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 25  #619CFF 5.676562 22.60204     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 26  #619CFF 6.187115 25.98762     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 27  #619CFF 6.175819 24.87986     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 28  #619CFF 7.028669 24.12225     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 29  #F8766D 5.321105 19.05622     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 30  #F8766D 5.278746 14.34140     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 31  #F8766D 5.704519 15.13107     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 32  #F8766D 6.500463 16.60401     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 33  #00BA38 2.396365 27.33542     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 34  #00BA38 2.390231 29.83168     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 35  #00BA38 3.112008 25.74484     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 36  #00BA38 3.534620 29.03418     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 37  #00BA38 3.622772 25.74189     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 38  #00BA38 2.380276 23.90531     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 39  #00BA38 3.023258 23.82610     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 40  #00BA38 3.336608 21.79428     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 41  #00BA38 3.276630 22.24435     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 42  #00BA38 3.325406 24.29460     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 43  #00BA38 3.271618 23.67997     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 44  #00BA38 3.283089 17.33850     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 45  #00BA38 3.816214 22.30670     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 46  #00BA38 3.803259 21.25791     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 47  #00BA38 3.839192 23.21158     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 48  #00BA38 4.024944 23.08708     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 49  #F8766D 3.722582 18.72062     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 50  #F8766D 3.723848 18.02785     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 51  #F8766D 3.862451 17.34612     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 52  #F8766D 3.924025 16.73514     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 53  #F8766D 4.720194 19.34077     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 54  #F8766D 4.715034 19.29608     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 55  #F8766D 4.708938 11.87173     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 56  #F8766D 5.208688 17.17428     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 57  #F8766D 5.202502 15.21981     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 58  #F8766D 3.872759 17.19270     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 59  #F8766D 4.738936 17.27737     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 60  #F8766D 4.697238 12.03239     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 61  #F8766D 4.733710 16.78488     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 62  #F8766D 5.230557 16.30768     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 63  #F8766D 5.691053 18.16418     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 64  #F8766D 5.919106 14.66299     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 65  #F8766D 4.739009 16.04133     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 66  #F8766D 4.700964 11.71892     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 67  #F8766D 4.722044 16.72389     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 68  #F8766D 4.726070 17.28553     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 69  #F8766D 4.734337 16.11048     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 70  #F8766D 4.730609 11.76769     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 71  #F8766D 5.178997 14.78657     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 72  #F8766D 5.201561 15.75372     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 73  #F8766D 5.724607 16.76480     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 74  #F8766D 5.868224 15.36175     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 75  #619CFF 4.566835 17.09052     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 76  #619CFF 5.409523 17.03880     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 77  #619CFF 5.438758 17.63823     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 78  #F8766D 3.961246 17.14821     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 79  #F8766D 3.964623 19.37334     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 80  #F8766D 4.029912 17.25249     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 81  #F8766D 4.030852 19.39677     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 82  #F8766D 4.573844 18.60666     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 83  #F8766D 4.996931 16.88502     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 84  #F8766D 4.227030 16.61598     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 85  #F8766D 4.200593 16.74958     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 86  #F8766D 4.587502 15.67467     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 87  #F8766D 4.577617 16.39744     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 88  #F8766D 4.639492 16.89370     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 89  #F8766D 5.413256 15.38495     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 90  #F8766D 5.395187 17.18730     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 91  #619CFF 3.824527 25.63775     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 92  #619CFF 3.802077 25.02959     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 93  #619CFF 4.025991 25.89732     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 94  #619CFF 3.973712 24.27180     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 95  #619CFF 4.593057 20.65600     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 96  #619CFF 4.571709 22.23025     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 97  #619CFF 4.606725 22.67764     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 98  #619CFF 4.612550 21.96620     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 99  #619CFF 5.433011 20.14043     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 100 #00BA38 1.608225 32.82401     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 101 #00BA38 1.560008 31.69745     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 102 #00BA38 1.579337 31.61259     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 103 #00BA38 1.600461 29.22821     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 104 #00BA38 1.638751 31.69464     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 105 #00BA38 1.777011 33.97055     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 106 #00BA38 1.796975 35.80591     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 107 #00BA38 1.835005 35.69425     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 108 #00BA38 1.984558 28.70598     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 109 #00BA38 2.363958 26.19613     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 110 #00BA38 2.368529 26.63068     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 111 #00BA38 2.405860 30.02787     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 112 #00BA38 2.381869 30.73507     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 113 #00BA38 2.481247 26.33764     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 114 #00BA38 2.461744 25.90365     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 115 #00BA38 3.312542 28.12287     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 116 #00BA38 1.960408 25.85143     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 117 #00BA38 2.011533 29.33392     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 118 #00BA38 2.004485 28.39719     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 119 #00BA38 2.038957 27.37574     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 120 #00BA38 2.720188 24.06923     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 121 #00BA38 2.681605 24.16771     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 122 #00BA38 2.664355 23.76682     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 123 #F8766D 2.984553 22.37968     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 124 #F8766D 3.683057 18.72318     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 125 #F8766D 3.974925 19.93581     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 126 #F8766D 4.697462 16.69238     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 127 #F8766D 4.688008 11.64583     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 128 #F8766D 4.661013 19.11923     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 129 #F8766D 5.709572 18.26909     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 130 #F8766D 6.112262 14.17454     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 131 #F8766D 4.035512 14.87325     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 132 #F8766D 4.213724 18.08884     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 133 #F8766D 4.373704 18.37230     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 134 #F8766D 4.562636 14.79030     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 135 #619CFF 5.425738 16.76789     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 136 #619CFF 5.397741 16.21305     1     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 137 #619CFF 5.397364 18.32279     2     3    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 138 #F8766D 4.003754 17.32114     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 139 #F8766D 4.006280 19.18473     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 140 #F8766D 4.600332 18.70711     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 141 #F8766D 5.004909 17.18179     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 142 #00BA38 2.380109 28.68962     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 143 #00BA38 2.361079 26.92399     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 144 #00BA38 2.464177 30.72788     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 145 #00BA38 2.467865 32.20935     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 146 #00BA38 3.520032 27.31879     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 147 #00BA38 3.506839 25.94509     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 148 #00BA38 2.961881 26.17307     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 149 #00BA38 2.970279 25.26556     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 150 #00BA38 3.515182 24.66823     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 151 #F8766D 3.294832 17.37844     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 152 #F8766D 3.287630 16.66878     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 153 #F8766D 4.025586 19.93104     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 154 #F8766D 5.575201 18.34750     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 155 #00BA38 3.100411 26.30478     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 156 #00BA38 3.809106 25.87914     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 157 #00BA38 3.836894 27.32127     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 158 #00BA38 3.816914 27.63282     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 159 #00BA38 5.281958 25.36105     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 160 #F8766D 2.479656 25.14643     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 161 #F8766D 2.517608 23.73414     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 162 #F8766D 2.476203 27.08829     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 163 #F8766D 2.488423 25.03779     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 164 #F8766D 2.467977 25.95023     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 165 #F8766D 2.484887 23.34113     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 166 #F8766D 2.194877 25.95766     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 167 #F8766D 2.195964 26.04226     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 168 #F8766D 2.494856 25.76958     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 169 #F8766D 2.460401 26.28052     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 170 #F8766D 2.534661 24.94254     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 171 #F8766D 2.518775 27.38090     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 172 #F8766D 2.460154 25.20343     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 173 #F8766D 2.499887 27.14608     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 174 #F8766D 2.678748 19.81460     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 175 #F8766D 2.729221 20.12069     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 176 #F8766D 3.410290 18.82957     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 177 #F8766D 3.424672 16.83292     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 178 #F8766D 3.990400 20.28926     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 179 #F8766D 4.678479 16.93172     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 180 #00BA38 2.213521 28.62611     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 181 #00BA38 2.169546 27.34342     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 182 #00BA38 2.407445 30.91564     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 183 #00BA38 2.428250 31.24281     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 184 #00BA38 2.991238 25.63111     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 185 #00BA38 3.005920 26.18163     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 186 #00BA38 3.509076 28.03780     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 187 #00BA38 2.191874 26.98147     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 188 #00BA38 2.233795 28.72760     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 189 #00BA38 2.415032 31.16068     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 190 #00BA38 2.423621 31.10122     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 191 #00BA38 2.998445 26.01762     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 192 #00BA38 3.036241 25.67349     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 193 #00BA38 3.294233 27.34421     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 194 #00BA38 1.819298 30.22380     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 195 #00BA38 1.775591 32.85051     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 196 #00BA38 1.768322 34.92110     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 197 #00BA38 1.771558 37.32308     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 198 #00BA38 1.831336 35.31736     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 199 #F8766D 4.711513 15.18389     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 200 #F8766D 5.735524 17.81366     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 201 #F8766D 2.687634 19.90851     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 202 #F8766D 2.722330 19.82888     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 203 #F8766D 2.705133 21.76738     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 204 #F8766D 3.394128 16.70186     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 205 #F8766D 3.392817 19.38064     1     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 206 #F8766D 3.964371 17.83500     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 207 #F8766D 4.006347 19.94960     2     1    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 208 #00BA38 1.991503 29.08912     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 209 #00BA38 1.960542 25.61566     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 210 #00BA38 1.988835 28.72385     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 211 #00BA38 2.037926 29.03832     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 212 #00BA38 2.808537 24.31205     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 213 #00BA38 1.919795 44.36579     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 214 #00BA38 1.983528 28.96789     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 215 #00BA38 1.987543 26.24385     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 216 #00BA38 2.017406 29.25582     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 217 #00BA38 1.995187 28.65331     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 218 #00BA38 2.525185 28.83494     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 219 #00BA38 2.502464 29.38374     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 220 #00BA38 2.775895 23.12603     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 221 #00BA38 2.783482 24.03764     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 222 #00BA38 1.883704 44.28538     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 223 #00BA38 1.898457 41.16524     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 224 #00BA38 2.012421 29.15648     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 225 #00BA38 1.970707 26.09071     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 226 #00BA38 2.462143 28.19584     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 227 #00BA38 2.472723 29.10053     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 228 #00BA38 1.783306 28.62686     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 229 #00BA38 1.782366 29.04936     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 230 #00BA38 1.992224 28.23076     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 231 #00BA38 2.001187 28.97703     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 232 #00BA38 2.805727 26.25083     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 233 #00BA38 2.806901 25.60939     1     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; 234 #00BA38 3.583273 25.98308     2     2    19  1.5   NA    NA    0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;      colour        x        y     ymin     ymax        se flipped_aes PANEL</span></span>
<span><span class="co">#&gt; 1   #F8766D 1.800000 24.33592 23.07845 25.59339 0.6250675       FALSE     1</span></span>
<span><span class="co">#&gt; 2   #F8766D 1.859494 24.17860 22.94830 25.40890 0.6115600       FALSE     1</span></span>
<span><span class="co">#&gt; 3   #F8766D 1.918987 24.02127 22.81795 25.22460 0.5981528       FALSE     1</span></span>
<span><span class="co">#&gt; 4   #F8766D 1.978481 23.86395 22.68738 25.04052 0.5848527       FALSE     1</span></span>
<span><span class="co">#&gt; 5   #F8766D 2.037975 23.70663 22.55658 24.85668 0.5716673       FALSE     1</span></span>
<span><span class="co">#&gt; 6   #F8766D 2.097468 23.54931 22.42554 24.67307 0.5586045       FALSE     1</span></span>
<span><span class="co">#&gt; 7   #F8766D 2.156962 23.39198 22.29423 24.48974 0.5456732       FALSE     1</span></span>
<span><span class="co">#&gt; 8   #F8766D 2.216456 23.23466 22.16264 24.30668 0.5328831       FALSE     1</span></span>
<span><span class="co">#&gt; 9   #F8766D 2.275949 23.07734 22.03074 24.12394 0.5202445       FALSE     1</span></span>
<span><span class="co">#&gt; 10  #F8766D 2.335443 22.92002 21.89852 23.94152 0.5077687       FALSE     1</span></span>
<span><span class="co">#&gt; 11  #F8766D 2.394937 22.76269 21.76594 23.75945 0.4954680       FALSE     1</span></span>
<span><span class="co">#&gt; 12  #F8766D 2.454430 22.60537 21.63298 23.57776 0.4833558       FALSE     1</span></span>
<span><span class="co">#&gt; 13  #F8766D 2.513924 22.44805 21.49962 23.39648 0.4714467       FALSE     1</span></span>
<span><span class="co">#&gt; 14  #F8766D 2.573418 22.29073 21.36582 23.21564 0.4597563       FALSE     1</span></span>
<span><span class="co">#&gt; 15  #F8766D 2.632911 22.13340 21.23154 23.03527 0.4483019       FALSE     1</span></span>
<span><span class="co">#&gt; 16  #F8766D 2.692405 21.97608 21.09675 22.85542 0.4371019       FALSE     1</span></span>
<span><span class="co">#&gt; 17  #F8766D 2.751899 21.81876 20.96140 22.67611 0.4261765       FALSE     1</span></span>
<span><span class="co">#&gt; 18  #F8766D 2.811392 21.66144 20.82546 22.49741 0.4155472       FALSE     1</span></span>
<span><span class="co">#&gt; 19  #F8766D 2.870886 21.50411 20.68888 22.31935 0.4052375       FALSE     1</span></span>
<span><span class="co">#&gt; 20  #F8766D 2.930380 21.34679 20.55161 22.14198 0.3952722       FALSE     1</span></span>
<span><span class="co">#&gt; 21  #F8766D 2.989873 21.18947 20.41358 21.96535 0.3856781       FALSE     1</span></span>
<span><span class="co">#&gt; 22  #F8766D 3.049367 21.03215 20.27476 21.78953 0.3764836       FALSE     1</span></span>
<span><span class="co">#&gt; 23  #F8766D 3.108861 20.87482 20.13507 21.61458 0.3677187       FALSE     1</span></span>
<span><span class="co">#&gt; 24  #F8766D 3.168354 20.71750 19.99445 21.44055 0.3594147       FALSE     1</span></span>
<span><span class="co">#&gt; 25  #F8766D 3.227848 20.56018 19.85284 21.26751 0.3516043       FALSE     1</span></span>
<span><span class="co">#&gt; 26  #F8766D 3.287342 20.40286 19.71017 21.09554 0.3443212       FALSE     1</span></span>
<span><span class="co">#&gt; 27  #F8766D 3.346835 20.24553 19.56637 20.92470 0.3375995       FALSE     1</span></span>
<span><span class="co">#&gt; 28  #F8766D 3.406329 20.08821 19.42137 20.75505 0.3314732       FALSE     1</span></span>
<span><span class="co">#&gt; 29  #F8766D 3.465823 19.93089 19.27511 20.58667 0.3259761       FALSE     1</span></span>
<span><span class="co">#&gt; 30  #F8766D 3.525316 19.77357 19.12751 20.41962 0.3211403       FALSE     1</span></span>
<span><span class="co">#&gt; 31  #F8766D 3.584810 19.61624 18.97853 20.25396 0.3169962       FALSE     1</span></span>
<span><span class="co">#&gt; 32  #F8766D 3.644304 19.45892 18.82810 20.08974 0.3135712       FALSE     1</span></span>
<span><span class="co">#&gt; 33  #F8766D 3.703797 19.30160 18.67617 19.92703 0.3108890       FALSE     1</span></span>
<span><span class="co">#&gt; 34  #F8766D 3.763291 19.14428 18.52271 19.76584 0.3089691       FALSE     1</span></span>
<span><span class="co">#&gt; 35  #F8766D 3.822785 18.98695 18.36769 19.60622 0.3078256       FALSE     1</span></span>
<span><span class="co">#&gt; 36  #F8766D 3.882278 18.82963 18.21109 19.44817 0.3074672       FALSE     1</span></span>
<span><span class="co">#&gt; 37  #F8766D 3.941772 18.67231 18.05290 19.29172 0.3078967       FALSE     1</span></span>
<span><span class="co">#&gt; 38  #F8766D 4.001266 18.51499 17.89313 19.13684 0.3091108       FALSE     1</span></span>
<span><span class="co">#&gt; 39  #F8766D 4.060759 18.35766 17.73181 18.98352 0.3111002       FALSE     1</span></span>
<span><span class="co">#&gt; 40  #F8766D 4.120253 18.20034 17.56895 18.83173 0.3138504       FALSE     1</span></span>
<span><span class="co">#&gt; 41  #F8766D 4.179747 18.04302 17.40461 18.68143 0.3173414       FALSE     1</span></span>
<span><span class="co">#&gt; 42  #F8766D 4.239241 17.88570 17.23882 18.53257 0.3215491       FALSE     1</span></span>
<span><span class="co">#&gt; 43  #F8766D 4.298734 17.72837 17.07165 18.38510 0.3264459       FALSE     1</span></span>
<span><span class="co">#&gt; 44  #F8766D 4.358228 17.57105 16.90315 18.23895 0.3320012       FALSE     1</span></span>
<span><span class="co">#&gt; 45  #F8766D 4.417722 17.41373 16.73339 18.09406 0.3381826       FALSE     1</span></span>
<span><span class="co">#&gt; 46  #F8766D 4.477215 17.25640 16.56244 17.95037 0.3449565       FALSE     1</span></span>
<span><span class="co">#&gt; 47  #F8766D 4.536709 17.09908 16.39037 17.80780 0.3522886       FALSE     1</span></span>
<span><span class="co">#&gt; 48  #F8766D 4.596203 16.94176 16.21724 17.66628 0.3601449       FALSE     1</span></span>
<span><span class="co">#&gt; 49  #F8766D 4.655696 16.78444 16.04313 17.52575 0.3684918       FALSE     1</span></span>
<span><span class="co">#&gt; 50  #F8766D 4.715190 16.62711 15.86809 17.38614 0.3772968       FALSE     1</span></span>
<span><span class="co">#&gt; 51  #F8766D 4.774684 16.46979 15.69220 17.24739 0.3865286       FALSE     1</span></span>
<span><span class="co">#&gt; 52  #F8766D 4.834177 16.31247 15.51550 17.10944 0.3961574       FALSE     1</span></span>
<span><span class="co">#&gt; 53  #F8766D 4.893671 16.15515 15.33807 16.97223 0.4061548       FALSE     1</span></span>
<span><span class="co">#&gt; 54  #F8766D 4.953165 15.99782 15.15995 16.83570 0.4164945       FALSE     1</span></span>
<span><span class="co">#&gt; 55  #F8766D 5.012658 15.84050 14.98118 16.69982 0.4271514       FALSE     1</span></span>
<span><span class="co">#&gt; 56  #F8766D 5.072152 15.68318 14.80183 16.56453 0.4381025       FALSE     1</span></span>
<span><span class="co">#&gt; 57  #F8766D 5.131646 15.52586 14.62193 16.42978 0.4493262       FALSE     1</span></span>
<span><span class="co">#&gt; 58  #F8766D 5.191139 15.36853 14.44152 16.29555 0.4608027       FALSE     1</span></span>
<span><span class="co">#&gt; 59  #F8766D 5.250633 15.21121 14.26064 16.16179 0.4725135       FALSE     1</span></span>
<span><span class="co">#&gt; 60  #F8766D 5.310127 15.05389 14.07932 16.02846 0.4844416       FALSE     1</span></span>
<span><span class="co">#&gt; 61  #F8766D 5.369620 14.89657 13.89759 15.89554 0.4965714       FALSE     1</span></span>
<span><span class="co">#&gt; 62  #F8766D 5.429114 14.73924 13.71549 15.76300 0.5088884       FALSE     1</span></span>
<span><span class="co">#&gt; 63  #F8766D 5.488608 14.58192 13.53304 15.63080 0.5213794       FALSE     1</span></span>
<span><span class="co">#&gt; 64  #F8766D 5.548101 14.42460 13.35026 15.49893 0.5340322       FALSE     1</span></span>
<span><span class="co">#&gt; 65  #F8766D 5.607595 14.26728 13.16719 15.36737 0.5468355       FALSE     1</span></span>
<span><span class="co">#&gt; 66  #F8766D 5.667089 14.10995 12.98382 15.23608 0.5597790       FALSE     1</span></span>
<span><span class="co">#&gt; 67  #F8766D 5.726582 13.95263 12.80020 15.10506 0.5728532       FALSE     1</span></span>
<span><span class="co">#&gt; 68  #F8766D 5.786076 13.79531 12.61633 14.97429 0.5860494       FALSE     1</span></span>
<span><span class="co">#&gt; 69  #F8766D 5.845570 13.63799 12.43223 14.84374 0.5993594       FALSE     1</span></span>
<span><span class="co">#&gt; 70  #F8766D 5.905063 13.48066 12.24792 14.71341 0.6127760       FALSE     1</span></span>
<span><span class="co">#&gt; 71  #F8766D 5.964557 13.32334 12.06340 14.58328 0.6262922       FALSE     1</span></span>
<span><span class="co">#&gt; 72  #F8766D 6.024051 13.16602 11.87870 14.45333 0.6399017       FALSE     1</span></span>
<span><span class="co">#&gt; 73  #F8766D 6.083544 13.00870 11.69383 14.32357 0.6535987       FALSE     1</span></span>
<span><span class="co">#&gt; 74  #F8766D 6.143038 12.85137 11.50878 14.19396 0.6673778       FALSE     1</span></span>
<span><span class="co">#&gt; 75  #F8766D 6.202532 12.69405 11.32359 14.06452 0.6812340       FALSE     1</span></span>
<span><span class="co">#&gt; 76  #F8766D 6.262025 12.53673 11.13824 13.93522 0.6951627       FALSE     1</span></span>
<span><span class="co">#&gt; 77  #F8766D 6.321519 12.37941 10.95276 13.80605 0.7091597       FALSE     1</span></span>
<span><span class="co">#&gt; 78  #F8766D 6.381013 12.22208 10.76715 13.67702 0.7232209       FALSE     1</span></span>
<span><span class="co">#&gt; 79  #F8766D 6.440506 12.06476 10.58142 13.54810 0.7373428       FALSE     1</span></span>
<span><span class="co">#&gt; 80  #F8766D 6.500000 11.90744 10.39557 13.41931 0.7515218       FALSE     1</span></span>
<span><span class="co">#&gt; 81  #00BA38 1.600000 31.78093 30.16782 33.39404 0.8049250       FALSE     1</span></span>
<span><span class="co">#&gt; 82  #00BA38 1.627848 31.65273 30.07403 33.23143 0.7877576       FALSE     1</span></span>
<span><span class="co">#&gt; 83  #00BA38 1.655696 31.52453 29.97980 33.06925 0.7708055       FALSE     1</span></span>
<span><span class="co">#&gt; 84  #00BA38 1.683544 31.39632 29.88511 32.90754 0.7540832       FALSE     1</span></span>
<span><span class="co">#&gt; 85  #00BA38 1.711392 31.26812 29.78993 32.74632 0.7376065       FALSE     1</span></span>
<span><span class="co">#&gt; 86  #00BA38 1.739241 31.13992 29.69422 32.58562 0.7213920       FALSE     1</span></span>
<span><span class="co">#&gt; 87  #00BA38 1.767089 31.01172 29.59795 32.42549 0.7054579       FALSE     1</span></span>
<span><span class="co">#&gt; 88  #00BA38 1.794937 30.88352 29.50108 32.26595 0.6898237       FALSE     1</span></span>
<span><span class="co">#&gt; 89  #00BA38 1.822785 30.75532 29.40357 32.10706 0.6745101       FALSE     1</span></span>
<span><span class="co">#&gt; 90  #00BA38 1.850633 30.62711 29.30537 31.94886 0.6595396       FALSE     1</span></span>
<span><span class="co">#&gt; 91  #00BA38 1.878481 30.49891 29.20643 31.79139 0.6449359       FALSE     1</span></span>
<span><span class="co">#&gt; 92  #00BA38 1.906329 30.37071 29.10671 31.63471 0.6307246       FALSE     1</span></span>
<span><span class="co">#&gt; 93  #00BA38 1.934177 30.24251 29.00615 31.47887 0.6169329       FALSE     1</span></span>
<span><span class="co">#&gt; 94  #00BA38 1.962025 30.11431 28.90469 31.32393 0.6035894       FALSE     1</span></span>
<span><span class="co">#&gt; 95  #00BA38 1.989873 29.98610 28.80227 31.16994 0.5907245       FALSE     1</span></span>
<span><span class="co">#&gt; 96  #00BA38 2.017722 29.85790 28.69882 31.01698 0.5783702       FALSE     1</span></span>
<span><span class="co">#&gt; 97  #00BA38 2.045570 29.72970 28.59429 30.86511 0.5665599       FALSE     1</span></span>
<span><span class="co">#&gt; 98  #00BA38 2.073418 29.60150 28.48860 30.71440 0.5553282       FALSE     1</span></span>
<span><span class="co">#&gt; 99  #00BA38 2.101266 29.47330 28.38167 30.56492 0.5447111       FALSE     1</span></span>
<span><span class="co">#&gt; 100 #00BA38 2.129114 29.34509 28.27344 30.41675 0.5347450       FALSE     1</span></span>
<span><span class="co">#&gt; 101 #00BA38 2.156962 29.21689 28.16383 30.26995 0.5254670       FALSE     1</span></span>
<span><span class="co">#&gt; 102 #00BA38 2.184810 29.08869 28.05277 30.12461 0.5169143       FALSE     1</span></span>
<span><span class="co">#&gt; 103 #00BA38 2.212658 28.96049 27.94018 29.98080 0.5091233       FALSE     1</span></span>
<span><span class="co">#&gt; 104 #00BA38 2.240506 28.83229 27.82600 29.83858 0.5021295       FALSE     1</span></span>
<span><span class="co">#&gt; 105 #00BA38 2.268354 28.70409 27.71015 29.69802 0.4959666       FALSE     1</span></span>
<span><span class="co">#&gt; 106 #00BA38 2.296203 28.57588 27.59257 29.55920 0.4906659       FALSE     1</span></span>
<span><span class="co">#&gt; 107 #00BA38 2.324051 28.44768 27.47320 29.42216 0.4862556       FALSE     1</span></span>
<span><span class="co">#&gt; 108 #00BA38 2.351899 28.31948 27.35201 29.28695 0.4827602       FALSE     1</span></span>
<span><span class="co">#&gt; 109 #00BA38 2.379747 28.19128 27.22894 29.15362 0.4801996       FALSE     1</span></span>
<span><span class="co">#&gt; 110 #00BA38 2.407595 28.06308 27.10396 29.02219 0.4785888       FALSE     1</span></span>
<span><span class="co">#&gt; 111 #00BA38 2.435443 27.93487 26.97707 28.89268 0.4779375       FALSE     1</span></span>
<span><span class="co">#&gt; 112 #00BA38 2.463291 27.80667 26.84824 28.76511 0.4782494       FALSE     1</span></span>
<span><span class="co">#&gt; 113 #00BA38 2.491139 27.67847 26.71749 28.63946 0.4795229       FALSE     1</span></span>
<span><span class="co">#&gt; 114 #00BA38 2.518987 27.55027 26.58482 28.51572 0.4817501       FALSE     1</span></span>
<span><span class="co">#&gt; 115 #00BA38 2.546835 27.42207 26.45027 28.39386 0.4849181       FALSE     1</span></span>
<span><span class="co">#&gt; 116 #00BA38 2.574684 27.29387 26.31387 28.27386 0.4890084       FALSE     1</span></span>
<span><span class="co">#&gt; 117 #00BA38 2.602532 27.16566 26.17567 28.15566 0.4939983       FALSE     1</span></span>
<span><span class="co">#&gt; 118 #00BA38 2.630380 27.03746 26.03572 28.03920 0.4998607       FALSE     1</span></span>
<span><span class="co">#&gt; 119 #00BA38 2.658228 26.90926 25.89408 27.92444 0.5065654       FALSE     1</span></span>
<span><span class="co">#&gt; 120 #00BA38 2.686076 26.78106 25.75082 27.81130 0.5140794       FALSE     1</span></span>
<span><span class="co">#&gt; 121 #00BA38 2.713924 26.65286 25.60601 27.69970 0.5223678       FALSE     1</span></span>
<span><span class="co">#&gt; 122 #00BA38 2.741772 26.52465 25.45972 27.58959 0.5313943       FALSE     1</span></span>
<span><span class="co">#&gt; 123 #00BA38 2.769620 26.39645 25.31202 27.48089 0.5411221       FALSE     1</span></span>
<span><span class="co">#&gt; 124 #00BA38 2.797468 26.26825 25.16299 27.37351 0.5515140       FALSE     1</span></span>
<span><span class="co">#&gt; 125 #00BA38 2.825316 26.14005 25.01271 27.26739 0.5625332       FALSE     1</span></span>
<span><span class="co">#&gt; 126 #00BA38 2.853165 26.01185 24.86124 27.16246 0.5741435       FALSE     1</span></span>
<span><span class="co">#&gt; 127 #00BA38 2.881013 25.88364 24.70865 27.05864 0.5863100       FALSE     1</span></span>
<span><span class="co">#&gt; 128 #00BA38 2.908861 25.75544 24.55502 26.95586 0.5989986       FALSE     1</span></span>
<span><span class="co">#&gt; 129 #00BA38 2.936709 25.62724 24.40041 26.85407 0.6121770       FALSE     1</span></span>
<span><span class="co">#&gt; 130 #00BA38 2.964557 25.49904 24.24488 26.75320 0.6258141       FALSE     1</span></span>
<span><span class="co">#&gt; 131 #00BA38 2.992405 25.37084 24.08849 26.65319 0.6398807       FALSE     1</span></span>
<span><span class="co">#&gt; 132 #00BA38 3.020253 25.24264 23.93129 26.55398 0.6543490       FALSE     1</span></span>
<span><span class="co">#&gt; 133 #00BA38 3.048101 25.11443 23.77334 26.45553 0.6691931       FALSE     1</span></span>
<span><span class="co">#&gt; 134 #00BA38 3.075949 24.98623 23.61469 26.35778 0.6843884       FALSE     1</span></span>
<span><span class="co">#&gt; 135 #00BA38 3.103797 24.85803 23.45538 26.26069 0.6999120       FALSE     1</span></span>
<span><span class="co">#&gt; 136 #00BA38 3.131646 24.72983 23.29545 26.16421 0.7157427       FALSE     1</span></span>
<span><span class="co">#&gt; 137 #00BA38 3.159494 24.60163 23.13495 26.06831 0.7318605       FALSE     1</span></span>
<span><span class="co">#&gt; 138 #00BA38 3.187342 24.47342 22.97390 25.97294 0.7482468       FALSE     1</span></span>
<span><span class="co">#&gt; 139 #00BA38 3.215190 24.34522 22.81236 25.87809 0.7648843       FALSE     1</span></span>
<span><span class="co">#&gt; 140 #00BA38 3.243038 24.21702 22.65034 25.78370 0.7817572       FALSE     1</span></span>
<span><span class="co">#&gt; 141 #00BA38 3.270886 24.08882 22.48789 25.68975 0.7988503       FALSE     1</span></span>
<span><span class="co">#&gt; 142 #00BA38 3.298734 23.96062 22.32502 25.59622 0.8161499       FALSE     1</span></span>
<span><span class="co">#&gt; 143 #00BA38 3.326582 23.83242 22.16176 25.50307 0.8336432       FALSE     1</span></span>
<span><span class="co">#&gt; 144 #00BA38 3.354430 23.70421 21.99813 25.41029 0.8513181       FALSE     1</span></span>
<span><span class="co">#&gt; 145 #00BA38 3.382278 23.57601 21.83417 25.31785 0.8691637       FALSE     1</span></span>
<span><span class="co">#&gt; 146 #00BA38 3.410127 23.44781 21.66988 25.22574 0.8871695       FALSE     1</span></span>
<span><span class="co">#&gt; 147 #00BA38 3.437975 23.31961 21.50529 25.13392 0.9053261       FALSE     1</span></span>
<span><span class="co">#&gt; 148 #00BA38 3.465823 23.19141 21.34042 25.04239 0.9236246       FALSE     1</span></span>
<span><span class="co">#&gt; 149 #00BA38 3.493671 23.06320 21.17528 24.95113 0.9420567       FALSE     1</span></span>
<span><span class="co">#&gt; 150 #00BA38 3.521519 22.93500 21.00989 24.86012 0.9606146       FALSE     1</span></span>
<span><span class="co">#&gt; 151 #00BA38 3.549367 22.80680 20.84426 24.76934 0.9792914       FALSE     1</span></span>
<span><span class="co">#&gt; 152 #00BA38 3.577215 22.67860 20.67840 24.67880 0.9980801       FALSE     1</span></span>
<span><span class="co">#&gt; 153 #00BA38 3.605063 22.55040 20.51233 24.58846 1.0169748       FALSE     1</span></span>
<span><span class="co">#&gt; 154 #00BA38 3.632911 22.42220 20.34607 24.49832 1.0359695       FALSE     1</span></span>
<span><span class="co">#&gt; 155 #00BA38 3.660759 22.29399 20.17961 24.40838 1.0550589       FALSE     1</span></span>
<span><span class="co">#&gt; 156 #00BA38 3.688608 22.16579 20.01297 24.31861 1.0742380       FALSE     1</span></span>
<span><span class="co">#&gt; 157 #00BA38 3.716456 22.03759 19.84616 24.22902 1.0935019       FALSE     1</span></span>
<span><span class="co">#&gt; 158 #00BA38 3.744304 21.90939 19.67919 24.13958 1.1128463       FALSE     1</span></span>
<span><span class="co">#&gt; 159 #00BA38 3.772152 21.78119 19.51207 24.05030 1.1322671       FALSE     1</span></span>
<span><span class="co">#&gt; 160 #00BA38 3.800000 21.65298 19.34480 23.96116 1.1517604       FALSE     1</span></span>
<span><span class="co">#&gt; 161 #619CFF 3.800000 23.46965 18.42826 28.51104 2.2285773       FALSE     1</span></span>
<span><span class="co">#&gt; 162 #619CFF 3.824051 23.41154 18.44650 28.37658 2.1948252       FALSE     1</span></span>
<span><span class="co">#&gt; 163 #619CFF 3.848101 23.35344 18.46432 28.24255 2.1612617       FALSE     1</span></span>
<span><span class="co">#&gt; 164 #619CFF 3.872152 23.29533 18.48170 28.10897 2.1278958       FALSE     1</span></span>
<span><span class="co">#&gt; 165 #619CFF 3.896203 23.23723 18.49860 27.97585 2.0947368       FALSE     1</span></span>
<span><span class="co">#&gt; 166 #619CFF 3.920253 23.17912 18.51502 27.84322 2.0617947       FALSE     1</span></span>
<span><span class="co">#&gt; 167 #619CFF 3.944304 23.12102 18.53092 27.71111 2.0290802       FALSE     1</span></span>
<span><span class="co">#&gt; 168 #619CFF 3.968354 23.06291 18.54628 27.57954 1.9966044       FALSE     1</span></span>
<span><span class="co">#&gt; 169 #619CFF 3.992405 23.00480 18.56107 27.44854 1.9643791       FALSE     1</span></span>
<span><span class="co">#&gt; 170 #619CFF 4.016456 22.94670 18.57527 27.31813 1.9324168       FALSE     1</span></span>
<span><span class="co">#&gt; 171 #619CFF 4.040506 22.88859 18.58884 27.18834 1.9007309       FALSE     1</span></span>
<span><span class="co">#&gt; 172 #619CFF 4.064557 22.83049 18.60176 27.05922 1.8693354       FALSE     1</span></span>
<span><span class="co">#&gt; 173 #619CFF 4.088608 22.77238 18.61398 26.93078 1.8382452       FALSE     1</span></span>
<span><span class="co">#&gt; 174 #619CFF 4.112658 22.71427 18.62548 26.80307 1.8074760       FALSE     1</span></span>
<span><span class="co">#&gt; 175 #619CFF 4.136709 22.65617 18.63621 26.67612 1.7770445       FALSE     1</span></span>
<span><span class="co">#&gt; 176 #619CFF 4.160759 22.59806 18.64615 26.54998 1.7469684       FALSE     1</span></span>
<span><span class="co">#&gt; 177 #619CFF 4.184810 22.53996 18.65523 26.42468 1.7172662       FALSE     1</span></span>
<span><span class="co">#&gt; 178 #619CFF 4.208861 22.48185 18.66342 26.30028 1.6879578       FALSE     1</span></span>
<span><span class="co">#&gt; 179 #619CFF 4.232911 22.42374 18.67068 26.17681 1.6590641       FALSE     1</span></span>
<span><span class="co">#&gt; 180 #619CFF 4.256962 22.36564 18.67695 26.05433 1.6306070       FALSE     1</span></span>
<span><span class="co">#&gt; 181 #619CFF 4.281013 22.30753 18.68218 25.93289 1.6026099       FALSE     1</span></span>
<span><span class="co">#&gt; 182 #619CFF 4.305063 22.24943 18.68631 25.81254 1.5750972       FALSE     1</span></span>
<span><span class="co">#&gt; 183 #619CFF 4.329114 22.19132 18.68929 25.69335 1.5480948       FALSE     1</span></span>
<span><span class="co">#&gt; 184 #619CFF 4.353165 22.13322 18.69105 25.57538 1.5216299       FALSE     1</span></span>
<span><span class="co">#&gt; 185 #619CFF 4.377215 22.07511 18.69153 25.45869 1.4957310       FALSE     1</span></span>
<span><span class="co">#&gt; 186 #619CFF 4.401266 22.01700 18.69066 25.34334 1.4704279       FALSE     1</span></span>
<span><span class="co">#&gt; 187 #619CFF 4.425316 21.95890 18.68838 25.22942 1.4457521       FALSE     1</span></span>
<span><span class="co">#&gt; 188 #619CFF 4.449367 21.90079 18.68460 25.11698 1.4217360       FALSE     1</span></span>
<span><span class="co">#&gt; 189 #619CFF 4.473418 21.84269 18.67925 25.00612 1.3984138       FALSE     1</span></span>
<span><span class="co">#&gt; 190 #619CFF 4.497468 21.78458 18.67226 24.89690 1.3758208       FALSE     1</span></span>
<span><span class="co">#&gt; 191 #619CFF 4.521519 21.72647 18.66353 24.78942 1.3539933       FALSE     1</span></span>
<span><span class="co">#&gt; 192 #619CFF 4.545570 21.66837 18.65298 24.68375 1.3329691       FALSE     1</span></span>
<span><span class="co">#&gt; 193 #619CFF 4.569620 21.61026 18.64053 24.57999 1.3127867       FALSE     1</span></span>
<span><span class="co">#&gt; 194 #619CFF 4.593671 21.55216 18.62609 24.47822 1.2934855       FALSE     1</span></span>
<span><span class="co">#&gt; 195 #619CFF 4.617722 21.49405 18.60956 24.37854 1.2751055       FALSE     1</span></span>
<span><span class="co">#&gt; 196 #619CFF 4.641772 21.43594 18.59086 24.28103 1.2576872       FALSE     1</span></span>
<span><span class="co">#&gt; 197 #619CFF 4.665823 21.37784 18.56989 24.18579 1.2412710       FALSE     1</span></span>
<span><span class="co">#&gt; 198 #619CFF 4.689873 21.31973 18.54656 24.09291 1.2258972       FALSE     1</span></span>
<span><span class="co">#&gt; 199 #619CFF 4.713924 21.26163 18.52079 24.00247 1.2116055       FALSE     1</span></span>
<span><span class="co">#&gt; 200 #619CFF 4.737975 21.20352 18.49247 23.91457 1.1984345       FALSE     1</span></span>
<span><span class="co">#&gt; 201 #619CFF 4.762025 21.14542 18.46154 23.82929 1.1864216       FALSE     1</span></span>
<span><span class="co">#&gt; 202 #619CFF 4.786076 21.08731 18.42791 23.74671 1.1756023       FALSE     1</span></span>
<span><span class="co">#&gt; 203 #619CFF 4.810127 21.02920 18.39151 23.66690 1.1660099       FALSE     1</span></span>
<span><span class="co">#&gt; 204 #619CFF 4.834177 20.97110 18.35226 23.58994 1.1576747       FALSE     1</span></span>
<span><span class="co">#&gt; 205 #619CFF 4.858228 20.91299 18.31010 23.51588 1.1506242       FALSE     1</span></span>
<span><span class="co">#&gt; 206 #619CFF 4.882278 20.85489 18.26498 23.44479 1.1448821       FALSE     1</span></span>
<span><span class="co">#&gt; 207 #619CFF 4.906329 20.79678 18.21686 23.37670 1.1404681       FALSE     1</span></span>
<span><span class="co">#&gt; 208 #619CFF 4.930380 20.73867 18.16570 23.31165 1.1373978       FALSE     1</span></span>
<span><span class="co">#&gt; 209 #619CFF 4.954430 20.68057 18.11148 23.24966 1.1356819       FALSE     1</span></span>
<span><span class="co">#&gt; 210 #619CFF 4.978481 20.62246 18.05418 23.19075 1.1353267       FALSE     1</span></span>
<span><span class="co">#&gt; 211 #619CFF 5.002532 20.56436 17.99379 23.13492 1.1363334       FALSE     1</span></span>
<span><span class="co">#&gt; 212 #619CFF 5.026582 20.50625 17.93034 23.08217 1.1386984       FALSE     1</span></span>
<span><span class="co">#&gt; 213 #619CFF 5.050633 20.44815 17.86383 23.03246 1.1424133       FALSE     1</span></span>
<span><span class="co">#&gt; 214 #619CFF 5.074684 20.39004 17.79429 22.98579 1.1474649       FALSE     1</span></span>
<span><span class="co">#&gt; 215 #619CFF 5.098734 20.33193 17.72178 22.94209 1.1538358       FALSE     1</span></span>
<span><span class="co">#&gt; 216 #619CFF 5.122785 20.27383 17.64632 22.90133 1.1615041       FALSE     1</span></span>
<span><span class="co">#&gt; 217 #619CFF 5.146835 20.21572 17.56799 22.86345 1.1704445       FALSE     1</span></span>
<span><span class="co">#&gt; 218 #619CFF 5.170886 20.15762 17.48685 22.82838 1.1806279       FALSE     1</span></span>
<span><span class="co">#&gt; 219 #619CFF 5.194937 20.09951 17.40297 22.79605 1.1920226       FALSE     1</span></span>
<span><span class="co">#&gt; 220 #619CFF 5.218987 20.04140 17.31642 22.76639 1.2045942       FALSE     1</span></span>
<span><span class="co">#&gt; 221 #619CFF 5.243038 19.98330 17.22730 22.73930 1.2183062       FALSE     1</span></span>
<span><span class="co">#&gt; 222 #619CFF 5.267089 19.92519 17.13568 22.71470 1.2331205       FALSE     1</span></span>
<span><span class="co">#&gt; 223 #619CFF 5.291139 19.86709 17.04166 22.69252 1.2489981       FALSE     1</span></span>
<span><span class="co">#&gt; 224 #619CFF 5.315190 19.80898 16.94532 22.67264 1.2658988       FALSE     1</span></span>
<span><span class="co">#&gt; 225 #619CFF 5.339241 19.75087 16.84676 22.65499 1.2837823       FALSE     1</span></span>
<span><span class="co">#&gt; 226 #619CFF 5.363291 19.69277 16.74606 22.63947 1.3026080       FALSE     1</span></span>
<span><span class="co">#&gt; 227 #619CFF 5.387342 19.63466 16.64333 22.62599 1.3223358       FALSE     1</span></span>
<span><span class="co">#&gt; 228 #619CFF 5.411392 19.57656 16.53865 22.61447 1.3429259       FALSE     1</span></span>
<span><span class="co">#&gt; 229 #619CFF 5.435443 19.51845 16.43210 22.60480 1.3643392       FALSE     1</span></span>
<span><span class="co">#&gt; 230 #619CFF 5.459494 19.46035 16.32378 22.59691 1.3865376       FALSE     1</span></span>
<span><span class="co">#&gt; 231 #619CFF 5.483544 19.40224 16.21377 22.59071 1.4094840       FALSE     1</span></span>
<span><span class="co">#&gt; 232 #619CFF 5.507595 19.34413 16.10214 22.58613 1.4331425       FALSE     1</span></span>
<span><span class="co">#&gt; 233 #619CFF 5.531646 19.28603 15.98898 22.58307 1.4574784       FALSE     1</span></span>
<span><span class="co">#&gt; 234 #619CFF 5.555696 19.22792 15.87437 22.58148 1.4824584       FALSE     1</span></span>
<span><span class="co">#&gt; 235 #619CFF 5.579747 19.16982 15.75837 22.58126 1.5080503       FALSE     1</span></span>
<span><span class="co">#&gt; 236 #619CFF 5.603797 19.11171 15.64105 22.58237 1.5342237       FALSE     1</span></span>
<span><span class="co">#&gt; 237 #619CFF 5.627848 19.05360 15.52249 22.58472 1.5609493       FALSE     1</span></span>
<span><span class="co">#&gt; 238 #619CFF 5.651899 18.99550 15.40274 22.58825 1.5881991       FALSE     1</span></span>
<span><span class="co">#&gt; 239 #619CFF 5.675949 18.93739 15.28187 22.59292 1.6159468       FALSE     1</span></span>
<span><span class="co">#&gt; 240 #619CFF 5.700000 18.87929 15.15992 22.59865 1.6441669       FALSE     1</span></span>
<span><span class="co">#&gt; 241 #F8766D 2.000000 26.31880 24.82002 27.81758 0.7469075       FALSE     2</span></span>
<span><span class="co">#&gt; 242 #F8766D 2.051899 26.15027 24.68063 27.61991 0.7323869       FALSE     2</span></span>
<span><span class="co">#&gt; 243 #F8766D 2.103797 25.98174 24.54107 27.42240 0.7179459       FALSE     2</span></span>
<span><span class="co">#&gt; 244 #F8766D 2.155696 25.81321 24.40135 27.22506 0.7035895       FALSE     2</span></span>
<span><span class="co">#&gt; 245 #F8766D 2.207595 25.64468 24.26145 27.02791 0.6893229       FALSE     2</span></span>
<span><span class="co">#&gt; 246 #F8766D 2.259494 25.47615 24.12136 26.83094 0.6751519       FALSE     2</span></span>
<span><span class="co">#&gt; 247 #F8766D 2.311392 25.30762 23.98106 26.63418 0.6610825       FALSE     2</span></span>
<span><span class="co">#&gt; 248 #F8766D 2.363291 25.13909 23.84055 26.43764 0.6471215       FALSE     2</span></span>
<span><span class="co">#&gt; 249 #F8766D 2.415190 24.97056 23.69980 26.24132 0.6332759       FALSE     2</span></span>
<span><span class="co">#&gt; 250 #F8766D 2.467089 24.80203 23.55881 26.04526 0.6195535       FALSE     2</span></span>
<span><span class="co">#&gt; 251 #F8766D 2.518987 24.63350 23.41755 25.84946 0.6059628       FALSE     2</span></span>
<span><span class="co">#&gt; 252 #F8766D 2.570886 24.46497 23.27601 25.65394 0.5925126       FALSE     2</span></span>
<span><span class="co">#&gt; 253 #F8766D 2.622785 24.29644 23.13417 25.45872 0.5792130       FALSE     2</span></span>
<span><span class="co">#&gt; 254 #F8766D 2.674684 24.12791 22.99200 25.26383 0.5660743       FALSE     2</span></span>
<span><span class="co">#&gt; 255 #F8766D 2.726582 23.95939 22.84949 25.06928 0.5531082       FALSE     2</span></span>
<span><span class="co">#&gt; 256 #F8766D 2.778481 23.79086 22.70661 24.87510 0.5403270       FALSE     2</span></span>
<span><span class="co">#&gt; 257 #F8766D 2.830380 23.62233 22.56333 24.68132 0.5277442       FALSE     2</span></span>
<span><span class="co">#&gt; 258 #F8766D 2.882278 23.45380 22.41962 24.48797 0.5153743       FALSE     2</span></span>
<span><span class="co">#&gt; 259 #F8766D 2.934177 23.28527 22.27546 24.29508 0.5032330       FALSE     2</span></span>
<span><span class="co">#&gt; 260 #F8766D 2.986076 23.11674 22.13080 24.10268 0.4913373       FALSE     2</span></span>
<span><span class="co">#&gt; 261 #F8766D 3.037975 22.94821 21.98561 23.91081 0.4797053       FALSE     2</span></span>
<span><span class="co">#&gt; 262 #F8766D 3.089873 22.77968 21.83985 23.71951 0.4683569       FALSE     2</span></span>
<span><span class="co">#&gt; 263 #F8766D 3.141772 22.61115 21.69348 23.52882 0.4573131       FALSE     2</span></span>
<span><span class="co">#&gt; 264 #F8766D 3.193671 22.44262 21.54646 23.33878 0.4465964       FALSE     2</span></span>
<span><span class="co">#&gt; 265 #F8766D 3.245570 22.27409 21.39873 23.14945 0.4362310       FALSE     2</span></span>
<span><span class="co">#&gt; 266 #F8766D 3.297468 22.10556 21.25024 22.96088 0.4262426       FALSE     2</span></span>
<span><span class="co">#&gt; 267 #F8766D 3.349367 21.93703 21.10095 22.77312 0.4166582       FALSE     2</span></span>
<span><span class="co">#&gt; 268 #F8766D 3.401266 21.76850 20.95078 22.58622 0.4075063       FALSE     2</span></span>
<span><span class="co">#&gt; 269 #F8766D 3.453165 21.59997 20.79969 22.40026 0.3988167       FALSE     2</span></span>
<span><span class="co">#&gt; 270 #F8766D 3.505063 21.43144 20.64761 22.21528 0.3906204       FALSE     2</span></span>
<span><span class="co">#&gt; 271 #F8766D 3.556962 21.26291 20.49447 22.03136 0.3829488       FALSE     2</span></span>
<span><span class="co">#&gt; 272 #F8766D 3.608861 21.09439 20.34022 21.84855 0.3758343       FALSE     2</span></span>
<span><span class="co">#&gt; 273 #F8766D 3.660759 20.92586 20.18478 21.66693 0.3693089       FALSE     2</span></span>
<span><span class="co">#&gt; 274 #F8766D 3.712658 20.75733 20.02810 21.48655 0.3634045       FALSE     2</span></span>
<span><span class="co">#&gt; 275 #F8766D 3.764557 20.58880 19.87011 21.30748 0.3581517       FALSE     2</span></span>
<span><span class="co">#&gt; 276 #F8766D 3.816456 20.42027 19.71076 21.12978 0.3535795       FALSE     2</span></span>
<span><span class="co">#&gt; 277 #F8766D 3.868354 20.25174 19.54998 20.95349 0.3497147       FALSE     2</span></span>
<span><span class="co">#&gt; 278 #F8766D 3.920253 20.08321 19.38774 20.77867 0.3465809       FALSE     2</span></span>
<span><span class="co">#&gt; 279 #F8766D 3.972152 19.91468 19.22400 20.60536 0.3441982       FALSE     2</span></span>
<span><span class="co">#&gt; 280 #F8766D 4.024051 19.74615 19.05871 20.43359 0.3425821       FALSE     2</span></span>
<span><span class="co">#&gt; 281 #F8766D 4.075949 19.57762 18.89186 20.26338 0.3417436       FALSE     2</span></span>
<span><span class="co">#&gt; 282 #F8766D 4.127848 19.40909 18.72344 20.09474 0.3416883       FALSE     2</span></span>
<span><span class="co">#&gt; 283 #F8766D 4.179747 19.24056 18.55345 19.92767 0.3424167       FALSE     2</span></span>
<span><span class="co">#&gt; 284 #F8766D 4.231646 19.07203 18.38190 19.76217 0.3439237       FALSE     2</span></span>
<span><span class="co">#&gt; 285 #F8766D 4.283544 18.90350 18.20880 19.59820 0.3461993       FALSE     2</span></span>
<span><span class="co">#&gt; 286 #F8766D 4.335443 18.73497 18.03420 19.43575 0.3492283       FALSE     2</span></span>
<span><span class="co">#&gt; 287 #F8766D 4.387342 18.56644 17.85812 19.27477 0.3529915       FALSE     2</span></span>
<span><span class="co">#&gt; 288 #F8766D 4.439241 18.39792 17.68061 19.11522 0.3574655       FALSE     2</span></span>
<span><span class="co">#&gt; 289 #F8766D 4.491139 18.22939 17.50173 18.95704 0.3626241       FALSE     2</span></span>
<span><span class="co">#&gt; 290 #F8766D 4.543038 18.06086 17.32153 18.80018 0.3684386       FALSE     2</span></span>
<span><span class="co">#&gt; 291 #F8766D 4.594937 17.89233 17.14008 18.64458 0.3748783       FALSE     2</span></span>
<span><span class="co">#&gt; 292 #F8766D 4.646835 17.72380 16.95744 18.49016 0.3819118       FALSE     2</span></span>
<span><span class="co">#&gt; 293 #F8766D 4.698734 17.55527 16.77367 18.33687 0.3895068       FALSE     2</span></span>
<span><span class="co">#&gt; 294 #F8766D 4.750633 17.38674 16.58883 18.18464 0.3976311       FALSE     2</span></span>
<span><span class="co">#&gt; 295 #F8766D 4.802532 17.21821 16.40300 18.03342 0.4062531       FALSE     2</span></span>
<span><span class="co">#&gt; 296 #F8766D 4.854430 17.04968 16.21624 17.88312 0.4153416       FALSE     2</span></span>
<span><span class="co">#&gt; 297 #F8766D 4.906329 16.88115 16.02859 17.73371 0.4248668       FALSE     2</span></span>
<span><span class="co">#&gt; 298 #F8766D 4.958228 16.71262 15.84013 17.58511 0.4348000       FALSE     2</span></span>
<span><span class="co">#&gt; 299 #F8766D 5.010127 16.54409 15.65091 17.43728 0.4451139       FALSE     2</span></span>
<span><span class="co">#&gt; 300 #F8766D 5.062025 16.37556 15.46097 17.29016 0.4557825       FALSE     2</span></span>
<span><span class="co">#&gt; 301 #F8766D 5.113924 16.20703 15.27037 17.14370 0.4667817       FALSE     2</span></span>
<span><span class="co">#&gt; 302 #F8766D 5.165823 16.03850 15.07915 16.99786 0.4780885       FALSE     2</span></span>
<span><span class="co">#&gt; 303 #F8766D 5.217722 15.86997 14.88736 16.85259 0.4896817       FALSE     2</span></span>
<span><span class="co">#&gt; 304 #F8766D 5.269620 15.70144 14.69503 16.70786 0.5015414       FALSE     2</span></span>
<span><span class="co">#&gt; 305 #F8766D 5.321519 15.53292 14.50220 16.56363 0.5136491       FALSE     2</span></span>
<span><span class="co">#&gt; 306 #F8766D 5.373418 15.36439 14.30891 16.41986 0.5259878       FALSE     2</span></span>
<span><span class="co">#&gt; 307 #F8766D 5.425316 15.19586 14.11519 16.27652 0.5385415       FALSE     2</span></span>
<span><span class="co">#&gt; 308 #F8766D 5.477215 15.02733 13.92107 16.13358 0.5512955       FALSE     2</span></span>
<span><span class="co">#&gt; 309 #F8766D 5.529114 14.85880 13.72657 15.99102 0.5642364       FALSE     2</span></span>
<span><span class="co">#&gt; 310 #F8766D 5.581013 14.69027 13.53173 15.84881 0.5773514       FALSE     2</span></span>
<span><span class="co">#&gt; 311 #F8766D 5.632911 14.52174 13.33655 15.70692 0.5906291       FALSE     2</span></span>
<span><span class="co">#&gt; 312 #F8766D 5.684810 14.35321 13.14108 15.56534 0.6040586       FALSE     2</span></span>
<span><span class="co">#&gt; 313 #F8766D 5.736709 14.18468 12.94531 15.42405 0.6176301       FALSE     2</span></span>
<span><span class="co">#&gt; 314 #F8766D 5.788608 14.01615 12.74929 15.28302 0.6313345       FALSE     2</span></span>
<span><span class="co">#&gt; 315 #F8766D 5.840506 13.84762 12.55301 15.14224 0.6451632       FALSE     2</span></span>
<span><span class="co">#&gt; 316 #F8766D 5.892405 13.67909 12.35649 15.00169 0.6591084       FALSE     2</span></span>
<span><span class="co">#&gt; 317 #F8766D 5.944304 13.51056 12.15976 14.86136 0.6731629       FALSE     2</span></span>
<span><span class="co">#&gt; 318 #F8766D 5.996203 13.34203 11.96282 14.72124 0.6873200       FALSE     2</span></span>
<span><span class="co">#&gt; 319 #F8766D 6.048101 13.17350 11.76569 14.58131 0.7015734       FALSE     2</span></span>
<span><span class="co">#&gt; 320 #F8766D 6.100000 13.00497 11.56838 14.44157 0.7159175       FALSE     2</span></span>
<span><span class="co">#&gt; 321 #00BA38 1.800000 31.28839 30.00524 32.57153 0.6378289       FALSE     2</span></span>
<span><span class="co">#&gt; 322 #00BA38 1.844304 31.14798 29.90153 32.39443 0.6195883       FALSE     2</span></span>
<span><span class="co">#&gt; 323 #00BA38 1.888608 31.00757 29.79698 32.21815 0.6017611       FALSE     2</span></span>
<span><span class="co">#&gt; 324 #00BA38 1.932911 30.86715 29.69152 32.04279 0.5843854       FALSE     2</span></span>
<span><span class="co">#&gt; 325 #00BA38 1.977215 30.72674 29.58508 31.86841 0.5675024       FALSE     2</span></span>
<span><span class="co">#&gt; 326 #00BA38 2.021519 30.58633 29.47755 31.69512 0.5511576       FALSE     2</span></span>
<span><span class="co">#&gt; 327 #00BA38 2.065823 30.44592 29.36884 31.52301 0.5354002       FALSE     2</span></span>
<span><span class="co">#&gt; 328 #00BA38 2.110127 30.30551 29.25884 31.35219 0.5202836       FALSE     2</span></span>
<span><span class="co">#&gt; 329 #00BA38 2.154430 30.16510 29.14743 31.18277 0.5058652       FALSE     2</span></span>
<span><span class="co">#&gt; 330 #00BA38 2.198734 30.02469 29.03450 31.01488 0.4922064       FALSE     2</span></span>
<span><span class="co">#&gt; 331 #00BA38 2.243038 29.88428 28.91991 30.84865 0.4793722       FALSE     2</span></span>
<span><span class="co">#&gt; 332 #00BA38 2.287342 29.74387 28.80352 30.68422 0.4674304       FALSE     2</span></span>
<span><span class="co">#&gt; 333 #00BA38 2.331646 29.60346 28.68520 30.52172 0.4564511       FALSE     2</span></span>
<span><span class="co">#&gt; 334 #00BA38 2.375949 29.46305 28.56479 30.36130 0.4465054       FALSE     2</span></span>
<span><span class="co">#&gt; 335 #00BA38 2.420253 29.32264 28.44217 30.20310 0.4376636       FALSE     2</span></span>
<span><span class="co">#&gt; 336 #00BA38 2.464557 29.18223 28.31719 30.04726 0.4299939       FALSE     2</span></span>
<span><span class="co">#&gt; 337 #00BA38 2.508861 29.04182 28.18972 29.89391 0.4235600       FALSE     2</span></span>
<span><span class="co">#&gt; 338 #00BA38 2.553165 28.90140 28.05965 29.74316 0.4184189       FALSE     2</span></span>
<span><span class="co">#&gt; 339 #00BA38 2.597468 28.76099 27.92689 29.59510 0.4146186       FALSE     2</span></span>
<span><span class="co">#&gt; 340 #00BA38 2.641772 28.62058 27.79135 29.44982 0.4121963       FALSE     2</span></span>
<span><span class="co">#&gt; 341 #00BA38 2.686076 28.48017 27.65299 29.30735 0.4111763       FALSE     2</span></span>
<span><span class="co">#&gt; 342 #00BA38 2.730380 28.33976 27.51179 29.16773 0.4115690       FALSE     2</span></span>
<span><span class="co">#&gt; 343 #00BA38 2.774684 28.19935 27.36776 29.03095 0.4133705       FALSE     2</span></span>
<span><span class="co">#&gt; 344 #00BA38 2.818987 28.05894 27.22093 28.89696 0.4165624       FALSE     2</span></span>
<span><span class="co">#&gt; 345 #00BA38 2.863291 27.91853 27.07136 28.76570 0.4211131       FALSE     2</span></span>
<span><span class="co">#&gt; 346 #00BA38 2.907595 27.77812 26.91915 28.63709 0.4269791       FALSE     2</span></span>
<span><span class="co">#&gt; 347 #00BA38 2.951899 27.63771 26.76440 28.51102 0.4341073       FALSE     2</span></span>
<span><span class="co">#&gt; 348 #00BA38 2.996203 27.49730 26.60723 28.38737 0.4424365       FALSE     2</span></span>
<span><span class="co">#&gt; 349 #00BA38 3.040506 27.35689 26.44778 28.26599 0.4519003       FALSE     2</span></span>
<span><span class="co">#&gt; 350 #00BA38 3.084810 27.21648 26.28619 28.14676 0.4624291       FALSE     2</span></span>
<span><span class="co">#&gt; 351 #00BA38 3.129114 27.07607 26.12260 28.02953 0.4739520       FALSE     2</span></span>
<span><span class="co">#&gt; 352 #00BA38 3.173418 26.93566 25.95715 27.91416 0.4863982       FALSE     2</span></span>
<span><span class="co">#&gt; 353 #00BA38 3.217722 26.79524 25.78998 27.80051 0.4996989       FALSE     2</span></span>
<span><span class="co">#&gt; 354 #00BA38 3.262025 26.65483 25.62123 27.68844 0.5137875       FALSE     2</span></span>
<span><span class="co">#&gt; 355 #00BA38 3.306329 26.51442 25.45101 27.57783 0.5286012       FALSE     2</span></span>
<span><span class="co">#&gt; 356 #00BA38 3.350633 26.37401 25.27946 27.46856 0.5440808       FALSE     2</span></span>
<span><span class="co">#&gt; 357 #00BA38 3.394937 26.23360 25.10668 27.36052 0.5601709       FALSE     2</span></span>
<span><span class="co">#&gt; 358 #00BA38 3.439241 26.09319 24.93278 27.25360 0.5768206       FALSE     2</span></span>
<span><span class="co">#&gt; 359 #00BA38 3.483544 25.95278 24.75784 27.14772 0.5939827       FALSE     2</span></span>
<span><span class="co">#&gt; 360 #00BA38 3.527848 25.81237 24.58196 27.04278 0.6116142       FALSE     2</span></span>
<span><span class="co">#&gt; 361 #00BA38 3.572152 25.67196 24.40522 26.93870 0.6296756       FALSE     2</span></span>
<span><span class="co">#&gt; 362 #00BA38 3.616456 25.53155 24.22768 26.83542 0.6481309       FALSE     2</span></span>
<span><span class="co">#&gt; 363 #00BA38 3.660759 25.39114 24.04941 26.73286 0.6669476       FALSE     2</span></span>
<span><span class="co">#&gt; 364 #00BA38 3.705063 25.25073 23.87048 26.63097 0.6860957       FALSE     2</span></span>
<span><span class="co">#&gt; 365 #00BA38 3.749367 25.11032 23.69094 26.52970 0.7055485       FALSE     2</span></span>
<span><span class="co">#&gt; 366 #00BA38 3.793671 24.96991 23.51083 26.42898 0.7252812       FALSE     2</span></span>
<span><span class="co">#&gt; 367 #00BA38 3.837975 24.82949 23.33020 26.32879 0.7452718       FALSE     2</span></span>
<span><span class="co">#&gt; 368 #00BA38 3.882278 24.68908 23.14910 26.22907 0.7655000       FALSE     2</span></span>
<span><span class="co">#&gt; 369 #00BA38 3.926582 24.54867 22.96755 26.12980 0.7859474       FALSE     2</span></span>
<span><span class="co">#&gt; 370 #00BA38 3.970886 24.40826 22.78560 26.03093 0.8065974       FALSE     2</span></span>
<span><span class="co">#&gt; 371 #00BA38 4.015190 24.26785 22.60327 25.93244 0.8274349       FALSE     2</span></span>
<span><span class="co">#&gt; 372 #00BA38 4.059494 24.12744 22.42059 25.83429 0.8484459       FALSE     2</span></span>
<span><span class="co">#&gt; 373 #00BA38 4.103797 23.98703 22.23758 25.73648 0.8696180       FALSE     2</span></span>
<span><span class="co">#&gt; 374 #00BA38 4.148101 23.84662 22.05428 25.63896 0.8909396       FALSE     2</span></span>
<span><span class="co">#&gt; 375 #00BA38 4.192405 23.70621 21.87070 25.54172 0.9124003       FALSE     2</span></span>
<span><span class="co">#&gt; 376 #00BA38 4.236709 23.56580 21.68685 25.44474 0.9339905       FALSE     2</span></span>
<span><span class="co">#&gt; 377 #00BA38 4.281013 23.42539 21.50276 25.34801 0.9557013       FALSE     2</span></span>
<span><span class="co">#&gt; 378 #00BA38 4.325316 23.28498 21.31845 25.25150 0.9775248       FALSE     2</span></span>
<span><span class="co">#&gt; 379 #00BA38 4.369620 23.14457 21.13392 25.15521 0.9994536       FALSE     2</span></span>
<span><span class="co">#&gt; 380 #00BA38 4.413924 23.00416 20.94920 25.05911 1.0214809       FALSE     2</span></span>
<span><span class="co">#&gt; 381 #00BA38 4.458228 22.86374 20.76429 24.96320 1.0436005       FALSE     2</span></span>
<span><span class="co">#&gt; 382 #00BA38 4.502532 22.72333 20.57921 24.86746 1.0658065       FALSE     2</span></span>
<span><span class="co">#&gt; 383 #00BA38 4.546835 22.58292 20.39396 24.77189 1.0880938       FALSE     2</span></span>
<span><span class="co">#&gt; 384 #00BA38 4.591139 22.44251 20.20856 24.67647 1.1104574       FALSE     2</span></span>
<span><span class="co">#&gt; 385 #00BA38 4.635443 22.30210 20.02302 24.58119 1.1328929       FALSE     2</span></span>
<span><span class="co">#&gt; 386 #00BA38 4.679747 22.16169 19.83733 24.48605 1.1553959       FALSE     2</span></span>
<span><span class="co">#&gt; 387 #00BA38 4.724051 22.02128 19.65153 24.39104 1.1779627       FALSE     2</span></span>
<span><span class="co">#&gt; 388 #00BA38 4.768354 21.88087 19.46560 24.29614 1.2005897       FALSE     2</span></span>
<span><span class="co">#&gt; 389 #00BA38 4.812658 21.74046 19.27955 24.20137 1.2232735       FALSE     2</span></span>
<span><span class="co">#&gt; 390 #00BA38 4.856962 21.60005 19.09340 24.10670 1.2460110       FALSE     2</span></span>
<span><span class="co">#&gt; 391 #00BA38 4.901266 21.45964 18.90714 24.01213 1.2687993       FALSE     2</span></span>
<span><span class="co">#&gt; 392 #00BA38 4.945570 21.31923 18.72079 23.91766 1.2916358       FALSE     2</span></span>
<span><span class="co">#&gt; 393 #00BA38 4.989873 21.17882 18.53435 23.82329 1.3145179       FALSE     2</span></span>
<span><span class="co">#&gt; 394 #00BA38 5.034177 21.03841 18.34782 23.72899 1.3374432       FALSE     2</span></span>
<span><span class="co">#&gt; 395 #00BA38 5.078481 20.89800 18.16120 23.63479 1.3604097       FALSE     2</span></span>
<span><span class="co">#&gt; 396 #00BA38 5.122785 20.75758 17.97451 23.54066 1.3834152       FALSE     2</span></span>
<span><span class="co">#&gt; 397 #00BA38 5.167089 20.61717 17.78775 23.44660 1.4064579       FALSE     2</span></span>
<span><span class="co">#&gt; 398 #00BA38 5.211392 20.47676 17.60091 23.35262 1.4295359       FALSE     2</span></span>
<span><span class="co">#&gt; 399 #00BA38 5.255696 20.33635 17.41400 23.25870 1.4526475       FALSE     2</span></span>
<span><span class="co">#&gt; 400 #00BA38 5.300000 20.19594 17.22703 23.16485 1.4757912       FALSE     2</span></span>
<span><span class="co">#&gt; 401 #619CFF 4.000000 21.70513 17.63528 25.77498 1.8679207       FALSE     2</span></span>
<span><span class="co">#&gt; 402 #619CFF 4.037975 21.69321 17.70716 25.67925 1.8294576       FALSE     2</span></span>
<span><span class="co">#&gt; 403 #619CFF 4.075949 21.68128 17.77834 25.58422 1.7913135       FALSE     2</span></span>
<span><span class="co">#&gt; 404 #619CFF 4.113924 21.66936 17.84879 25.48993 1.7535091       FALSE     2</span></span>
<span><span class="co">#&gt; 405 #619CFF 4.151899 21.65743 17.91844 25.39642 1.7160670       FALSE     2</span></span>
<span><span class="co">#&gt; 406 #619CFF 4.189873 21.64551 17.98726 25.30376 1.6790114       FALSE     2</span></span>
<span><span class="co">#&gt; 407 #619CFF 4.227848 21.63358 18.05517 25.21200 1.6423684       FALSE     2</span></span>
<span><span class="co">#&gt; 408 #619CFF 4.265823 21.62166 18.12213 25.12120 1.6061662       FALSE     2</span></span>
<span><span class="co">#&gt; 409 #619CFF 4.303797 21.60974 18.18805 25.03142 1.5704354       FALSE     2</span></span>
<span><span class="co">#&gt; 410 #619CFF 4.341772 21.59781 18.25288 24.94275 1.5352089       FALSE     2</span></span>
<span><span class="co">#&gt; 411 #619CFF 4.379747 21.58589 18.31653 24.85525 1.5005221       FALSE     2</span></span>
<span><span class="co">#&gt; 412 #619CFF 4.417722 21.57396 18.37892 24.76900 1.4664135       FALSE     2</span></span>
<span><span class="co">#&gt; 413 #619CFF 4.455696 21.56204 18.43997 24.68411 1.4329242       FALSE     2</span></span>
<span><span class="co">#&gt; 414 #619CFF 4.493671 21.55012 18.49956 24.60067 1.4000987       FALSE     2</span></span>
<span><span class="co">#&gt; 415 #619CFF 4.531646 21.53819 18.55761 24.51878 1.3679849       FALSE     2</span></span>
<span><span class="co">#&gt; 416 #619CFF 4.569620 21.52627 18.61399 24.43854 1.3366339       FALSE     2</span></span>
<span><span class="co">#&gt; 417 #619CFF 4.607595 21.51434 18.66859 24.36009 1.3061008       FALSE     2</span></span>
<span><span class="co">#&gt; 418 #619CFF 4.645570 21.50242 18.72129 24.28355 1.2764442       FALSE     2</span></span>
<span><span class="co">#&gt; 419 #619CFF 4.683544 21.49050 18.77193 24.20906 1.2477266       FALSE     2</span></span>
<span><span class="co">#&gt; 420 #619CFF 4.721519 21.47857 18.82039 24.13675 1.2200143       FALSE     2</span></span>
<span><span class="co">#&gt; 421 #619CFF 4.759494 21.46665 18.86650 24.06679 1.1933775       FALSE     2</span></span>
<span><span class="co">#&gt; 422 #619CFF 4.797468 21.45472 18.91011 23.99934 1.1678896       FALSE     2</span></span>
<span><span class="co">#&gt; 423 #619CFF 4.835443 21.44280 18.95105 23.93455 1.1436274       FALSE     2</span></span>
<span><span class="co">#&gt; 424 #619CFF 4.873418 21.43088 18.98914 23.87261 1.1206707       FALSE     2</span></span>
<span><span class="co">#&gt; 425 #619CFF 4.911392 21.41895 19.02422 23.81369 1.0991012       FALSE     2</span></span>
<span><span class="co">#&gt; 426 #619CFF 4.949367 21.40703 19.05608 23.75797 1.0790020       FALSE     2</span></span>
<span><span class="co">#&gt; 427 #619CFF 4.987342 21.39510 19.08457 23.70564 1.0604569       FALSE     2</span></span>
<span><span class="co">#&gt; 428 #619CFF 5.025316 21.38318 19.10948 23.65688 1.0435486       FALSE     2</span></span>
<span><span class="co">#&gt; 429 #619CFF 5.063291 21.37126 19.13066 23.61185 1.0283579       FALSE     2</span></span>
<span><span class="co">#&gt; 430 #619CFF 5.101266 21.35933 19.14792 23.57074 1.0149619       FALSE     2</span></span>
<span><span class="co">#&gt; 431 #619CFF 5.139241 21.34741 19.16112 23.53370 1.0034326       FALSE     2</span></span>
<span><span class="co">#&gt; 432 #619CFF 5.177215 21.33548 19.17010 23.50086 0.9938348       FALSE     2</span></span>
<span><span class="co">#&gt; 433 #619CFF 5.215190 21.32356 19.17476 23.47236 0.9862250       FALSE     2</span></span>
<span><span class="co">#&gt; 434 #619CFF 5.253165 21.31163 19.17498 23.44829 0.9806494       FALSE     2</span></span>
<span><span class="co">#&gt; 435 #619CFF 5.291139 21.29971 19.17070 23.42872 0.9771429       FALSE     2</span></span>
<span><span class="co">#&gt; 436 #619CFF 5.329114 21.28779 19.16186 23.41371 0.9757277       FALSE     2</span></span>
<span><span class="co">#&gt; 437 #619CFF 5.367089 21.27586 19.14844 23.40328 0.9764131       FALSE     2</span></span>
<span><span class="co">#&gt; 438 #619CFF 5.405063 21.26394 19.13046 23.39742 0.9791944       FALSE     2</span></span>
<span><span class="co">#&gt; 439 #619CFF 5.443038 21.25201 19.10794 23.39608 0.9840541       FALSE     2</span></span>
<span><span class="co">#&gt; 440 #619CFF 5.481013 21.24009 19.08097 23.39921 0.9909615       FALSE     2</span></span>
<span><span class="co">#&gt; 441 #619CFF 5.518987 21.22817 19.04963 23.40671 0.9998741       FALSE     2</span></span>
<span><span class="co">#&gt; 442 #619CFF 5.556962 21.21624 19.01403 23.41845 1.0107390       FALSE     2</span></span>
<span><span class="co">#&gt; 443 #619CFF 5.594937 21.20432 18.97432 23.43432 1.0234939       FALSE     2</span></span>
<span><span class="co">#&gt; 444 #619CFF 5.632911 21.19239 18.93064 23.45415 1.0380692       FALSE     2</span></span>
<span><span class="co">#&gt; 445 #619CFF 5.670886 21.18047 18.88315 23.47779 1.0543895       FALSE     2</span></span>
<span><span class="co">#&gt; 446 #619CFF 5.708861 21.16855 18.83204 23.50505 1.0723749       FALSE     2</span></span>
<span><span class="co">#&gt; 447 #619CFF 5.746835 21.15662 18.77748 23.53576 1.0919433       FALSE     2</span></span>
<span><span class="co">#&gt; 448 #619CFF 5.784810 21.14470 18.71965 23.56974 1.1130112       FALSE     2</span></span>
<span><span class="co">#&gt; 449 #619CFF 5.822785 21.13277 18.65874 23.60681 1.1354951       FALSE     2</span></span>
<span><span class="co">#&gt; 450 #619CFF 5.860759 21.12085 18.59492 23.64677 1.1593126       FALSE     2</span></span>
<span><span class="co">#&gt; 451 #619CFF 5.898734 21.10893 18.52838 23.68948 1.1843833       FALSE     2</span></span>
<span><span class="co">#&gt; 452 #619CFF 5.936709 21.09700 18.45927 23.73474 1.2106292       FALSE     2</span></span>
<span><span class="co">#&gt; 453 #619CFF 5.974684 21.08508 18.38776 23.78240 1.2379758       FALSE     2</span></span>
<span><span class="co">#&gt; 454 #619CFF 6.012658 21.07315 18.31401 23.83230 1.2663516       FALSE     2</span></span>
<span><span class="co">#&gt; 455 #619CFF 6.050633 21.06123 18.23817 23.88429 1.2956891       FALSE     2</span></span>
<span><span class="co">#&gt; 456 #619CFF 6.088608 21.04931 18.16036 23.93825 1.3259244       FALSE     2</span></span>
<span><span class="co">#&gt; 457 #619CFF 6.126582 21.03738 18.08074 23.99402 1.3569975       FALSE     2</span></span>
<span><span class="co">#&gt; 458 #619CFF 6.164557 21.02546 17.99941 24.05151 1.3888521       FALSE     2</span></span>
<span><span class="co">#&gt; 459 #619CFF 6.202532 21.01353 17.91649 24.11058 1.4214358       FALSE     2</span></span>
<span><span class="co">#&gt; 460 #619CFF 6.240506 21.00161 17.83209 24.17113 1.4546996       FALSE     2</span></span>
<span><span class="co">#&gt; 461 #619CFF 6.278481 20.98969 17.74631 24.23306 1.4885977       FALSE     2</span></span>
<span><span class="co">#&gt; 462 #619CFF 6.316456 20.97776 17.65924 24.29628 1.5230880       FALSE     2</span></span>
<span><span class="co">#&gt; 463 #619CFF 6.354430 20.96584 17.57096 24.36071 1.5581311       FALSE     2</span></span>
<span><span class="co">#&gt; 464 #619CFF 6.392405 20.95391 17.48156 24.42627 1.5936904       FALSE     2</span></span>
<span><span class="co">#&gt; 465 #619CFF 6.430380 20.94199 17.39111 24.49287 1.6297323       FALSE     2</span></span>
<span><span class="co">#&gt; 466 #619CFF 6.468354 20.93006 17.29967 24.56046 1.6662254       FALSE     2</span></span>
<span><span class="co">#&gt; 467 #619CFF 6.506329 20.91814 17.20732 24.62897 1.7031407       FALSE     2</span></span>
<span><span class="co">#&gt; 468 #619CFF 6.544304 20.90622 17.11410 24.69833 1.7404513       FALSE     2</span></span>
<span><span class="co">#&gt; 469 #619CFF 6.582278 20.89429 17.02007 24.76851 1.7781323       FALSE     2</span></span>
<span><span class="co">#&gt; 470 #619CFF 6.620253 20.88237 16.92529 24.83944 1.8161608       FALSE     2</span></span>
<span><span class="co">#&gt; 471 #619CFF 6.658228 20.87044 16.82980 24.91109 1.8545153       FALSE     2</span></span>
<span><span class="co">#&gt; 472 #619CFF 6.696203 20.85852 16.73364 24.98340 1.8931760       FALSE     2</span></span>
<span><span class="co">#&gt; 473 #619CFF 6.734177 20.84660 16.63686 25.05633 1.9321245       FALSE     2</span></span>
<span><span class="co">#&gt; 474 #619CFF 6.772152 20.83467 16.53948 25.12986 1.9713437       FALSE     2</span></span>
<span><span class="co">#&gt; 475 #619CFF 6.810127 20.82275 16.44155 25.20394 2.0108179       FALSE     2</span></span>
<span><span class="co">#&gt; 476 #619CFF 6.848101 20.81082 16.34310 25.27855 2.0505323       FALSE     2</span></span>
<span><span class="co">#&gt; 477 #619CFF 6.886076 20.79890 16.24415 25.35365 2.0904732       FALSE     2</span></span>
<span><span class="co">#&gt; 478 #619CFF 6.924051 20.78698 16.14474 25.42922 2.1306279       FALSE     2</span></span>
<span><span class="co">#&gt; 479 #619CFF 6.962025 20.77505 16.04488 25.50522 2.1709845       FALSE     2</span></span>
<span><span class="co">#&gt; 480 #619CFF 7.000000 20.76313 15.94461 25.58164 2.2115319       FALSE     2</span></span>
<span><span class="co">#&gt;     group   fill linewidth linetype weight alpha</span></span>
<span><span class="co">#&gt; 1       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 2       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 3       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 4       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 5       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 6       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 7       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 8       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 9       1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 10      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 11      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 12      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 13      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 14      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 15      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 16      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 17      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 18      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 19      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 20      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 21      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 22      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 23      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 24      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 25      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 26      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 27      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 28      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 29      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 30      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 31      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 32      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 33      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 34      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 35      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 36      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 37      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 38      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 39      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 40      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 41      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 42      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 43      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 44      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 45      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 46      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 47      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 48      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 49      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 50      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 51      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 52      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 53      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 54      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 55      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 56      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 57      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 58      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 59      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 60      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 61      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 62      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 63      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 64      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 65      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 66      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 67      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 68      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 69      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 70      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 71      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 72      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 73      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 74      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 75      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 76      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 77      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 78      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 79      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 80      1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 81      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 82      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 83      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 84      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 85      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 86      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 87      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 88      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 89      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 90      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 91      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 92      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 93      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 94      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 95      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 96      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 97      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 98      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 99      2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 100     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 101     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 102     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 103     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 104     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 105     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 106     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 107     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 108     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 109     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 110     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 111     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 112     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 113     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 114     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 115     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 116     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 117     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 118     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 119     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 120     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 121     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 122     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 123     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 124     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 125     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 126     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 127     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 128     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 129     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 130     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 131     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 132     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 133     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 134     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 135     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 136     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 137     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 138     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 139     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 140     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 141     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 142     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 143     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 144     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 145     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 146     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 147     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 148     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 149     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 150     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 151     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 152     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 153     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 154     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 155     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 156     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 157     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 158     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 159     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 160     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 161     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 162     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 163     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 164     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 165     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 166     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 167     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 168     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 169     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 170     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 171     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 172     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 173     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 174     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 175     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 176     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 177     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 178     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 179     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 180     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 181     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 182     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 183     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 184     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 185     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 186     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 187     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 188     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 189     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 190     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 191     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 192     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 193     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 194     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 195     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 196     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 197     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 198     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 199     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 200     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 201     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 202     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 203     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 204     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 205     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 206     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 207     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 208     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 209     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 210     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 211     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 212     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 213     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 214     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 215     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 216     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 217     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 218     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 219     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 220     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 221     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 222     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 223     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 224     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 225     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 226     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 227     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 228     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 229     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 230     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 231     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 232     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 233     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 234     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 235     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 236     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 237     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 238     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 239     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 240     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 241     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 242     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 243     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 244     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 245     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 246     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 247     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 248     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 249     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 250     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 251     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 252     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 253     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 254     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 255     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 256     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 257     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 258     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 259     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 260     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 261     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 262     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 263     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 264     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 265     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 266     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 267     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 268     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 269     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 270     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 271     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 272     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 273     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 274     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 275     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 276     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 277     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 278     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 279     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 280     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 281     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 282     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 283     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 284     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 285     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 286     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 287     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 288     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 289     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 290     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 291     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 292     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 293     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 294     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 295     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 296     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 297     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 298     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 299     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 300     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 301     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 302     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 303     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 304     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 305     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 306     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 307     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 308     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 309     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 310     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 311     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 312     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 313     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 314     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 315     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 316     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 317     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 318     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 319     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 320     1 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 321     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 322     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 323     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 324     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 325     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 326     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 327     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 328     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 329     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 330     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 331     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 332     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 333     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 334     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 335     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 336     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 337     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 338     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 339     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 340     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 341     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 342     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 343     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 344     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 345     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 346     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 347     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 348     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 349     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 350     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 351     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 352     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 353     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 354     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 355     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 356     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 357     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 358     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 359     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 360     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 361     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 362     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 363     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 364     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 365     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 366     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 367     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 368     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 369     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 370     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 371     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 372     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 373     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 374     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 375     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 376     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 377     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 378     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 379     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 380     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 381     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 382     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 383     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 384     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 385     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 386     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 387     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 388     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 389     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 390     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 391     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 392     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 393     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 394     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 395     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 396     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 397     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 398     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 399     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 400     2 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 401     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 402     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 403     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 404     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 405     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 406     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 407     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 408     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 409     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 410     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 411     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 412     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 413     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 414     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 415     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 416     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 417     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 418     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 419     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 420     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 421     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 422     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 423     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 424     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 425     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 426     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 427     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 428     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 429     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 430     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 431     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 432     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 433     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 434     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 435     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 436     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 437     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 438     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 439     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 440     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 441     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 442     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 443     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 444     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 445     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 446     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 447     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 448     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 449     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 450     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 451     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 452     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 453     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 454     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 455     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 456     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 457     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 458     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 459     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 460     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 461     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 462     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 463     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 464     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 465     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 466     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 467     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 468     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 469     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 470     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 471     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 472     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 473     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 474     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 475     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 476     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 477     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 478     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 479     3 grey60         1        1      1   0.4</span></span>
<span><span class="co">#&gt; 480     3 grey60         1        1      1   0.4</span></span>
<span><span class="va">p_built</span> <span class="op">$</span><span class="va">layout</span></span>
<span><span class="co">#&gt; &lt;ggproto object: Class Layout, gg&gt;</span></span>
<span><span class="co">#&gt;     coord: &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;</span></span>
<span><span class="co">#&gt;         aspect: function</span></span>
<span><span class="co">#&gt;         backtransform_range: function</span></span>
<span><span class="co">#&gt;         clip: on</span></span>
<span><span class="co">#&gt;         default: TRUE</span></span>
<span><span class="co">#&gt;         distance: function</span></span>
<span><span class="co">#&gt;         expand: TRUE</span></span>
<span><span class="co">#&gt;         is_free: function</span></span>
<span><span class="co">#&gt;         is_linear: function</span></span>
<span><span class="co">#&gt;         labels: function</span></span>
<span><span class="co">#&gt;         limits: list</span></span>
<span><span class="co">#&gt;         modify_scales: function</span></span>
<span><span class="co">#&gt;         range: function</span></span>
<span><span class="co">#&gt;         render_axis_h: function</span></span>
<span><span class="co">#&gt;         render_axis_v: function</span></span>
<span><span class="co">#&gt;         render_bg: function</span></span>
<span><span class="co">#&gt;         render_fg: function</span></span>
<span><span class="co">#&gt;         setup_data: function</span></span>
<span><span class="co">#&gt;         setup_layout: function</span></span>
<span><span class="co">#&gt;         setup_panel_guides: function</span></span>
<span><span class="co">#&gt;         setup_panel_params: function</span></span>
<span><span class="co">#&gt;         setup_params: function</span></span>
<span><span class="co">#&gt;         train_panel_guides: function</span></span>
<span><span class="co">#&gt;         transform: function</span></span>
<span><span class="co">#&gt;         super:  &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;</span></span>
<span><span class="co">#&gt;     coord_params: list</span></span>
<span><span class="co">#&gt;     facet: &lt;ggproto object: Class FacetWrap, Facet, gg&gt;</span></span>
<span><span class="co">#&gt;         compute_layout: function</span></span>
<span><span class="co">#&gt;         draw_back: function</span></span>
<span><span class="co">#&gt;         draw_front: function</span></span>
<span><span class="co">#&gt;         draw_labels: function</span></span>
<span><span class="co">#&gt;         draw_panels: function</span></span>
<span><span class="co">#&gt;         finish_data: function</span></span>
<span><span class="co">#&gt;         init_scales: function</span></span>
<span><span class="co">#&gt;         map_data: function</span></span>
<span><span class="co">#&gt;         params: list</span></span>
<span><span class="co">#&gt;         setup_data: function</span></span>
<span><span class="co">#&gt;         setup_params: function</span></span>
<span><span class="co">#&gt;         shrink: TRUE</span></span>
<span><span class="co">#&gt;         train_scales: function</span></span>
<span><span class="co">#&gt;         vars: function</span></span>
<span><span class="co">#&gt;         super:  &lt;ggproto object: Class FacetWrap, Facet, gg&gt;</span></span>
<span><span class="co">#&gt;     facet_params: list</span></span>
<span><span class="co">#&gt;     finish_data: function</span></span>
<span><span class="co">#&gt;     get_scales: function</span></span>
<span><span class="co">#&gt;     layout: data.frame</span></span>
<span><span class="co">#&gt;     map_position: function</span></span>
<span><span class="co">#&gt;     panel_params: list</span></span>
<span><span class="co">#&gt;     panel_scales_x: list</span></span>
<span><span class="co">#&gt;     panel_scales_y: list</span></span>
<span><span class="co">#&gt;     render: function</span></span>
<span><span class="co">#&gt;     render_labels: function</span></span>
<span><span class="co">#&gt;     reset_scales: function</span></span>
<span><span class="co">#&gt;     resolve_label: function</span></span>
<span><span class="co">#&gt;     setup: function</span></span>
<span><span class="co">#&gt;     setup_panel_guides: function</span></span>
<span><span class="co">#&gt;     setup_panel_params: function</span></span>
<span><span class="co">#&gt;     train_position: function</span></span>
<span><span class="co">#&gt;     super:  &lt;ggproto object: Class Layout, gg&gt;</span></span>
<span><span class="va">p_built</span> <span class="op">$</span><span class="va">plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">p_gtable</span> <span class="op">&lt;-</span> <span class="fu">ggplot_gtable</span><span class="op">(</span><span class="va">p_built</span><span class="op">)</span></span>
<span><span class="va">p_gtable</span></span>
<span><span class="co">#&gt; TableGrob (17 x 17) "layout": 25 grobs</span></span>
<span><span class="co">#&gt;     z         cells             name</span></span>
<span><span class="co">#&gt; 1   0 ( 1-17, 1-17)       background</span></span>
<span><span class="co">#&gt; 2   1 (10-10, 7- 7)        panel-1-1</span></span>
<span><span class="co">#&gt; 3   1 (10-10,11-11)        panel-2-1</span></span>
<span><span class="co">#&gt; 4   3 ( 8- 8, 7- 7)       axis-t-1-1</span></span>
<span><span class="co">#&gt; 5   3 ( 8- 8,11-11)       axis-t-2-1</span></span>
<span><span class="co">#&gt; 6   3 (11-11, 7- 7)       axis-b-1-1</span></span>
<span><span class="co">#&gt; 7   3 (11-11,11-11)       axis-b-2-1</span></span>
<span><span class="co">#&gt; 8   3 (10-10,10-10)       axis-l-1-2</span></span>
<span><span class="co">#&gt; 9   3 (10-10, 6- 6)       axis-l-1-1</span></span>
<span><span class="co">#&gt; 10  3 (10-10,12-12)       axis-r-1-2</span></span>
<span><span class="co">#&gt; 11  3 (10-10, 8- 8)       axis-r-1-1</span></span>
<span><span class="co">#&gt; 12  2 ( 9- 9, 7- 7)      strip-t-1-1</span></span>
<span><span class="co">#&gt; 13  2 ( 9- 9,11-11)      strip-t-2-1</span></span>
<span><span class="co">#&gt; 14  4 ( 7- 7, 7-11)           xlab-t</span></span>
<span><span class="co">#&gt; 15  5 (12-12, 7-11)           xlab-b</span></span>
<span><span class="co">#&gt; 16  6 (10-10, 5- 5)           ylab-l</span></span>
<span><span class="co">#&gt; 17  7 (10-10,13-13)           ylab-r</span></span>
<span><span class="co">#&gt; 18  8 (10-10,15-15)  guide-box-right</span></span>
<span><span class="co">#&gt; 19  9 (10-10, 3- 3)   guide-box-left</span></span>
<span><span class="co">#&gt; 20 10 (14-14, 7-11) guide-box-bottom</span></span>
<span><span class="co">#&gt; 21 11 ( 5- 5, 7-11)    guide-box-top</span></span>
<span><span class="co">#&gt; 22 12 (10-10, 7-11) guide-box-inside</span></span>
<span><span class="co">#&gt; 23 13 ( 4- 4, 7-11)         subtitle</span></span>
<span><span class="co">#&gt; 24 14 ( 3- 3, 7-11)            title</span></span>
<span><span class="co">#&gt; 25 15 (15-15, 7-11)          caption</span></span>
<span><span class="co">#&gt;                                              grob</span></span>
<span><span class="co">#&gt; 1                rect[plot.background..rect.5057]</span></span>
<span><span class="co">#&gt; 2                       gTree[panel-1.gTree.4937]</span></span>
<span><span class="co">#&gt; 3                       gTree[panel-2.gTree.4952]</span></span>
<span><span class="co">#&gt; 4                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 5                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 6            absoluteGrob[GRID.absoluteGrob.4956]</span></span>
<span><span class="co">#&gt; 7            absoluteGrob[GRID.absoluteGrob.4956]</span></span>
<span><span class="co">#&gt; 8                                  zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 9            absoluteGrob[GRID.absoluteGrob.4964]</span></span>
<span><span class="co">#&gt; 10                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 11                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 12                                  gtable[strip]</span></span>
<span><span class="co">#&gt; 13                                  gtable[strip]</span></span>
<span><span class="co">#&gt; 14                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 15 titleGrob[axis.title.x.bottom..titleGrob.5019]</span></span>
<span><span class="co">#&gt; 16   titleGrob[axis.title.y.left..titleGrob.5022]</span></span>
<span><span class="co">#&gt; 17                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 18                              gtable[guide-box]</span></span>
<span><span class="co">#&gt; 19                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 20                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 21                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 22                                 zeroGrob[NULL]</span></span>
<span><span class="co">#&gt; 23         zeroGrob[plot.subtitle..zeroGrob.5054]</span></span>
<span><span class="co">#&gt; 24          titleGrob[plot.title..titleGrob.5053]</span></span>
<span><span class="co">#&gt; 25          zeroGrob[plot.caption..zeroGrob.5055]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html">grid.draw</a></span><span class="op">(</span><span class="va">p_gtable</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="ggplot2_graphics_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="ggproto对象" class="level2" data-number="5.12"><h2 data-number="5.12" class="anchored" data-anchor-id="ggproto对象">
<span class="header-section-number">5.12</span> <strong>ggproto对象</strong>
</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NewObject</span> <span class="op">&lt;-</span> <span class="fu">ggproto</span><span class="op">(</span></span>
<span>  `_class` <span class="op">=</span> <span class="cn">NULL</span>,     <span class="co"># 类</span></span>
<span>  `_inherits` <span class="op">=</span> <span class="cn">NULL</span>   <span class="co"># 继承</span></span>
<span><span class="op">)</span></span>
<span><span class="va">NewObject</span> </span>
<span><span class="co">#&gt; &lt;ggproto object: Class gg&gt;</span></span>
<span><span class="co">#&gt;     _inherits: NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>创建新类，子类继承</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./base_graphics.html" class="pagination-link" aria-label="base graphics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">base graphics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ggplot2_extensions.html" class="pagination-link" aria-label="ggplot2 extensions">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ggplot2 extensions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb125" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># ggplot2 Graphics {#sec-ggplot2}</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">ggplot2：用于数据分析的优雅图形</span><span class="co">](https://ggplot2-book.org/mastery)</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>gg 为 grammar of graphics 的缩写。</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## `ggplot(data =  ,mapping = aes(x,y,…))`</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="fu">### data</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>数据应使用数据框格式，例如ggplot2包自动的数据集mpg，其中发动机排量 <span class="in">`displ`</span>，油耗 <span class="in">`cty`</span>，发动机驱动方式 <span class="in">`drv`</span>，</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg,<span class="at">package =</span> <span class="st">"ggplot2"</span>)</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg)</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="fu">### aesthetics mapping</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="in">`mapping=aes(x,y,z,..,color,fill,shape,linetype,alpha,size,group,linewidth)`</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> </span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(class)  <span class="co"># 7种汽车类型</span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span><span class="co">#颜色 名义型变量</span></span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="st">"."</span>) <span class="co">#像素点</span></span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">shape =</span> class)) <span class="sc">+</span> <span class="co">#形状最多可以映射6个</span></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">size =</span> class)) <span class="sc">+</span><span class="co">#大小 有序型变量</span></span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">alpha =</span> class)) <span class="sc">+</span><span class="co">#透明度 有序型变量</span></span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="co">#更改外观</span></span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">linetype =</span> drv)) <span class="sc">+</span> <span class="co">#线条类型</span></span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">linewidth =</span> drv)) <span class="sc">+</span> <span class="co">#线条粗细</span></span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## geometry</span></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Graphical primitives:</span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_blank()`</span>: display nothing. Most useful for adjusting axes limits using data.</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_point()`</span>: points.</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_path()`</span>: paths.</span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-56"><a href="#cb125-56" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_ribbon()`</span>: ribbons, a path with vertical thickness.</span>
<span id="cb125-57"><a href="#cb125-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-58"><a href="#cb125-58" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_segment()`</span>: a line segment, specified by start and end position.</span>
<span id="cb125-59"><a href="#cb125-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-60"><a href="#cb125-60" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_rect()`</span>: rectangles.</span>
<span id="cb125-61"><a href="#cb125-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-62"><a href="#cb125-62" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_polygon()`</span>: filled polygons.</span>
<span id="cb125-63"><a href="#cb125-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-64"><a href="#cb125-64" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_text()`</span>: text.</span>
<span id="cb125-65"><a href="#cb125-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-66"><a href="#cb125-66" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb125-67"><a href="#cb125-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-68"><a href="#cb125-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>One variable:</span>
<span id="cb125-69"><a href="#cb125-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-70"><a href="#cb125-70" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Discrete:</span>
<span id="cb125-71"><a href="#cb125-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-72"><a href="#cb125-72" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_bar()`</span>: display distribution of discrete variable.</span>
<span id="cb125-73"><a href="#cb125-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-74"><a href="#cb125-74" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Continuous:</span>
<span id="cb125-75"><a href="#cb125-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-76"><a href="#cb125-76" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_histogram()`</span>: bin and count continuous variable, display with bars.</span>
<span id="cb125-77"><a href="#cb125-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-78"><a href="#cb125-78" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_density()`</span>: smoothed density estimate.</span>
<span id="cb125-79"><a href="#cb125-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-80"><a href="#cb125-80" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_dotplot()`</span>: stack individual points into a dot plot.</span>
<span id="cb125-81"><a href="#cb125-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-82"><a href="#cb125-82" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_freqpoly()`</span>: bin and count continuous variable, display with lines.</span>
<span id="cb125-83"><a href="#cb125-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-84"><a href="#cb125-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Two variables:</span>
<span id="cb125-85"><a href="#cb125-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-86"><a href="#cb125-86" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Both continuous:</span>
<span id="cb125-87"><a href="#cb125-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-88"><a href="#cb125-88" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_point()`</span>: scatterplot.</span>
<span id="cb125-89"><a href="#cb125-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-90"><a href="#cb125-90" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_quantile()`</span>: smoothed quantile regression.</span>
<span id="cb125-91"><a href="#cb125-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-92"><a href="#cb125-92" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_rug()`</span>: marginal rug plots.</span>
<span id="cb125-93"><a href="#cb125-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-94"><a href="#cb125-94" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_smooth()`</span>: smoothed line of best fit.</span>
<span id="cb125-95"><a href="#cb125-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-96"><a href="#cb125-96" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_text()`</span>: text labels.</span>
<span id="cb125-97"><a href="#cb125-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-98"><a href="#cb125-98" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Show distribution:</span>
<span id="cb125-99"><a href="#cb125-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-100"><a href="#cb125-100" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_bin2d()`</span>: bin into rectangles and count.</span>
<span id="cb125-101"><a href="#cb125-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-102"><a href="#cb125-102" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_density2d()`</span>: smoothed 2d density estimate.</span>
<span id="cb125-103"><a href="#cb125-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-104"><a href="#cb125-104" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_hex()`</span>: bin into hexagons and count.</span>
<span id="cb125-105"><a href="#cb125-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-106"><a href="#cb125-106" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>At least one discrete:</span>
<span id="cb125-107"><a href="#cb125-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-108"><a href="#cb125-108" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_count()`</span>: count number of point at distinct locations</span>
<span id="cb125-109"><a href="#cb125-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-110"><a href="#cb125-110" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_jitter()`</span>: randomly jitter overlapping points.</span>
<span id="cb125-111"><a href="#cb125-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-112"><a href="#cb125-112" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>One continuous, one discrete:</span>
<span id="cb125-113"><a href="#cb125-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-114"><a href="#cb125-114" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_bar(stat = "identity")`</span>: a bar chart of precomputed summaries.</span>
<span id="cb125-115"><a href="#cb125-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-116"><a href="#cb125-116" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_boxplot()`</span>: boxplots.</span>
<span id="cb125-117"><a href="#cb125-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-118"><a href="#cb125-118" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_violin()`</span>: show density of values in each group.</span>
<span id="cb125-119"><a href="#cb125-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-120"><a href="#cb125-120" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>One time, one continuous:</span>
<span id="cb125-121"><a href="#cb125-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-122"><a href="#cb125-122" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_area()`</span>: area plot.</span>
<span id="cb125-123"><a href="#cb125-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-124"><a href="#cb125-124" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_line()`</span>: line plot.</span>
<span id="cb125-125"><a href="#cb125-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-126"><a href="#cb125-126" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_step()`</span>: step plot.</span>
<span id="cb125-127"><a href="#cb125-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-128"><a href="#cb125-128" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Display uncertainty:</span>
<span id="cb125-129"><a href="#cb125-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-130"><a href="#cb125-130" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_crossbar()`</span>: vertical bar with center.</span>
<span id="cb125-131"><a href="#cb125-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-132"><a href="#cb125-132" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_errorbar()`</span>: error bars.</span>
<span id="cb125-133"><a href="#cb125-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-134"><a href="#cb125-134" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_linerange()`</span>: vertical line.</span>
<span id="cb125-135"><a href="#cb125-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-136"><a href="#cb125-136" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_pointrange()`</span>: vertical line with center.</span>
<span id="cb125-137"><a href="#cb125-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-138"><a href="#cb125-138" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Spatial:</span>
<span id="cb125-139"><a href="#cb125-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-140"><a href="#cb125-140" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`geom_map()`</span>: fast version of for map data.<span class="in">`geom_polygon()`</span></span>
<span id="cb125-141"><a href="#cb125-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-142"><a href="#cb125-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Three variables:</span>
<span id="cb125-143"><a href="#cb125-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-144"><a href="#cb125-144" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_contour()`</span>: contours.</span>
<span id="cb125-145"><a href="#cb125-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-146"><a href="#cb125-146" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_tile()`</span>: tile the plane with rectangles.</span>
<span id="cb125-147"><a href="#cb125-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-148"><a href="#cb125-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`geom_raster()`</span>: fast version of for equal sized tiles.<span class="in">`geom_tile()`</span></span>
<span id="cb125-149"><a href="#cb125-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-152"><a href="#cb125-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-153"><a href="#cb125-153" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-154"><a href="#cb125-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>), </span>
<span id="cb125-155"><a href="#cb125-155" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>), </span>
<span id="cb125-156"><a href="#cb125-156" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>)</span>
<span id="cb125-157"><a href="#cb125-157" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-158"><a href="#cb125-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-159"><a href="#cb125-159" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> label)) <span class="sc">+</span> </span>
<span id="cb125-160"><a href="#cb125-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="co"># Hide axis label</span></span>
<span id="cb125-161"><a href="#cb125-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="co"># Shrink plot title</span></span>
<span id="cb125-162"><a href="#cb125-162" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"point"</span>)<span class="sc">|</span></span>
<span id="cb125-163"><a href="#cb125-163" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"text"</span>)<span class="sc">+</span></span>
<span id="cb125-164"><a href="#cb125-164" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"bar"</span>)<span class="sc">|</span></span>
<span id="cb125-165"><a href="#cb125-165" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"raster"</span>)</span>
<span id="cb125-166"><a href="#cb125-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-167"><a href="#cb125-167" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"line"</span>)<span class="sc">|</span></span>
<span id="cb125-168"><a href="#cb125-168" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_area</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"area"</span>)<span class="sc">+</span></span>
<span id="cb125-169"><a href="#cb125-169" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_path</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"path"</span>)<span class="sc">|</span></span>
<span id="cb125-170"><a href="#cb125-170" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_polygon</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"polygon"</span>)</span>
<span id="cb125-171"><a href="#cb125-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-172"><a href="#cb125-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-173"><a href="#cb125-173" aria-hidden="true" tabindex="-1"></a><span class="fu">### X=连续型变量</span></span>
<span id="cb125-174"><a href="#cb125-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-177"><a href="#cb125-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-178"><a href="#cb125-178" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ))</span>
<span id="cb125-179"><a href="#cb125-179" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb125-180"><a href="#cb125-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-181"><a href="#cb125-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-182"><a href="#cb125-182" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_point</span></span>
<span id="cb125-183"><a href="#cb125-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-186"><a href="#cb125-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-187"><a href="#cb125-187" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb125-188"><a href="#cb125-188" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb125-189"><a href="#cb125-189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb125-190"><a href="#cb125-190" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> <span class="st">"y~x"</span>,</span>
<span id="cb125-191"><a href="#cb125-191" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span>T)</span>
<span id="cb125-192"><a href="#cb125-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-193"><a href="#cb125-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-196"><a href="#cb125-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-197"><a href="#cb125-197" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ,hwy)) <span class="sc">+</span></span>
<span id="cb125-198"><a href="#cb125-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">|</span></span>
<span id="cb125-199"><a href="#cb125-199" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-200"><a href="#cb125-200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ,hwy)) <span class="sc">+</span></span>
<span id="cb125-201"><a href="#cb125-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> displ<span class="sc">/</span><span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb125-202"><a href="#cb125-202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_size_area</span>(<span class="at">name=</span><span class="st">"displ/10"</span>)</span>
<span id="cb125-203"><a href="#cb125-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-204"><a href="#cb125-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-205"><a href="#cb125-205" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_line</span></span>
<span id="cb125-206"><a href="#cb125-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-209"><a href="#cb125-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-210"><a href="#cb125-210" aria-hidden="true" tabindex="-1"></a>economics <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb125-211"><a href="#cb125-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-212"><a href="#cb125-212" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(economics,<span class="fu">aes</span>(date,pop))<span class="sc">+</span></span>
<span id="cb125-213"><a href="#cb125-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb125-214"><a href="#cb125-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>()</span>
<span id="cb125-215"><a href="#cb125-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-216"><a href="#cb125-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-217"><a href="#cb125-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-218"><a href="#cb125-218" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_smooth geom_ribbon</span></span>
<span id="cb125-219"><a href="#cb125-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-222"><a href="#cb125-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-223"><a href="#cb125-223" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb125-224"><a href="#cb125-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb125-225"><a href="#cb125-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-226"><a href="#cb125-226" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,<span class="at">span =</span> <span class="fl">0.2</span>) <span class="co"># loess 平滑局部回归   small n</span></span>
<span id="cb125-227"><a href="#cb125-227" aria-hidden="true" tabindex="-1"></a>                                   <span class="co">#span 0非常摆动，1不那么摆动</span></span>
<span id="cb125-228"><a href="#cb125-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-229"><a href="#cb125-229" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="dv">1</span>)  <span class="co">#不很摆动</span></span>
<span id="cb125-230"><a href="#cb125-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-231"><a href="#cb125-231" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb125-232"><a href="#cb125-232" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"rlm"</span>)   <span class="co"># robust linear model  稳健线性模型</span></span>
<span id="cb125-233"><a href="#cb125-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-234"><a href="#cb125-234" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb125-235"><a href="#cb125-235" aria-hidden="true" tabindex="-1"></a>q<span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x)) <span class="co">#gam 广义相加模型   n&gt;1000</span></span>
<span id="cb125-236"><a href="#cb125-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-237"><a href="#cb125-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-238"><a href="#cb125-238" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_histogram</span></span>
<span id="cb125-239"><a href="#cb125-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-242"><a href="#cb125-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-243"><a href="#cb125-243" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg)</span>
<span id="cb125-244"><a href="#cb125-244" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span><span class="fu">after_stat</span>(density)),</span>
<span id="cb125-245"><a href="#cb125-245" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stat =</span> <span class="st">"bin"</span>,<span class="at">position =</span> <span class="st">"stack"</span>,</span>
<span id="cb125-246"><a href="#cb125-246" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="fl">0.5</span></span>
<span id="cb125-247"><a href="#cb125-247" aria-hidden="true" tabindex="-1"></a>                   ) <span class="sc">+</span></span>
<span id="cb125-248"><a href="#cb125-248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb125-249"><a href="#cb125-249" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span><span class="fu">after_stat</span>(density)),</span>
<span id="cb125-250"><a href="#cb125-250" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"red"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb125-251"><a href="#cb125-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-252"><a href="#cb125-252" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">2.5</span>)</span>
<span id="cb125-253"><a href="#cb125-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-254"><a href="#cb125-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-255"><a href="#cb125-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-256"><a href="#cb125-256" aria-hidden="true" tabindex="-1"></a>加权</span>
<span id="cb125-257"><a href="#cb125-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-260"><a href="#cb125-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-261"><a href="#cb125-261" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span></span>
<span id="cb125-262"><a href="#cb125-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">|</span></span>
<span id="cb125-263"><a href="#cb125-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-264"><a href="#cb125-264" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span></span>
<span id="cb125-265"><a href="#cb125-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">weight =</span> displ), <span class="at">binwidth =</span> <span class="dv">1</span>) </span>
<span id="cb125-266"><a href="#cb125-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-267"><a href="#cb125-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-268"><a href="#cb125-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_freqpoly</span></span>
<span id="cb125-269"><a href="#cb125-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-272"><a href="#cb125-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-273"><a href="#cb125-273" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> </span>
<span id="cb125-274"><a href="#cb125-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="fl">2.5</span>)</span>
<span id="cb125-275"><a href="#cb125-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-276"><a href="#cb125-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-277"><a href="#cb125-277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_density</span></span>
<span id="cb125-278"><a href="#cb125-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-281"><a href="#cb125-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-282"><a href="#cb125-282" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(displ,<span class="at">fill=</span>drv),</span>
<span id="cb125-283"><a href="#cb125-283" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stat =</span> <span class="st">"density"</span>,<span class="at">position =</span> <span class="st">"identity"</span>,</span>
<span id="cb125-284"><a href="#cb125-284" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.3</span></span>
<span id="cb125-285"><a href="#cb125-285" aria-hidden="true" tabindex="-1"></a>                 )<span class="sc">+</span></span>
<span id="cb125-286"><a href="#cb125-286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)<span class="sc">+</span></span>
<span id="cb125-287"><a href="#cb125-287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">"图例名"</span>)<span class="sc">+</span> <span class="co"># 与映射aes()有关</span></span>
<span id="cb125-288"><a href="#cb125-288" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb125-289"><a href="#cb125-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-290"><a href="#cb125-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-291"><a href="#cb125-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-292"><a href="#cb125-292" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_rug</span></span>
<span id="cb125-293"><a href="#cb125-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-294"><a href="#cb125-294" aria-hidden="true" tabindex="-1"></a>y→<span class="in">`sides="r","l"`</span></span>
<span id="cb125-295"><a href="#cb125-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-296"><a href="#cb125-296" aria-hidden="true" tabindex="-1"></a>x→<span class="in">`sides="b","t"`</span></span>
<span id="cb125-297"><a href="#cb125-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-300"><a href="#cb125-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-301"><a href="#cb125-301" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb125-302"><a href="#cb125-302" aria-hidden="true" tabindex="-1"></a>           <span class="at">sides =</span> <span class="st">"br"</span>,<span class="at">color=</span><span class="st">"brown"</span>)</span>
<span id="cb125-303"><a href="#cb125-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-304"><a href="#cb125-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-305"><a href="#cb125-305" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_jitter</span></span>
<span id="cb125-306"><a href="#cb125-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-309"><a href="#cb125-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-310"><a href="#cb125-310" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>displ,<span class="at">y=</span>hwy),</span>
<span id="cb125-311"><a href="#cb125-311" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"jitter"</span>)</span>
<span id="cb125-312"><a href="#cb125-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-313"><a href="#cb125-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-314"><a href="#cb125-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### X=离散型变量</span></span>
<span id="cb125-315"><a href="#cb125-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-316"><a href="#cb125-316" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_bar</span></span>
<span id="cb125-317"><a href="#cb125-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-320"><a href="#cb125-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-321"><a href="#cb125-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb125-322"><a href="#cb125-322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(cyl),<span class="at">fill=</span>drv),</span>
<span id="cb125-323"><a href="#cb125-323" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">"count"</span>,<span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb125-324"><a href="#cb125-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-325"><a href="#cb125-325" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg) <span class="sc">+</span> </span>
<span id="cb125-326"><a href="#cb125-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(cyl),<span class="at">y=</span>hwy,<span class="at">fill=</span>drv),</span>
<span id="cb125-327"><a href="#cb125-327" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb125-328"><a href="#cb125-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-329"><a href="#cb125-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-330"><a href="#cb125-330" aria-hidden="true" tabindex="-1"></a>有序条形图</span>
<span id="cb125-331"><a href="#cb125-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-334"><a href="#cb125-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-335"><a href="#cb125-335" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_infreq</span>(class))) <span class="sc">+</span>  <span class="co">#降序条形图</span></span>
<span id="cb125-336"><a href="#cb125-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb125-337"><a href="#cb125-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-338"><a href="#cb125-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-339"><a href="#cb125-339" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_errorbar errorbarh</span></span>
<span id="cb125-340"><a href="#cb125-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-341"><a href="#cb125-341" aria-hidden="true" tabindex="-1"></a>geom_linerange geom_crossbar geom_pointrange</span>
<span id="cb125-342"><a href="#cb125-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-345"><a href="#cb125-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-346"><a href="#cb125-346" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">11</span>, <span class="dv">16</span>)</span>
<span id="cb125-347"><a href="#cb125-347" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> y, <span class="at">se =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>))</span>
<span id="cb125-348"><a href="#cb125-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-349"><a href="#cb125-349" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">ymin =</span> y <span class="sc">-</span> se, <span class="at">ymax =</span> y <span class="sc">+</span> se))</span>
<span id="cb125-350"><a href="#cb125-350" aria-hidden="true" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">geom_errorbar</span>()<span class="sc">|</span></span>
<span id="cb125-351"><a href="#cb125-351" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_linerange</span>()<span class="sc">|</span></span>
<span id="cb125-352"><a href="#cb125-352" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_ribbon</span>())<span class="sc">/</span></span>
<span id="cb125-353"><a href="#cb125-353" aria-hidden="true" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">geom_crossbar</span>()<span class="sc">|</span></span>
<span id="cb125-354"><a href="#cb125-354" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_pointrange</span>()<span class="sc">|</span></span>
<span id="cb125-355"><a href="#cb125-355" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">"identity"</span>))</span>
<span id="cb125-356"><a href="#cb125-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-357"><a href="#cb125-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-360"><a href="#cb125-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-361"><a href="#cb125-361" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"data/g.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb125-362"><a href="#cb125-362" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb125-363"><a href="#cb125-363" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean=</span><span class="fu">mean</span>(liverweight),</span>
<span id="cb125-364"><a href="#cb125-364" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd=</span><span class="fu">sd</span>(liverweight),</span>
<span id="cb125-365"><a href="#cb125-365" aria-hidden="true" tabindex="-1"></a>        <span class="at">.by=</span>treatment</span>
<span id="cb125-366"><a href="#cb125-366" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb125-367"><a href="#cb125-367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(treatment,mean,<span class="at">fill=</span>treatment))<span class="sc">+</span></span>
<span id="cb125-368"><a href="#cb125-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb125-369"><a href="#cb125-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean<span class="sc">-</span>sd,<span class="at">ymax=</span>mean<span class="sc">+</span>sd),<span class="at">width=</span>.<span class="dv">2</span>)</span>
<span id="cb125-370"><a href="#cb125-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-371"><a href="#cb125-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-372"><a href="#cb125-372" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_dotplot</span></span>
<span id="cb125-373"><a href="#cb125-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-376"><a href="#cb125-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-377"><a href="#cb125-377" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_dotplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),</span>
<span id="cb125-378"><a href="#cb125-378" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">"identity"</span>,</span>
<span id="cb125-379"><a href="#cb125-379" aria-hidden="true" tabindex="-1"></a>                 <span class="at">stackdir =</span> <span class="st">"center"</span>,<span class="at">binaxis =</span> <span class="st">'y'</span>,<span class="co"># stacking along y axis</span></span>
<span id="cb125-380"><a href="#cb125-380" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"red"</span>,<span class="at">binwidth =</span> <span class="fl">0.7</span>)</span>
<span id="cb125-381"><a href="#cb125-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-382"><a href="#cb125-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-383"><a href="#cb125-383" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_boxplot</span></span>
<span id="cb125-384"><a href="#cb125-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-387"><a href="#cb125-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-388"><a href="#cb125-388" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),</span>
<span id="cb125-389"><a href="#cb125-389" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">"boxplot"</span>,<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb125-390"><a href="#cb125-390" aria-hidden="true" tabindex="-1"></a>             <span class="at">notch=</span><span class="cn">TRUE</span>, <span class="at">varwidth=</span><span class="cn">TRUE</span>,</span>
<span id="cb125-391"><a href="#cb125-391" aria-hidden="true" tabindex="-1"></a>             <span class="at">width=</span><span class="fl">0.1</span>,<span class="at">fill=</span><span class="st">"green"</span></span>
<span id="cb125-392"><a href="#cb125-392" aria-hidden="true" tabindex="-1"></a>            )<span class="sc">+</span></span>
<span id="cb125-393"><a href="#cb125-393" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),<span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb125-394"><a href="#cb125-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-395"><a href="#cb125-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-396"><a href="#cb125-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-397"><a href="#cb125-397" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_violin</span></span>
<span id="cb125-398"><a href="#cb125-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-401"><a href="#cb125-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-402"><a href="#cb125-402" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>drv,<span class="at">y=</span>hwy),</span>
<span id="cb125-403"><a href="#cb125-403" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">"ydensity"</span>,<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb125-404"><a href="#cb125-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-405"><a href="#cb125-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-406"><a href="#cb125-406" aria-hidden="true" tabindex="-1"></a><span class="fu">#### geom_tile</span></span>
<span id="cb125-407"><a href="#cb125-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-410"><a href="#cb125-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-411"><a href="#cb125-411" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置随机数种子以确保结果的可重复性  </span></span>
<span id="cb125-412"><a href="#cb125-412" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)  </span>
<span id="cb125-413"><a href="#cb125-413" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-414"><a href="#cb125-414" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成随机数据集  </span></span>
<span id="cb125-415"><a href="#cb125-415" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(  </span>
<span id="cb125-416"><a href="#cb125-416" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2000</span><span class="sc">:</span><span class="dv">2024</span>,  </span>
<span id="cb125-417"><a href="#cb125-417" aria-hidden="true" tabindex="-1"></a>  <span class="at">lung =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-418"><a href="#cb125-418" aria-hidden="true" tabindex="-1"></a>  <span class="at">liver =</span> <span class="fu">runif</span>(<span class="dv">25</span>), </span>
<span id="cb125-419"><a href="#cb125-419" aria-hidden="true" tabindex="-1"></a>  <span class="at">bone =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-420"><a href="#cb125-420" aria-hidden="true" tabindex="-1"></a>  <span class="at">luk =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-421"><a href="#cb125-421" aria-hidden="true" tabindex="-1"></a>  <span class="at">eso =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-422"><a href="#cb125-422" aria-hidden="true" tabindex="-1"></a>  <span class="at">gas =</span> <span class="fu">runif</span>(<span class="dv">25</span>),   </span>
<span id="cb125-423"><a href="#cb125-423" aria-hidden="true" tabindex="-1"></a>  <span class="at">eye =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-424"><a href="#cb125-424" aria-hidden="true" tabindex="-1"></a>  <span class="at">brain =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-425"><a href="#cb125-425" aria-hidden="true" tabindex="-1"></a>  <span class="at">pan =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-426"><a href="#cb125-426" aria-hidden="true" tabindex="-1"></a>  <span class="at">kidney =</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-427"><a href="#cb125-427" aria-hidden="true" tabindex="-1"></a>  <span class="at">breast=</span> <span class="fu">runif</span>(<span class="dv">25</span>),  </span>
<span id="cb125-428"><a href="#cb125-428" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb125-429"><a href="#cb125-429" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_to =</span> <span class="st">"cancer"</span>,</span>
<span id="cb125-430"><a href="#cb125-430" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_to =</span> <span class="st">"morbidity"</span>)</span>
<span id="cb125-431"><a href="#cb125-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-432"><a href="#cb125-432" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata, <span class="fu">aes</span>(year, cancer)) <span class="sc">+</span>  </span>
<span id="cb125-433"><a href="#cb125-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span>morbidity)) <span class="sc">+</span>  </span>
<span id="cb125-434"><a href="#cb125-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>)</span>
<span id="cb125-435"><a href="#cb125-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-436"><a href="#cb125-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-437"><a href="#cb125-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-438"><a href="#cb125-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### 统计变换 statistical transformations</span></span>
<span id="cb125-439"><a href="#cb125-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-440"><a href="#cb125-440" aria-hidden="true" tabindex="-1"></a>stat_bin()：geom_bar()，geom_freqpoly()，geom_histogram()</span>
<span id="cb125-441"><a href="#cb125-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-442"><a href="#cb125-442" aria-hidden="true" tabindex="-1"></a>stat_bin2d()：geom_bin2d()</span>
<span id="cb125-443"><a href="#cb125-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-444"><a href="#cb125-444" aria-hidden="true" tabindex="-1"></a>stat_bindot()：geom_dotplot()</span>
<span id="cb125-445"><a href="#cb125-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-446"><a href="#cb125-446" aria-hidden="true" tabindex="-1"></a>stat_binhex()：geom_hex()</span>
<span id="cb125-447"><a href="#cb125-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-448"><a href="#cb125-448" aria-hidden="true" tabindex="-1"></a>stat_boxplot()：geom_boxplot()</span>
<span id="cb125-449"><a href="#cb125-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-450"><a href="#cb125-450" aria-hidden="true" tabindex="-1"></a>stat_contour()：geom_contour()</span>
<span id="cb125-451"><a href="#cb125-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-452"><a href="#cb125-452" aria-hidden="true" tabindex="-1"></a>stat_quantile()：geom_quantile()</span>
<span id="cb125-453"><a href="#cb125-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-454"><a href="#cb125-454" aria-hidden="true" tabindex="-1"></a>stat_smooth()：geom_smooth()</span>
<span id="cb125-455"><a href="#cb125-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-456"><a href="#cb125-456" aria-hidden="true" tabindex="-1"></a>stat_sum()：geom_count()</span>
<span id="cb125-457"><a href="#cb125-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-458"><a href="#cb125-458" aria-hidden="true" tabindex="-1"></a>stat_ecdf()：计算经验累积分布图。</span>
<span id="cb125-459"><a href="#cb125-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-460"><a href="#cb125-460" aria-hidden="true" tabindex="-1"></a>stat_function()：根据 x 值的函数计算 y 值。</span>
<span id="cb125-461"><a href="#cb125-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-462"><a href="#cb125-462" aria-hidden="true" tabindex="-1"></a>stat_summary()：将 Y 值汇总到不同的 X 值。</span>
<span id="cb125-463"><a href="#cb125-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-464"><a href="#cb125-464" aria-hidden="true" tabindex="-1"></a>stat_summary2d() ：汇总分箱值。</span>
<span id="cb125-465"><a href="#cb125-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-466"><a href="#cb125-466" aria-hidden="true" tabindex="-1"></a>stat_summary_hex()</span>
<span id="cb125-467"><a href="#cb125-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-468"><a href="#cb125-468" aria-hidden="true" tabindex="-1"></a>stat_qq()：对分位数-分位数图执行计算。</span>
<span id="cb125-469"><a href="#cb125-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-470"><a href="#cb125-470" aria-hidden="true" tabindex="-1"></a>stat_spoke()：将角度和半径转换为位置。</span>
<span id="cb125-471"><a href="#cb125-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-472"><a href="#cb125-472" aria-hidden="true" tabindex="-1"></a>stat_unique()：删除重复的行。</span>
<span id="cb125-473"><a href="#cb125-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-476"><a href="#cb125-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-477"><a href="#cb125-477" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> </span>
<span id="cb125-478"><a href="#cb125-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb125-479"><a href="#cb125-479" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">y =</span> depth),</span>
<span id="cb125-480"><a href="#cb125-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb125-481"><a href="#cb125-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun.min =</span> min,</span>
<span id="cb125-482"><a href="#cb125-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun.max =</span> max,</span>
<span id="cb125-483"><a href="#cb125-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean</span>
<span id="cb125-484"><a href="#cb125-484" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-485"><a href="#cb125-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-486"><a href="#cb125-486" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(trans, cty)) <span class="sc">+</span> </span>
<span id="cb125-487"><a href="#cb125-487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb125-488"><a href="#cb125-488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb125-489"><a href="#cb125-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-490"><a href="#cb125-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-491"><a href="#cb125-491" aria-hidden="true" tabindex="-1"></a><span class="fu">### 位置调整 position adjustments</span></span>
<span id="cb125-492"><a href="#cb125-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-493"><a href="#cb125-493" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 条</span></span>
<span id="cb125-494"><a href="#cb125-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-497"><a href="#cb125-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-498"><a href="#cb125-498" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> class)) <span class="sc">+</span> </span>
<span id="cb125-499"><a href="#cb125-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">position =</span> <span class="st">"identity"</span>)<span class="sc">|</span></span>
<span id="cb125-500"><a href="#cb125-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-501"><a href="#cb125-501" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb125-502"><a href="#cb125-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span>
<span id="cb125-503"><a href="#cb125-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-504"><a href="#cb125-504" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> class)) <span class="sc">+</span> </span>
<span id="cb125-505"><a href="#cb125-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>)<span class="sc">|</span></span>
<span id="cb125-506"><a href="#cb125-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-507"><a href="#cb125-507" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">fill =</span> class)) <span class="sc">+</span> </span>
<span id="cb125-508"><a href="#cb125-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb125-509"><a href="#cb125-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-510"><a href="#cb125-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-511"><a href="#cb125-511" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 点</span></span>
<span id="cb125-512"><a href="#cb125-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-513"><a href="#cb125-513" aria-hidden="true" tabindex="-1"></a>position_nudge()：按固定偏移量移动点。</span>
<span id="cb125-514"><a href="#cb125-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-515"><a href="#cb125-515" aria-hidden="true" tabindex="-1"></a>position_jitter()：为每个位置添加一点随机噪音。</span>
<span id="cb125-516"><a href="#cb125-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-517"><a href="#cb125-517" aria-hidden="true" tabindex="-1"></a>position_jitterdodge()：躲避组内的点，然后添加一点随机噪音。</span>
<span id="cb125-518"><a href="#cb125-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-521"><a href="#cb125-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-522"><a href="#cb125-522" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb125-523"><a href="#cb125-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">|</span></span>
<span id="cb125-524"><a href="#cb125-524" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb125-525"><a href="#cb125-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>)</span>
<span id="cb125-526"><a href="#cb125-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-527"><a href="#cb125-527" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb125-528"><a href="#cb125-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span><span class="fu">position_nudge</span>(<span class="at">x=</span><span class="fl">0.1</span>,<span class="at">y=</span><span class="dv">0</span>))<span class="sc">|</span></span>
<span id="cb125-529"><a href="#cb125-529" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> hwy,<span class="at">color=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> </span>
<span id="cb125-530"><a href="#cb125-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>())</span>
<span id="cb125-531"><a href="#cb125-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-532"><a href="#cb125-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-533"><a href="#cb125-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-534"><a href="#cb125-534" aria-hidden="true" tabindex="-1"></a><span class="fu">## 坐标系 coordinate</span></span>
<span id="cb125-535"><a href="#cb125-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-536"><a href="#cb125-536" aria-hidden="true" tabindex="-1"></a>默认坐标系是笛卡尔坐标系</span>
<span id="cb125-537"><a href="#cb125-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-540"><a href="#cb125-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-541"><a href="#cb125-541" aria-hidden="true" tabindex="-1"></a>bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> diamonds) <span class="sc">+</span> </span>
<span id="cb125-542"><a href="#cb125-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(</span>
<span id="cb125-543"><a href="#cb125-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> clarity, <span class="at">fill =</span> clarity), </span>
<span id="cb125-544"><a href="#cb125-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb125-545"><a href="#cb125-545" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1</span></span>
<span id="cb125-546"><a href="#cb125-546" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb125-547"><a href="#cb125-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span>
<span id="cb125-548"><a href="#cb125-548" aria-hidden="true" tabindex="-1"></a>bar<span class="sc">|</span></span>
<span id="cb125-549"><a href="#cb125-549" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_flip</span>()<span class="sc">|</span> <span class="co">#水平条形图</span></span>
<span id="cb125-550"><a href="#cb125-550" aria-hidden="true" tabindex="-1"></a>bar <span class="sc">+</span> <span class="fu">coord_polar</span>()<span class="co">#极坐标</span></span>
<span id="cb125-551"><a href="#cb125-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-552"><a href="#cb125-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-555"><a href="#cb125-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-556"><a href="#cb125-556" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb125-557"><a href="#cb125-557" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>)</span>
<span id="cb125-558"><a href="#cb125-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-559"><a href="#cb125-559" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb125-560"><a href="#cb125-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">|</span></span>
<span id="cb125-561"><a href="#cb125-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-562"><a href="#cb125-562" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb125-563"><a href="#cb125-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb125-564"><a href="#cb125-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_quickmap</span>() <span class="co">#正确设置地理地图的纵横比</span></span>
<span id="cb125-565"><a href="#cb125-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-566"><a href="#cb125-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-567"><a href="#cb125-567" aria-hidden="true" tabindex="-1"></a><span class="fu">## 坐标轴 axis</span></span>
<span id="cb125-568"><a href="#cb125-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-569"><a href="#cb125-569" aria-hidden="true" tabindex="-1"></a><span class="fu">### 变换</span></span>
<span id="cb125-570"><a href="#cb125-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-573"><a href="#cb125-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-574"><a href="#cb125-574" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">log10</span>(cty),hwy)) <span class="sc">+</span></span>
<span id="cb125-575"><a href="#cb125-575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb125-576"><a href="#cb125-576" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>()</span>
<span id="cb125-577"><a href="#cb125-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-578"><a href="#cb125-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-579"><a href="#cb125-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-580"><a href="#cb125-580" aria-hidden="true" tabindex="-1"></a><span class="fu">### limits</span></span>
<span id="cb125-581"><a href="#cb125-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-584"><a href="#cb125-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-585"><a href="#cb125-585" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb125-586"><a href="#cb125-586" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb125-587"><a href="#cb125-587" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb125-588"><a href="#cb125-588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb125-589"><a href="#cb125-589" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">5</span>, <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb125-590"><a href="#cb125-590" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">10</span>, <span class="dv">25</span>)</span>
<span id="cb125-591"><a href="#cb125-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-592"><a href="#cb125-592" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(drv, hwy)) <span class="sc">+</span></span>
<span id="cb125-593"><a href="#cb125-593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb125-594"><a href="#cb125-594" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="st">"f"</span>, <span class="st">"r"</span>) <span class="sc">+</span></span>
<span id="cb125-595"><a href="#cb125-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">25</span>, <span class="cn">NA</span>)</span>
<span id="cb125-596"><a href="#cb125-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-597"><a href="#cb125-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-600"><a href="#cb125-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-601"><a href="#cb125-601" aria-hidden="true" tabindex="-1"></a><span class="co"># filter</span></span>
<span id="cb125-602"><a href="#cb125-602" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb125-603"><a href="#cb125-603" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(displ <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> displ <span class="sc">&lt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> hwy <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;</span> hwy <span class="sc">&lt;=</span> <span class="dv">25</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-604"><a href="#cb125-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-605"><a href="#cb125-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-606"><a href="#cb125-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">|</span></span>
<span id="cb125-607"><a href="#cb125-607" aria-hidden="true" tabindex="-1"></a><span class="co"># limits</span></span>
<span id="cb125-608"><a href="#cb125-608" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-609"><a href="#cb125-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-610"><a href="#cb125-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb125-611"><a href="#cb125-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">+</span>    <span class="co">#取子集</span></span>
<span id="cb125-612"><a href="#cb125-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>))  </span>
<span id="cb125-613"><a href="#cb125-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-614"><a href="#cb125-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-615"><a href="#cb125-615" aria-hidden="true" tabindex="-1"></a><span class="fu">### zooming</span></span>
<span id="cb125-616"><a href="#cb125-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-617"><a href="#cb125-617" aria-hidden="true" tabindex="-1"></a>调整绘制的数据,在每个刻度中设置<span class="in">`coord_cartesian(xlim= ,ylim= )`</span></span>
<span id="cb125-618"><a href="#cb125-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-621"><a href="#cb125-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-622"><a href="#cb125-622" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-623"><a href="#cb125-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-624"><a href="#cb125-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb125-625"><a href="#cb125-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>))   <span class="co">#放大局部</span></span>
<span id="cb125-626"><a href="#cb125-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-627"><a href="#cb125-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-628"><a href="#cb125-628" aria-hidden="true" tabindex="-1"></a><span class="fu">### 共享</span></span>
<span id="cb125-629"><a href="#cb125-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-630"><a href="#cb125-630" aria-hidden="true" tabindex="-1"></a>shared</span>
<span id="cb125-631"><a href="#cb125-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-632"><a href="#cb125-632" aria-hidden="true" tabindex="-1"></a>坐标轴相同</span>
<span id="cb125-633"><a href="#cb125-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-636"><a href="#cb125-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-637"><a href="#cb125-637" aria-hidden="true" tabindex="-1"></a>x_scale <span class="ot">&lt;-</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">range</span>(mpg<span class="sc">$</span>displ))</span>
<span id="cb125-638"><a href="#cb125-638" aria-hidden="true" tabindex="-1"></a>y_scale <span class="ot">&lt;-</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">range</span>(mpg<span class="sc">$</span>hwy))</span>
<span id="cb125-639"><a href="#cb125-639" aria-hidden="true" tabindex="-1"></a>col_scale <span class="ot">&lt;-</span> <span class="fu">scale_color_discrete</span>(<span class="at">limits =</span> <span class="fu">unique</span>(mpg<span class="sc">$</span>drv))</span>
<span id="cb125-640"><a href="#cb125-640" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg[mpg<span class="sc">$</span>class<span class="sc">==</span><span class="st">"suv"</span>,], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-641"><a href="#cb125-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-642"><a href="#cb125-642" aria-hidden="true" tabindex="-1"></a>  x_scale <span class="sc">+</span></span>
<span id="cb125-643"><a href="#cb125-643" aria-hidden="true" tabindex="-1"></a>  y_scale <span class="sc">+</span></span>
<span id="cb125-644"><a href="#cb125-644" aria-hidden="true" tabindex="-1"></a>  col_scale<span class="sc">|</span></span>
<span id="cb125-645"><a href="#cb125-645" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg[mpg<span class="sc">$</span>class<span class="sc">==</span><span class="st">"compact"</span>,], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-646"><a href="#cb125-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-647"><a href="#cb125-647" aria-hidden="true" tabindex="-1"></a>  x_scale <span class="sc">+</span></span>
<span id="cb125-648"><a href="#cb125-648" aria-hidden="true" tabindex="-1"></a>  y_scale <span class="sc">+</span></span>
<span id="cb125-649"><a href="#cb125-649" aria-hidden="true" tabindex="-1"></a>  col_scale</span>
<span id="cb125-650"><a href="#cb125-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-651"><a href="#cb125-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-652"><a href="#cb125-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## 标题 labels</span></span>
<span id="cb125-653"><a href="#cb125-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-656"><a href="#cb125-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-657"><a href="#cb125-657" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span></span>
<span id="cb125-658"><a href="#cb125-658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb125-659"><a href="#cb125-659" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"city driving (mpg)"</span>) <span class="sc">+</span></span>
<span id="cb125-660"><a href="#cb125-660" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"highway driving (mpg)"</span>)<span class="sc">+</span></span>
<span id="cb125-661"><a href="#cb125-661" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"主标题"</span>)</span>
<span id="cb125-662"><a href="#cb125-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-663"><a href="#cb125-663" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-664"><a href="#cb125-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb125-665"><a href="#cb125-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb125-666"><a href="#cb125-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb125-667"><a href="#cb125-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Engine displacement (L)"</span>,</span>
<span id="cb125-668"><a href="#cb125-668" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Highway fuel economy (mpg)"</span>,</span>
<span id="cb125-669"><a href="#cb125-669" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Car type"</span>, <span class="co"># 图例 美学映射color</span></span>
<span id="cb125-670"><a href="#cb125-670" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fuel efficiency generally decreases with engine size"</span>,</span>
<span id="cb125-671"><a href="#cb125-671" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Two seaters (sports cars) are an </span></span>
<span id="cb125-672"><a href="#cb125-672" aria-hidden="true" tabindex="-1"></a><span class="st">    exception because of their light weight"</span>,</span>
<span id="cb125-673"><a href="#cb125-673" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data from fueleconomy.gov"</span></span>
<span id="cb125-674"><a href="#cb125-674" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-675"><a href="#cb125-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-676"><a href="#cb125-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-677"><a href="#cb125-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## 注释 annotation</span></span>
<span id="cb125-678"><a href="#cb125-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-679"><a href="#cb125-679" aria-hidden="true" tabindex="-1"></a><span class="fu">### 文本 text</span></span>
<span id="cb125-680"><a href="#cb125-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-683"><a href="#cb125-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-684"><a href="#cb125-684" aria-hidden="true" tabindex="-1"></a><span class="co"># 字体</span></span>
<span id="cb125-685"><a href="#cb125-685" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">family =</span> <span class="fu">c</span>(<span class="st">"sans"</span>, <span class="st">"serif"</span>, <span class="st">"mono"</span>))</span>
<span id="cb125-686"><a href="#cb125-686" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb125-687"><a href="#cb125-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> family, <span class="at">family =</span> family))</span>
<span id="cb125-688"><a href="#cb125-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-689"><a href="#cb125-689" aria-hidden="true" tabindex="-1"></a><span class="co"># 样式</span></span>
<span id="cb125-690"><a href="#cb125-690" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">face =</span> <span class="fu">c</span>(<span class="st">"plain"</span>, <span class="st">"bold"</span>, <span class="st">"italic"</span>))</span>
<span id="cb125-691"><a href="#cb125-691" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb125-692"><a href="#cb125-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> face, <span class="at">fontface =</span> face))</span>
<span id="cb125-693"><a href="#cb125-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-694"><a href="#cb125-694" aria-hidden="true" tabindex="-1"></a><span class="co"># 位置</span></span>
<span id="cb125-695"><a href="#cb125-695" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-696"><a href="#cb125-696" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">1.5</span>),</span>
<span id="cb125-697"><a href="#cb125-697" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">1.5</span>),</span>
<span id="cb125-698"><a href="#cb125-698" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="fu">c</span>(</span>
<span id="cb125-699"><a href="#cb125-699" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bottom-left"</span>, <span class="st">"top-left"</span>,  </span>
<span id="cb125-700"><a href="#cb125-700" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bottom-right"</span>, <span class="st">"top-right"</span>, <span class="st">"center"</span></span>
<span id="cb125-701"><a href="#cb125-701" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-702"><a href="#cb125-702" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-703"><a href="#cb125-703" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb125-704"><a href="#cb125-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> text))<span class="sc">|</span></span>
<span id="cb125-705"><a href="#cb125-705" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb125-706"><a href="#cb125-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> text), <span class="at">vjust =</span> <span class="st">"inward"</span>, <span class="at">hjust =</span> <span class="st">"inward"</span>)</span>
<span id="cb125-707"><a href="#cb125-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-708"><a href="#cb125-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-709"><a href="#cb125-709" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义</span></span>
<span id="cb125-710"><a href="#cb125-710" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb125-711"><a href="#cb125-711" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>), </span>
<span id="cb125-712"><a href="#cb125-712" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">2.5</span>)</span>
<span id="cb125-713"><a href="#cb125-713" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-714"><a href="#cb125-714" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(treatment, response)) <span class="sc">+</span> </span>
<span id="cb125-715"><a href="#cb125-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb125-716"><a href="#cb125-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb125-717"><a href="#cb125-717" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, response, <span class="st">")"</span>)), </span>
<span id="cb125-718"><a href="#cb125-718" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb125-719"><a href="#cb125-719" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y=</span>.<span class="dv">2</span></span>
<span id="cb125-720"><a href="#cb125-720" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb125-721"><a href="#cb125-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-722"><a href="#cb125-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-725"><a href="#cb125-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-726"><a href="#cb125-726" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span></span>
<span id="cb125-727"><a href="#cb125-727" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cyl,am) <span class="sc">|&gt;</span> </span>
<span id="cb125-728"><a href="#cb125-728" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb125-729"><a href="#cb125-729" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pct =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb125-730"><a href="#cb125-730" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbls =</span> scales<span class="sc">::</span><span class="fu">percent</span>(pct)</span>
<span id="cb125-731"><a href="#cb125-731" aria-hidden="true" tabindex="-1"></a>         )<span class="sc">|&gt;</span> </span>
<span id="cb125-732"><a href="#cb125-732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(cyl),pct,<span class="at">fill=</span><span class="fu">factor</span>(am)))<span class="sc">+</span></span>
<span id="cb125-733"><a href="#cb125-733" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">position =</span> <span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb125-734"><a href="#cb125-734" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label=</span>lbls),</span>
<span id="cb125-735"><a href="#cb125-735" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb125-736"><a href="#cb125-736" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">3</span></span>
<span id="cb125-737"><a href="#cb125-737" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb125-738"><a href="#cb125-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-739"><a href="#cb125-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-742"><a href="#cb125-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-743"><a href="#cb125-743" aria-hidden="true" tabindex="-1"></a>label_info <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span></span>
<span id="cb125-744"><a href="#cb125-744" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(drv) <span class="sc">|&gt;</span></span>
<span id="cb125-745"><a href="#cb125-745" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(displ)) <span class="sc">|&gt;</span></span>
<span id="cb125-746"><a href="#cb125-746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb125-747"><a href="#cb125-747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb125-748"><a href="#cb125-748" aria-hidden="true" tabindex="-1"></a>        <span class="at">drive_type =</span> <span class="fu">case_when</span>(       <span class="co"># vectorise multiple if_else () statements </span></span>
<span id="cb125-749"><a href="#cb125-749" aria-hidden="true" tabindex="-1"></a>        drv <span class="sc">==</span> <span class="st">"f"</span> <span class="sc">~</span> <span class="st">"front-wheel drive"</span>,</span>
<span id="cb125-750"><a href="#cb125-750" aria-hidden="true" tabindex="-1"></a>        drv <span class="sc">==</span> <span class="st">"r"</span> <span class="sc">~</span> <span class="st">"rear-wheel drive"</span>,</span>
<span id="cb125-751"><a href="#cb125-751" aria-hidden="true" tabindex="-1"></a>        drv <span class="sc">==</span> <span class="st">"4"</span> <span class="sc">~</span> <span class="st">"4-wheel drive"</span>)</span>
<span id="cb125-752"><a href="#cb125-752" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">|&gt;</span></span>
<span id="cb125-753"><a href="#cb125-753" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(displ, hwy, drv, drive_type)</span>
<span id="cb125-754"><a href="#cb125-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-755"><a href="#cb125-755" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-756"><a href="#cb125-756" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb125-757"><a href="#cb125-757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">formula=</span><span class="st">"y~x"</span>,<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb125-758"><a href="#cb125-758" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb125-759"><a href="#cb125-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-760"><a href="#cb125-760" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span>  <span class="fu">geom_text</span>(<span class="co">#添加注释  geom_label 标签加背景框</span></span>
<span id="cb125-761"><a href="#cb125-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> label_info, </span>
<span id="cb125-762"><a href="#cb125-762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">label =</span> drive_type),<span class="co">#label映射</span></span>
<span id="cb125-763"><a href="#cb125-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">nudge_y =</span> <span class="dv">2</span></span>
<span id="cb125-764"><a href="#cb125-764" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb125-765"><a href="#cb125-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-766"><a href="#cb125-766" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(                   </span>
<span id="cb125-767"><a href="#cb125-767" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> label_info, </span>
<span id="cb125-768"><a href="#cb125-768" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">label =</span> drive_type),</span>
<span id="cb125-769"><a href="#cb125-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">nudge_y =</span> <span class="dv">2</span></span>
<span id="cb125-770"><a href="#cb125-770" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb125-771"><a href="#cb125-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-772"><a href="#cb125-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-773"><a href="#cb125-773" aria-hidden="true" tabindex="-1"></a>potential_outliers <span class="ot">&lt;-</span> mpg <span class="sc">|&gt;</span></span>
<span id="cb125-774"><a href="#cb125-774" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hwy <span class="sc">&gt;</span> <span class="dv">40</span> <span class="sc">|</span> (hwy <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">&amp;</span> displ <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb125-775"><a href="#cb125-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-776"><a href="#cb125-776" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-777"><a href="#cb125-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-778"><a href="#cb125-778" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> potential_outliers, <span class="fu">aes</span>(<span class="at">label =</span> model)) <span class="sc">+</span></span>
<span id="cb125-779"><a href="#cb125-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> potential_outliers, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb125-780"><a href="#cb125-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb125-781"><a href="#cb125-781" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> potential_outliers,</span>
<span id="cb125-782"><a href="#cb125-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="st">"circle open"</span></span>
<span id="cb125-783"><a href="#cb125-783" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-784"><a href="#cb125-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-785"><a href="#cb125-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-786"><a href="#cb125-786" aria-hidden="true" tabindex="-1"></a><span class="fu">### markdown</span></span>
<span id="cb125-787"><a href="#cb125-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-790"><a href="#cb125-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-791"><a href="#cb125-791" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb125-792"><a href="#cb125-792" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb125-793"><a href="#cb125-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb125-794"><a href="#cb125-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Axis title with *italics* and **boldface**"</span>)</span>
<span id="cb125-795"><a href="#cb125-795" aria-hidden="true" tabindex="-1"></a>base <span class="sc">|</span></span>
<span id="cb125-796"><a href="#cb125-796" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.x =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>())  <span class="co">#ggtext::element_markdown</span></span>
<span id="cb125-797"><a href="#cb125-797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-798"><a href="#cb125-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-799"><a href="#cb125-799" aria-hidden="true" tabindex="-1"></a><span class="fu">### 数学表达式</span></span>
<span id="cb125-800"><a href="#cb125-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-803"><a href="#cb125-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-804"><a href="#cb125-804" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb125-805"><a href="#cb125-805" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb125-806"><a href="#cb125-806" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">cumsum</span>(x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-807"><a href="#cb125-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb125-808"><a href="#cb125-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-809"><a href="#cb125-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb125-810"><a href="#cb125-810" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">quote</span>(x[i]),</span>
<span id="cb125-811"><a href="#cb125-811" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">quote</span>(<span class="fu">sum</span>(x[i] <span class="sc">^</span> <span class="dv">2</span>, i <span class="sc">==</span> <span class="dv">1</span>, n)) <span class="co">#数学方程式</span></span>
<span id="cb125-812"><a href="#cb125-812" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-813"><a href="#cb125-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-814"><a href="#cb125-814" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb125-815"><a href="#cb125-815" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> values, <span class="at">y =</span> values <span class="sc">^</span> <span class="dv">3</span>)</span>
<span id="cb125-816"><a href="#cb125-816" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb125-817"><a href="#cb125-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb125-818"><a href="#cb125-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">quote</span>(<span class="fu">f</span>(x) <span class="sc">==</span> x<span class="sc">^</span><span class="dv">3</span>))         <span class="co">#数学表达式   ？plotmath</span></span>
<span id="cb125-819"><a href="#cb125-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-820"><a href="#cb125-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-821"><a href="#cb125-821" aria-hidden="true" tabindex="-1"></a><span class="fu">### 线段 直线 箭头</span></span>
<span id="cb125-822"><a href="#cb125-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-823"><a href="#cb125-823" aria-hidden="true" tabindex="-1"></a>geom_hline()</span>
<span id="cb125-824"><a href="#cb125-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-825"><a href="#cb125-825" aria-hidden="true" tabindex="-1"></a>geom_vline()</span>
<span id="cb125-826"><a href="#cb125-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-827"><a href="#cb125-827" aria-hidden="true" tabindex="-1"></a>geom_abline</span>
<span id="cb125-828"><a href="#cb125-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-829"><a href="#cb125-829" aria-hidden="true" tabindex="-1"></a>geom_segment() arrow</span>
<span id="cb125-830"><a href="#cb125-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-833"><a href="#cb125-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-834"><a href="#cb125-834" aria-hidden="true" tabindex="-1"></a>trend_text <span class="ot">&lt;-</span> <span class="st">"Larger engine sizes tend to have lower fuel economy."</span> <span class="sc">|&gt;</span></span>
<span id="cb125-835"><a href="#cb125-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_wrap</span>(<span class="at">width =</span> <span class="dv">30</span>)</span>
<span id="cb125-836"><a href="#cb125-836" aria-hidden="true" tabindex="-1"></a>trend_text</span>
<span id="cb125-837"><a href="#cb125-837" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-838"><a href="#cb125-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-839"><a href="#cb125-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb125-840"><a href="#cb125-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="dv">38</span>,</span>
<span id="cb125-841"><a href="#cb125-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> trend_text,</span>
<span id="cb125-842"><a href="#cb125-842" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb125-843"><a href="#cb125-843" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-844"><a href="#cb125-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb125-845"><a href="#cb125-845" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"segment"</span>,</span>
<span id="cb125-846"><a href="#cb125-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">xend =</span> <span class="dv">5</span>, <span class="at">yend =</span> <span class="dv">25</span>, <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb125-847"><a href="#cb125-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">type =</span> <span class="st">"closed"</span>)</span>
<span id="cb125-848"><a href="#cb125-848" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-849"><a href="#cb125-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-850"><a href="#cb125-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-853"><a href="#cb125-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-854"><a href="#cb125-854" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb125-855"><a href="#cb125-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb125-856"><a href="#cb125-856" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(mpg, manufacturer <span class="sc">==</span> <span class="st">"subaru"</span>), </span>
<span id="cb125-857"><a href="#cb125-857" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"orange"</span>,</span>
<span id="cb125-858"><a href="#cb125-858" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb125-859"><a href="#cb125-859" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-860"><a href="#cb125-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb125-861"><a href="#cb125-861" aria-hidden="true" tabindex="-1"></a>p<span class="sc">|</span>p <span class="sc">+</span> </span>
<span id="cb125-862"><a href="#cb125-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">x =</span> <span class="fl">5.5</span>, <span class="at">y =</span> <span class="dv">40</span>, <span class="at">colour =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb125-863"><a href="#cb125-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">x =</span> <span class="fl">5.5</span>, <span class="at">y =</span> <span class="dv">40</span>) <span class="sc">+</span> </span>
<span id="cb125-864"><a href="#cb125-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">5.6</span>, <span class="at">y =</span> <span class="dv">40</span>, <span class="at">label =</span> <span class="st">"subaru"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)<span class="sc">|</span></span>
<span id="cb125-865"><a href="#cb125-865" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb125-866"><a href="#cb125-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb125-867"><a href="#cb125-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">xend =</span> <span class="fl">2.65</span>, <span class="at">yend =</span> <span class="dv">27</span>, </span>
<span id="cb125-868"><a href="#cb125-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> .<span class="dv">3</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>))</span>
<span id="cb125-869"><a href="#cb125-869" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-870"><a href="#cb125-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.1</span>, <span class="at">y =</span> <span class="dv">35</span>, <span class="at">label =</span> <span class="st">"subaru"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb125-871"><a href="#cb125-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-872"><a href="#cb125-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-873"><a href="#cb125-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-874"><a href="#cb125-874" aria-hidden="true" tabindex="-1"></a><span class="fu">## scale</span></span>
<span id="cb125-875"><a href="#cb125-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-876"><a href="#cb125-876" aria-hidden="true" tabindex="-1"></a><span class="fu">### x/y_continuous</span></span>
<span id="cb125-877"><a href="#cb125-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-880"><a href="#cb125-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-881"><a href="#cb125-881" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span> </span>
<span id="cb125-882"><a href="#cb125-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-883"><a href="#cb125-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Weight (1000 lbs.)"</span>,   </span>
<span id="cb125-884"><a href="#cb125-884" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n.breaks =</span> <span class="dv">10</span>,                 </span>
<span id="cb125-885"><a href="#cb125-885" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="cn">NULL</span>,           </span>
<span id="cb125-886"><a href="#cb125-886" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">5.5</span>)) <span class="sc">+</span>        </span>
<span id="cb125-887"><a href="#cb125-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Miles per gallon"</span>,     </span>
<span id="cb125-888"><a href="#cb125-888" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">5</span>),       </span>
<span id="cb125-889"><a href="#cb125-889" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">1</span>), </span>
<span id="cb125-890"><a href="#cb125-890" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">35</span>)) <span class="sc">+</span>          </span>
<span id="cb125-891"><a href="#cb125-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fuel efficiency by car weight"</span>)</span>
<span id="cb125-892"><a href="#cb125-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-893"><a href="#cb125-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-894"><a href="#cb125-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-895"><a href="#cb125-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-898"><a href="#cb125-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-899"><a href="#cb125-899" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span> cut)) <span class="sc">+</span></span>
<span id="cb125-900"><a href="#cb125-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb125-901"><a href="#cb125-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_dollar</span>(<span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>, <span class="at">suffix =</span> <span class="st">"K"</span>))</span>
<span id="cb125-902"><a href="#cb125-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-903"><a href="#cb125-903" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> cut, <span class="at">fill =</span> clarity)) <span class="sc">+</span></span>
<span id="cb125-904"><a href="#cb125-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb125-905"><a href="#cb125-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Percentage"</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>())</span>
<span id="cb125-906"><a href="#cb125-906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-907"><a href="#cb125-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-908"><a href="#cb125-908" aria-hidden="true" tabindex="-1"></a><span class="fu">### x/y_discrete</span></span>
<span id="cb125-909"><a href="#cb125-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-912"><a href="#cb125-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-913"><a href="#cb125-913" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(drv),<span class="at">fill=</span>class))<span class="sc">+</span></span>
<span id="cb125-914"><a href="#cb125-914" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="ot">-&gt;</span>p</span>
<span id="cb125-915"><a href="#cb125-915" aria-hidden="true" tabindex="-1"></a>p <span class="sc">|</span> p <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"drv"</span>,                                  </span>
<span id="cb125-916"><a href="#cb125-916" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"f"</span>, <span class="st">"r"</span>),    </span>
<span id="cb125-917"><a href="#cb125-917" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'f'</span><span class="ot">=</span><span class="st">"drv='f'"</span>,<span class="st">'r'</span><span class="ot">=</span> <span class="st">"drv='r'"</span>),</span>
<span id="cb125-918"><a href="#cb125-918" aria-hidden="true" tabindex="-1"></a>                   <span class="at">position =</span> <span class="st">"top"</span>) </span>
<span id="cb125-919"><a href="#cb125-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-920"><a href="#cb125-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-921"><a href="#cb125-921" aria-hidden="true" tabindex="-1"></a><span class="fu">### color</span></span>
<span id="cb125-922"><a href="#cb125-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-925"><a href="#cb125-925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-926"><a href="#cb125-926" aria-hidden="true" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span>
<span id="cb125-927"><a href="#cb125-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-928"><a href="#cb125-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-931"><a href="#cb125-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-932"><a href="#cb125-932" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg, <span class="at">color=</span>disp)) <span class="sc">+</span></span>
<span id="cb125-933"><a href="#cb125-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">19</span>, <span class="at">size=</span><span class="dv">3</span>) </span>
<span id="cb125-934"><a href="#cb125-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-935"><a href="#cb125-935" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"A. Default color gradient"</span>)<span class="sc">|</span></span>
<span id="cb125-936"><a href="#cb125-936" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">"grey"</span>, <span class="at">high=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb125-937"><a href="#cb125-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"B. Greyscale gradient"</span>)<span class="sc">|</span></span>
<span id="cb125-938"><a href="#cb125-938" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">"red"</span>, <span class="at">high=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb125-939"><a href="#cb125-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"C. Red-blue color gradient"</span>)</span>
<span id="cb125-940"><a href="#cb125-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-941"><a href="#cb125-941" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_steps</span>(<span class="at">low=</span><span class="st">"red"</span>, <span class="at">high=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb125-942"><a href="#cb125-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"D. Red-blue binned color Gradient"</span>)<span class="sc">|</span></span>
<span id="cb125-943"><a href="#cb125-943" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_steps2</span>(<span class="at">low=</span><span class="st">"red"</span>, <span class="at">mid=</span><span class="st">"white"</span>, <span class="at">high=</span><span class="st">"blue"</span>,</span>
<span id="cb125-944"><a href="#cb125-944" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint=</span><span class="fu">median</span>(mtcars<span class="sc">$</span>disp)) <span class="sc">+</span></span>
<span id="cb125-945"><a href="#cb125-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"E. Red-white-blue binned gradient"</span>)<span class="sc">|</span></span>
<span id="cb125-946"><a href="#cb125-946" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_viridis_c</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span>    <span class="co"># viridis_c,d,b</span></span>
<span id="cb125-947"><a href="#cb125-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"F. Viridis color gradient"</span>)</span>
<span id="cb125-948"><a href="#cb125-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-949"><a href="#cb125-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-950"><a href="#cb125-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-953"><a href="#cb125-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-954"><a href="#cb125-954" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb125-955"><a href="#cb125-955" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>),</span>
<span id="cb125-956"><a href="#cb125-956" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb125-957"><a href="#cb125-957" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-958"><a href="#cb125-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-959"><a href="#cb125-959" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb125-960"><a href="#cb125-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb125-961"><a href="#cb125-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb125-962"><a href="#cb125-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Default, continuous"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb125-963"><a href="#cb125-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-964"><a href="#cb125-964" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb125-965"><a href="#cb125-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb125-966"><a href="#cb125-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb125-967"><a href="#cb125-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb125-968"><a href="#cb125-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Viridis, continuous"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb125-969"><a href="#cb125-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-970"><a href="#cb125-970" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb125-971"><a href="#cb125-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb125-972"><a href="#cb125-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb125-973"><a href="#cb125-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_b</span>() <span class="sc">+</span></span>
<span id="cb125-974"><a href="#cb125-974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Viridis, binned"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span>
<span id="cb125-975"><a href="#cb125-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-976"><a href="#cb125-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-977"><a href="#cb125-977" aria-hidden="true" tabindex="-1"></a><span class="fu">### fill</span></span>
<span id="cb125-978"><a href="#cb125-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-981"><a href="#cb125-981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-982"><a href="#cb125-982" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(drv,<span class="at">fill=</span>class))<span class="sc">+</span></span>
<span id="cb125-983"><a href="#cb125-983" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>()</span>
<span id="cb125-984"><a href="#cb125-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-985"><a href="#cb125-985" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"A. Default colors"</span>)<span class="sc">|</span></span>
<span id="cb125-986"><a href="#cb125-986" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb125-987"><a href="#cb125-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"B. ColorBrewer Set2 palette"</span>)</span>
<span id="cb125-988"><a href="#cb125-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-989"><a href="#cb125-989" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb125-990"><a href="#cb125-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"C. Viridis color scheme"</span>)<span class="sc">|</span></span>
<span id="cb125-991"><a href="#cb125-991" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gold4"</span>, <span class="st">"orange2"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"blue4"</span>,</span>
<span id="cb125-992"><a href="#cb125-992" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"brown2"</span>, <span class="st">"yellowgreen"</span>,<span class="st">"lightpink"</span>)) <span class="sc">+</span></span>
<span id="cb125-993"><a href="#cb125-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"D. Manual color selection"</span>)</span>
<span id="cb125-994"><a href="#cb125-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-995"><a href="#cb125-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-996"><a href="#cb125-996" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分面</span></span>
<span id="cb125-997"><a href="#cb125-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1000"><a href="#cb125-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1001"><a href="#cb125-1001" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span>displ))<span class="sc">+</span></span>
<span id="cb125-1002"><a href="#cb125-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>)</span>
<span id="cb125-1003"><a href="#cb125-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1004"><a href="#cb125-1004" aria-hidden="true" tabindex="-1"></a><span class="co"># 一个分类变量</span></span>
<span id="cb125-1005"><a href="#cb125-1005" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv,<span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb125-1006"><a href="#cb125-1006" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv,<span class="at">ncol =</span> <span class="dv">3</span>)  <span class="co">#</span></span>
<span id="cb125-1007"><a href="#cb125-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1008"><a href="#cb125-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># 多个分类变量</span></span>
<span id="cb125-1009"><a href="#cb125-1009" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_grid</span>(drv<span class="sc">~</span>class)</span>
<span id="cb125-1010"><a href="#cb125-1010" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_grid</span>(drv<span class="sc">~</span>.)</span>
<span id="cb125-1011"><a href="#cb125-1011" aria-hidden="true" tabindex="-1"></a>q <span class="sc">+</span> <span class="fu">facet_grid</span>(.<span class="sc">~</span>drv)   <span class="co">#</span></span>
<span id="cb125-1012"><a href="#cb125-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1013"><a href="#cb125-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1016"><a href="#cb125-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1017"><a href="#cb125-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb125-1018"><a href="#cb125-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb125-1019"><a href="#cb125-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl) <span class="sc">|</span></span>
<span id="cb125-1020"><a href="#cb125-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb125-1021"><a href="#cb125-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb125-1022"><a href="#cb125-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv <span class="sc">~</span> cyl, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb125-1023"><a href="#cb125-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1024"><a href="#cb125-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1025"><a href="#cb125-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">## 主题</span></span>
<span id="cb125-1026"><a href="#cb125-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1027"><a href="#cb125-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">### 内置主题</span></span>
<span id="cb125-1028"><a href="#cb125-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1031"><a href="#cb125-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1032"><a href="#cb125-1032" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_grey</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_grey"</span>)  <span class="sc">|</span></span>
<span id="cb125-1033"><a href="#cb125-1033" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_bw"</span>)  </span>
<span id="cb125-1034"><a href="#cb125-1034" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_minimal"</span>)<span class="sc">|</span>  </span>
<span id="cb125-1035"><a href="#cb125-1035" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_classic"</span>)</span>
<span id="cb125-1036"><a href="#cb125-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1037"><a href="#cb125-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1038"><a href="#cb125-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">### 字体</span></span>
<span id="cb125-1039"><a href="#cb125-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1042"><a href="#cb125-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1043"><a href="#cb125-1043" aria-hidden="true" tabindex="-1"></a>findfont <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb125-1044"><a href="#cb125-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">require</span>(showtext))</span>
<span id="cb125-1045"><a href="#cb125-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(<span class="fu">require</span>(dplyr))</span>
<span id="cb125-1046"><a href="#cb125-1046" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">font_files</span>(), <span class="fu">grepl</span>(x, family, <span class="at">ignore.case=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb125-1047"><a href="#cb125-1047" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(path, file, family, face)</span>
<span id="cb125-1048"><a href="#cb125-1048" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-1049"><a href="#cb125-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1050"><a href="#cb125-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">findfont</span>(<span class="st">"comic"</span>)</span>
<span id="cb125-1051"><a href="#cb125-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add</span>(<span class="at">family =</span> <span class="st">"Times New Roman"</span>, <span class="at">regular =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">times.ttf"</span>,</span>
<span id="cb125-1052"><a href="#cb125-1052" aria-hidden="true" tabindex="-1"></a>         <span class="at">bold =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">timesbd.ttf"</span>,</span>
<span id="cb125-1053"><a href="#cb125-1053" aria-hidden="true" tabindex="-1"></a>         <span class="at">italic =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">timesi.ttf"</span>,</span>
<span id="cb125-1054"><a href="#cb125-1054" aria-hidden="true" tabindex="-1"></a>         <span class="at">bolditalic =</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Windows</span><span class="sc">\\</span><span class="st">Fonts</span><span class="sc">\\</span><span class="st">Times New Roman</span><span class="sc">\\</span><span class="st">timesbi.ttf"</span>)</span>
<span id="cb125-1055"><a href="#cb125-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">findfont</span>(<span class="st">"Times New Roman"</span>)</span>
<span id="cb125-1056"><a href="#cb125-1056" aria-hidden="true" tabindex="-1"></a><span class="fu">font.families</span>()</span>
<span id="cb125-1057"><a href="#cb125-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1058"><a href="#cb125-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1059"><a href="#cb125-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">### 自定义主题</span></span>
<span id="cb125-1060"><a href="#cb125-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1063"><a href="#cb125-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1064"><a href="#cb125-1064" aria-hidden="true" tabindex="-1"></a>mytheme <span class="ot">&lt;-</span> <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold.italic"</span>,  <span class="at">size=</span><span class="st">"14"</span>, <span class="at">color=</span><span class="st">"brown"</span>),</span>
<span id="cb125-1065"><a href="#cb125-1065" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold.italic"</span>,  <span class="at">size=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">"brown"</span>),</span>
<span id="cb125-1066"><a href="#cb125-1066" aria-hidden="true" tabindex="-1"></a>                 <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">9</span>,  <span class="at">color=</span><span class="st">"darkblue"</span>), </span>
<span id="cb125-1067"><a href="#cb125-1067" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>,  <span class="at">color=</span><span class="st">"darkblue"</span>),  </span>
<span id="cb125-1068"><a href="#cb125-1068" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.grid.major.y=</span><span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"grey"</span>,  <span class="at">linetype=</span><span class="dv">1</span>),  </span>
<span id="cb125-1069"><a href="#cb125-1069" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.grid.minor.y=</span><span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"grey"</span>,  <span class="at">linetype=</span><span class="dv">2</span>),  </span>
<span id="cb125-1070"><a href="#cb125-1070" aria-hidden="true" tabindex="-1"></a>                 <span class="at">panel.grid.minor.x=</span><span class="fu">element_blank</span>(),  <span class="at">legend.position=</span><span class="st">"top"</span>) </span>
<span id="cb125-1071"><a href="#cb125-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>drv, <span class="at">y=</span>hwy, <span class="at">fill=</span>drv)) <span class="sc">+</span>  </span>
<span id="cb125-1072"><a href="#cb125-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>  </span>
<span id="cb125-1073"><a href="#cb125-1073" aria-hidden="true" tabindex="-1"></a>  mytheme </span>
<span id="cb125-1074"><a href="#cb125-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1075"><a href="#cb125-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1076"><a href="#cb125-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1077"><a href="#cb125-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">### 图例</span></span>
<span id="cb125-1078"><a href="#cb125-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1081"><a href="#cb125-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1082"><a href="#cb125-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># 位置和布局</span></span>
<span id="cb125-1083"><a href="#cb125-1083" aria-hidden="true" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-1084"><a href="#cb125-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class))</span>
<span id="cb125-1085"><a href="#cb125-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1086"><a href="#cb125-1086" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="co"># the default</span></span>
<span id="cb125-1087"><a href="#cb125-1087" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"left"</span>)</span>
<span id="cb125-1088"><a href="#cb125-1088" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> </span>
<span id="cb125-1089"><a href="#cb125-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb125-1090"><a href="#cb125-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb125-1091"><a href="#cb125-1091" aria-hidden="true" tabindex="-1"></a>base <span class="sc">+</span> </span>
<span id="cb125-1092"><a href="#cb125-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb125-1093"><a href="#cb125-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>)))</span>
<span id="cb125-1094"><a href="#cb125-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1095"><a href="#cb125-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># 文本</span></span>
<span id="cb125-1096"><a href="#cb125-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1097"><a href="#cb125-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg, <span class="at">color =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb125-1098"><a href="#cb125-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb125-1099"><a href="#cb125-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name=</span><span class="st">"Cylinders"</span>) <span class="sc">+</span></span>
<span id="cb125-1100"><a href="#cb125-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fuel Efficiency for 32 Automobiles"</span>,</span>
<span id="cb125-1101"><a href="#cb125-1101" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb125-1102"><a href="#cb125-1102" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb125-1103"><a href="#cb125-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">95</span>, .<span class="dv">95</span>),</span>
<span id="cb125-1104"><a href="#cb125-1104" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb125-1105"><a href="#cb125-1105" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb125-1106"><a href="#cb125-1106" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb125-1107"><a href="#cb125-1107" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linewidth =</span> <span class="dv">1</span>),</span>
<span id="cb125-1108"><a href="#cb125-1108" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-1109"><a href="#cb125-1109" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb125-1110"><a href="#cb125-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1111"><a href="#cb125-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1114"><a href="#cb125-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1115"><a href="#cb125-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb125-1116"><a href="#cb125-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-1117"><a href="#cb125-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb125-1118"><a href="#cb125-1118" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Larger engine sizes tend to have lower fuel economy"</span>,</span>
<span id="cb125-1119"><a href="#cb125-1119" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span id="cb125-1120"><a href="#cb125-1120" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-1121"><a href="#cb125-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb125-1122"><a href="#cb125-1122" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>),</span>
<span id="cb125-1123"><a href="#cb125-1123" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb125-1124"><a href="#cb125-1124" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"blue"</span>),</span>
<span id="cb125-1125"><a href="#cb125-1125" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>,<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb125-1126"><a href="#cb125-1126" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb125-1127"><a href="#cb125-1127" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb125-1128"><a href="#cb125-1128" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb125-1129"><a href="#cb125-1129" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-1130"><a href="#cb125-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1131"><a href="#cb125-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1132"><a href="#cb125-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">### 绘图区</span></span>
<span id="cb125-1133"><a href="#cb125-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1136"><a href="#cb125-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1137"><a href="#cb125-1137" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>am, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Automatic"</span>, <span class="st">"Manual"</span>)) </span>
<span id="cb125-1138"><a href="#cb125-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mtcars, <span class="fu">aes</span>(<span class="at">x =</span> disp, <span class="at">y =</span> mpg)) <span class="sc">+</span>                     </span>
<span id="cb125-1139"><a href="#cb125-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(cyl)), <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span>                   </span>
<span id="cb125-1140"><a href="#cb125-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>),                             </span>
<span id="cb125-1141"><a href="#cb125-1141" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb125-1142"><a href="#cb125-1142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"Number of cylinders"</span>) <span class="sc">+</span></span>
<span id="cb125-1143"><a href="#cb125-1143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>am, <span class="at">ncol=</span><span class="dv">2</span>) <span class="sc">+</span>                                      </span>
<span id="cb125-1144"><a href="#cb125-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mileage, transmission type, and number of cylinders"</span>,</span>
<span id="cb125-1145"><a href="#cb125-1145" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Engine displacement (cu. in.)"</span>,</span>
<span id="cb125-1146"><a href="#cb125-1146" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb125-1147"><a href="#cb125-1147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>                                                  </span>
<span id="cb125-1148"><a href="#cb125-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb125-1149"><a href="#cb125-1149" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"lightgrey"</span>),</span>
<span id="cb125-1150"><a href="#cb125-1150" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"lightgrey"</span>,</span>
<span id="cb125-1151"><a href="#cb125-1151" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linetype=</span><span class="st">"dashed"</span>),</span>
<span id="cb125-1152"><a href="#cb125-1152" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb125-1153"><a href="#cb125-1153" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb125-1154"><a href="#cb125-1154" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_blank</span>())</span>
<span id="cb125-1155"><a href="#cb125-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1156"><a href="#cb125-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1157"><a href="#cb125-1157" aria-hidden="true" tabindex="-1"></a><span class="fu">## 图形布局patchwork</span></span>
<span id="cb125-1158"><a href="#cb125-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1159"><a href="#cb125-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">### 布局方式</span></span>
<span id="cb125-1160"><a href="#cb125-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1163"><a href="#cb125-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1164"><a href="#cb125-1164" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> cty, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb125-1165"><a href="#cb125-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb125-1166"><a href="#cb125-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 1"</span>)</span>
<span id="cb125-1167"><a href="#cb125-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1168"><a href="#cb125-1168" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb125-1169"><a href="#cb125-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb125-1170"><a href="#cb125-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 2"</span>)</span>
<span id="cb125-1171"><a href="#cb125-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1172"><a href="#cb125-1172" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">color =</span> drv, <span class="at">fill =</span> drv)) <span class="sc">+</span> </span>
<span id="cb125-1173"><a href="#cb125-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb125-1174"><a href="#cb125-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 3"</span>)</span>
<span id="cb125-1175"><a href="#cb125-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1176"><a href="#cb125-1176" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">color =</span> drv, <span class="at">fill =</span> drv)) <span class="sc">+</span> </span>
<span id="cb125-1177"><a href="#cb125-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb125-1178"><a href="#cb125-1178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 4"</span>)</span>
<span id="cb125-1179"><a href="#cb125-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1180"><a href="#cb125-1180" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb125-1181"><a href="#cb125-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb125-1182"><a href="#cb125-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv) <span class="sc">+</span></span>
<span id="cb125-1183"><a href="#cb125-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot 5"</span>)</span>
<span id="cb125-1184"><a href="#cb125-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1185"><a href="#cb125-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1186"><a href="#cb125-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1189"><a href="#cb125-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1190"><a href="#cb125-1190" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb125-1191"><a href="#cb125-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1192"><a href="#cb125-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1195"><a href="#cb125-1195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1196"><a href="#cb125-1196" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4</span>
<span id="cb125-1197"><a href="#cb125-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1198"><a href="#cb125-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1201"><a href="#cb125-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1202"><a href="#cb125-1202" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb125-1203"><a href="#cb125-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1204"><a href="#cb125-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1207"><a href="#cb125-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1208"><a href="#cb125-1208" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span>
<span id="cb125-1209"><a href="#cb125-1209" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">|</span> p4</span>
<span id="cb125-1210"><a href="#cb125-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1211"><a href="#cb125-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1214"><a href="#cb125-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1215"><a href="#cb125-1215" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">|</span> (p2 <span class="sc">/</span> (p1 <span class="sc">|</span> p4))</span>
<span id="cb125-1216"><a href="#cb125-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1217"><a href="#cb125-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1220"><a href="#cb125-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1221"><a href="#cb125-1221" aria-hidden="true" tabindex="-1"></a> layout <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb125-1222"><a href="#cb125-1222" aria-hidden="true" tabindex="-1"></a><span class="st">AAB</span></span>
<span id="cb125-1223"><a href="#cb125-1223" aria-hidden="true" tabindex="-1"></a><span class="st">C#B</span></span>
<span id="cb125-1224"><a href="#cb125-1224" aria-hidden="true" tabindex="-1"></a><span class="st">CDD</span></span>
<span id="cb125-1225"><a href="#cb125-1225" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb125-1226"><a href="#cb125-1226" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">design =</span> layout)</span>
<span id="cb125-1227"><a href="#cb125-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1228"><a href="#cb125-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1231"><a href="#cb125-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1232"><a href="#cb125-1232" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb125-1233"><a href="#cb125-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1234"><a href="#cb125-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1235"><a href="#cb125-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">### 修改子图</span></span>
<span id="cb125-1236"><a href="#cb125-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1239"><a href="#cb125-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1240"><a href="#cb125-1240" aria-hidden="true" tabindex="-1"></a>  p12 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2</span>
<span id="cb125-1241"><a href="#cb125-1241" aria-hidden="true" tabindex="-1"></a>  p12[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> p12[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">theme_light</span>()</span>
<span id="cb125-1242"><a href="#cb125-1242" aria-hidden="true" tabindex="-1"></a>  p12</span>
<span id="cb125-1243"><a href="#cb125-1243" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p4 <span class="sc">&amp;</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb125-1244"><a href="#cb125-1244" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p4 <span class="sc">&amp;</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">45</span>))</span>
<span id="cb125-1245"><a href="#cb125-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1246"><a href="#cb125-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1247"><a href="#cb125-1247" aria-hidden="true" tabindex="-1"></a><span class="fu">### 添加注释</span></span>
<span id="cb125-1248"><a href="#cb125-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1251"><a href="#cb125-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1252"><a href="#cb125-1252" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">/</span> p3 <span class="sc">+</span>                                      </span>
<span id="cb125-1253"><a href="#cb125-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'主标题'</span>,<span class="at">caption =</span> <span class="st">"脚注"</span>,</span>
<span id="cb125-1254"><a href="#cb125-1254" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme_gray</span>(<span class="at">base_family =</span> <span class="st">"mono"</span>)) <span class="sc">&amp;</span><span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb125-1255"><a href="#cb125-1255" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb125-1256"><a href="#cb125-1256" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>)</span>
<span id="cb125-1257"><a href="#cb125-1257" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb125-1258"><a href="#cb125-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1259"><a href="#cb125-1259" aria-hidden="true" tabindex="-1"></a>(<span class="fu">guide_area</span>() <span class="sc">/</span> (p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4) <span class="sc">/</span> p5) <span class="sc">+</span></span>
<span id="cb125-1260"><a href="#cb125-1260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb125-1261"><a href="#cb125-1261" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"City and highway mileage for cars with different drive trains"</span>,</span>
<span id="cb125-1262"><a href="#cb125-1262" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: https://fueleconomy.gov."</span></span>
<span id="cb125-1263"><a href="#cb125-1263" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-1264"><a href="#cb125-1264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(</span>
<span id="cb125-1265"><a href="#cb125-1265" aria-hidden="true" tabindex="-1"></a>    <span class="at">guides =</span> <span class="st">"collect"</span>,</span>
<span id="cb125-1266"><a href="#cb125-1266" aria-hidden="true" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb125-1267"><a href="#cb125-1267" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb125-1268"><a href="#cb125-1268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb125-1269"><a href="#cb125-1269" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb125-1270"><a href="#cb125-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1271"><a href="#cb125-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1272"><a href="#cb125-1272" aria-hidden="true" tabindex="-1"></a><span class="fu">### 图形编号</span></span>
<span id="cb125-1273"><a href="#cb125-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1276"><a href="#cb125-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1277"><a href="#cb125-1277" aria-hidden="true" tabindex="-1"></a>p123 <span class="ot">&lt;-</span> p1 <span class="sc">|</span> (p2 <span class="sc">/</span> p3)</span>
<span id="cb125-1278"><a href="#cb125-1278" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"I"</span>) <span class="co"># Uppercase roman numerics i</span></span>
<span id="cb125-1279"><a href="#cb125-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1280"><a href="#cb125-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1281"><a href="#cb125-1281" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>) <span class="co"># lowercase letters A</span></span>
<span id="cb125-1282"><a href="#cb125-1282" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"1"</span>) <span class="co">#  numbers</span></span>
<span id="cb125-1283"><a href="#cb125-1283" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-1284"><a href="#cb125-1284" aria-hidden="true" tabindex="-1"></a>p123[[<span class="dv">2</span>]] </span>
<span id="cb125-1285"><a href="#cb125-1285" aria-hidden="true" tabindex="-1"></a>p123[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> p123[[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">tag_level =</span> <span class="st">"new"</span>)</span>
<span id="cb125-1286"><a href="#cb125-1286" aria-hidden="true" tabindex="-1"></a>p123 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">c</span>(<span class="st">"I"</span>,<span class="st">"a"</span>))</span>
<span id="cb125-1287"><a href="#cb125-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1288"><a href="#cb125-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1289"><a href="#cb125-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">### 图形插入</span></span>
<span id="cb125-1290"><a href="#cb125-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1293"><a href="#cb125-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1294"><a href="#cb125-1294" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> <span class="fu">inset_element</span>(p2, <span class="at">left =</span> <span class="fl">0.5</span>, <span class="at">bottom =</span> <span class="fl">0.4</span>, <span class="at">right =</span> <span class="fl">0.9</span>, <span class="at">top =</span> <span class="fl">0.95</span>)</span>
<span id="cb125-1295"><a href="#cb125-1295" aria-hidden="true" tabindex="-1"></a>  p24 <span class="ot">&lt;-</span> p2 <span class="sc">/</span> p4 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb125-1296"><a href="#cb125-1296" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> <span class="fu">inset_element</span>(p24, <span class="at">left =</span> <span class="fl">0.5</span>, <span class="at">bottom =</span> <span class="fl">0.05</span>, <span class="at">right =</span> <span class="fl">0.95</span>, <span class="at">top =</span> <span class="fl">0.9</span>)</span>
<span id="cb125-1297"><a href="#cb125-1297" aria-hidden="true" tabindex="-1"></a>  p12 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">inset_element</span>(p2, <span class="at">left =</span> <span class="fl">0.5</span>, <span class="at">bottom =</span> <span class="fl">0.5</span>, <span class="at">right =</span> <span class="fl">0.9</span>, <span class="at">top =</span> <span class="fl">0.95</span>)</span>
<span id="cb125-1298"><a href="#cb125-1298" aria-hidden="true" tabindex="-1"></a>  p12 <span class="sc">&amp;</span> <span class="fu">theme_bw</span>()</span>
<span id="cb125-1299"><a href="#cb125-1299" aria-hidden="true" tabindex="-1"></a>  p12 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb125-1300"><a href="#cb125-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1301"><a href="#cb125-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1302"><a href="#cb125-1302" aria-hidden="true" tabindex="-1"></a><span class="fu">## ggplot2 的内部结构</span></span>
<span id="cb125-1303"><a href="#cb125-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1306"><a href="#cb125-1306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1307"><a href="#cb125-1307" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">color =</span> drv)) <span class="sc">+</span> </span>
<span id="cb125-1308"><a href="#cb125-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">"jitter"</span>) <span class="sc">+</span></span>
<span id="cb125-1309"><a href="#cb125-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span> </span>
<span id="cb125-1310"><a href="#cb125-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year)) <span class="sc">+</span> </span>
<span id="cb125-1311"><a href="#cb125-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"A plot for expository purposes"</span>)</span>
<span id="cb125-1312"><a href="#cb125-1312" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb125-1313"><a href="#cb125-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1314"><a href="#cb125-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1317"><a href="#cb125-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1318"><a href="#cb125-1318" aria-hidden="true" tabindex="-1"></a>ggprint <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb125-1319"><a href="#cb125-1319" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(x)</span>
<span id="cb125-1320"><a href="#cb125-1320" aria-hidden="true" tabindex="-1"></a>  gtable <span class="ot">&lt;-</span> <span class="fu">ggplot_gtable</span>(data)</span>
<span id="cb125-1321"><a href="#cb125-1321" aria-hidden="true" tabindex="-1"></a>  grid<span class="sc">::</span><span class="fu">grid.newpage</span>()</span>
<span id="cb125-1322"><a href="#cb125-1322" aria-hidden="true" tabindex="-1"></a>  grid<span class="sc">::</span><span class="fu">grid.draw</span>(gtable)</span>
<span id="cb125-1323"><a href="#cb125-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(x))</span>
<span id="cb125-1324"><a href="#cb125-1324" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-1325"><a href="#cb125-1325" aria-hidden="true" tabindex="-1"></a><span class="fu">ggprint</span>(p)</span>
<span id="cb125-1326"><a href="#cb125-1326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1327"><a href="#cb125-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1330"><a href="#cb125-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1331"><a href="#cb125-1331" aria-hidden="true" tabindex="-1"></a>p_built <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(p)</span>
<span id="cb125-1332"><a href="#cb125-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1333"><a href="#cb125-1333" aria-hidden="true" tabindex="-1"></a>p_built <span class="sc">$</span>data</span>
<span id="cb125-1334"><a href="#cb125-1334" aria-hidden="true" tabindex="-1"></a>p_built <span class="sc">$</span>layout</span>
<span id="cb125-1335"><a href="#cb125-1335" aria-hidden="true" tabindex="-1"></a>p_built <span class="sc">$</span>plot</span>
<span id="cb125-1336"><a href="#cb125-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1337"><a href="#cb125-1337" aria-hidden="true" tabindex="-1"></a>p_gtable <span class="ot">&lt;-</span> <span class="fu">ggplot_gtable</span>(p_built)</span>
<span id="cb125-1338"><a href="#cb125-1338" aria-hidden="true" tabindex="-1"></a>p_gtable</span>
<span id="cb125-1339"><a href="#cb125-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1340"><a href="#cb125-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1341"><a href="#cb125-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1344"><a href="#cb125-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1345"><a href="#cb125-1345" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.newpage</span>()</span>
<span id="cb125-1346"><a href="#cb125-1346" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.draw</span>(p_gtable)</span>
<span id="cb125-1347"><a href="#cb125-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1348"><a href="#cb125-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1349"><a href="#cb125-1349" aria-hidden="true" tabindex="-1"></a><span class="fu">## **ggproto对象**</span></span>
<span id="cb125-1350"><a href="#cb125-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1353"><a href="#cb125-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb125-1354"><a href="#cb125-1354" aria-hidden="true" tabindex="-1"></a>NewObject <span class="ot">&lt;-</span> <span class="fu">ggproto</span>(</span>
<span id="cb125-1355"><a href="#cb125-1355" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">_class</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span>,     <span class="co"># 类</span></span>
<span id="cb125-1356"><a href="#cb125-1356" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">_inherits</span><span class="st">`</span> <span class="ot">=</span> <span class="cn">NULL</span>   <span class="co"># 继承</span></span>
<span id="cb125-1357"><a href="#cb125-1357" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-1358"><a href="#cb125-1358" aria-hidden="true" tabindex="-1"></a>NewObject </span>
<span id="cb125-1359"><a href="#cb125-1359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb125-1360"><a href="#cb125-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-1361"><a href="#cb125-1361" aria-hidden="true" tabindex="-1"></a>创建新类，子类继承</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>